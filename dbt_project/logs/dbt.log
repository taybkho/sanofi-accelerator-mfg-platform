[0m11:10:23.256885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013884828D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138841F1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138841F38F0>]}


============================== 11:10:23.272758 | 90342241-af99-46da-ba58-9feffccb2039 ==============================
[0m11:10:23.272758 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:10:23.272758 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m11:10:23.472905 [info ] [MainThread]: dbt version: 1.10.15
[0m11:10:23.472905 [info ] [MainThread]: python version: 3.12.0
[0m11:10:23.472905 [info ] [MainThread]: python path: C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\.venv\Scripts\python.exe
[0m11:10:23.472905 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m11:10:24.229660 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:10:24.229660 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:10:24.229660 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:10:24.291759 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m11:10:24.291759 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m11:10:24.291759 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\dbt_project.yml
[0m11:10:24.291759 [info ] [MainThread]: adapter type: snowflake
[0m11:10:24.291759 [info ] [MainThread]: adapter version: 1.10.4
[0m11:10:24.407834 [info ] [MainThread]: Configuration:
[0m11:10:24.407834 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:10:24.423650 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:10:24.423650 [info ] [MainThread]: Required dependencies:
[0m11:10:24.423650 [debug] [MainThread]: Executing "git --help"
[0m11:10:24.512357 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:10:24.513360 [debug] [MainThread]: STDERR: "b''"
[0m11:10:24.513360 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:10:24.514339 [info ] [MainThread]: Connection:
[0m11:10:24.515382 [info ] [MainThread]:   account: DTWDUSN-WRB63753
[0m11:10:24.515382 [info ] [MainThread]:   user: TAIBKHO44
[0m11:10:24.516406 [info ] [MainThread]:   database: MFG_ACCELERATOR
[0m11:10:24.517390 [info ] [MainThread]:   warehouse: WH_MFG_ACCELERATOR
[0m11:10:24.517390 [info ] [MainThread]:   role: SYSADMIN
[0m11:10:24.518419 [info ] [MainThread]:   schema: ANALYTICS
[0m11:10:24.519391 [info ] [MainThread]:   authenticator: None
[0m11:10:24.520391 [info ] [MainThread]:   oauth_client_id: None
[0m11:10:24.520391 [info ] [MainThread]:   query_tag: None
[0m11:10:24.521436 [info ] [MainThread]:   client_session_keep_alive: False
[0m11:10:24.521436 [info ] [MainThread]:   host: None
[0m11:10:24.522419 [info ] [MainThread]:   port: None
[0m11:10:24.523394 [info ] [MainThread]:   proxy_host: None
[0m11:10:24.524433 [info ] [MainThread]:   proxy_port: None
[0m11:10:24.525409 [info ] [MainThread]:   protocol: None
[0m11:10:24.525409 [info ] [MainThread]:   connect_retries: 1
[0m11:10:24.526390 [info ] [MainThread]:   connect_timeout: None
[0m11:10:24.527387 [info ] [MainThread]:   retry_on_database_errors: False
[0m11:10:24.527387 [info ] [MainThread]:   retry_all: False
[0m11:10:24.528390 [info ] [MainThread]:   insecure_mode: False
[0m11:10:24.529390 [info ] [MainThread]:   reuse_connections: True
[0m11:10:24.530527 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m11:10:24.531561 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m11:10:24.533538 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:10:24.958647 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m11:10:25.088058 [debug] [MainThread]: Using snowflake connection "debug"
[0m11:10:25.088058 [debug] [MainThread]: On debug: select 1 as id
[0m11:10:25.088058 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:10:26.822254 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.730 seconds
[0m11:10:26.825762 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:10:26.825762 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:10:26.825762 [debug] [MainThread]: Command `dbt debug` succeeded at 11:10:26.825762 after 3.78 seconds
[0m11:10:26.825762 [debug] [MainThread]: Connection 'debug' was left open.
[0m11:10:26.825762 [debug] [MainThread]: On debug: Close
[0m11:10:27.339008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138841F1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138995DB620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013899B721B0>]}
[0m11:10:27.345531 [debug] [MainThread]: Flushing usage events
[0m11:10:28.246208 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:29:51.277440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7152EA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6F38A420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6EA8ECC0>]}


============================== 11:29:51.293150 | bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8 ==============================
[0m11:29:51.293150 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:29:51.293150 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select staging', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m11:29:52.063295 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:29:52.063295 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:29:52.063295 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:29:52.294735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6F48B590>]}
[0m11:29:52.490782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6F6631A0>]}
[0m11:29:52.490782 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:29:53.003869 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:29:53.003869 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:29:53.003869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A06CB9D90>]}
[0m11:29:54.432900 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m11:29:54.432900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A07401FD0>]}
[0m11:29:54.584651 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mfg_accelerator.marts
- models.mfg_accelerator.core
[0m11:29:54.603173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A072BC710>]}
[0m11:29:54.688481 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:29:54.688481 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:29:54.759248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A07216630>]}
[0m11:29:54.759248 [info ] [MainThread]: Found 3 models, 10 data tests, 3 sources, 504 macros
[0m11:29:54.759248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A0717BC20>]}
[0m11:29:54.759248 [info ] [MainThread]: 
[0m11:29:54.759248 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:29:54.759248 [info ] [MainThread]: 
[0m11:29:54.759248 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:29:54.769620 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m11:29:54.866709 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m11:29:54.866709 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m11:29:54.867705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:56.511592 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.645 seconds
[0m11:29:56.512598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now create_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m11:29:56.512598 [debug] [ThreadPool]: Creating schema "database: "MFG_ACCELERATOR"
schema: "ANALYTICS_analytics"
"
[0m11:29:56.512598 [debug] [ThreadPool]: Using snowflake connection "create_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m11:29:56.512598 [debug] [ThreadPool]: On create_MFG_ACCELERATOR_ANALYTICS_analytics: create schema if not exists MFG_ACCELERATOR.ANALYTICS_analytics
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "create_MFG_ACCELERATOR_ANALYTICS_analytics"} */
[0m11:29:56.849692 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.332 seconds
[0m11:29:56.849692 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m11:29:56.865370 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m11:29:56.865370 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m11:29:56.865370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:57.920774 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.056 seconds
[0m11:29:57.920774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A074FECC0>]}
[0m11:29:57.950181 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m11:29:57.950181 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m11:29:57.950181 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m11:29:57.950181 [info ] [Thread-1 (]: 1 of 3 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m11:29:57.950181 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m11:29:57.950181 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_batches'
[0m11:29:57.950181 [info ] [Thread-3 (]: 3 of 3 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m11:29:57.950181 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m11:29:57.950181 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m11:29:57.950181 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m11:29:57.950181 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m11:29:57.966029 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m11:29:57.967386 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m11:29:57.972276 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m11:29:57.978871 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m11:29:57.978871 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m11:29:58.007148 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m11:29:58.020118 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m11:29:58.021111 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m11:29:58.024696 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m11:29:58.027658 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m11:29:58.035843 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m11:29:58.036845 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m11:29:58.037844 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:29:58.039037 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m11:29:58.042090 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m11:29:58.045086 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m11:29:58.046124 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m11:29:58.052085 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:29:58.056088 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:29:59.227084 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0f475-0107-3c83-0013-40ff001071ae
[0m11:29:59.227084 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 41 at position 151 unexpected ';'.
[0m11:29:59.231172 [debug] [Thread-1 (]: Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql
[0m11:29:59.247162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A0752ECF0>]}
[0m11:29:59.247162 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model ANALYTICS_analytics.stg_batches ........... [[31mERROR[0m in 1.28s]
[0m11:29:59.247162 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m11:29:59.247162 [debug] [Thread-7 (]: Marking all children of 'model.mfg_accelerator.stg_batches' to be skipped because of status 'error'.  Reason: Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql.
[0m11:29:59.340254 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c0f475-0107-3fac-0013-40ff0010a19a
[0m11:29:59.340254 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 45 at position 161 unexpected ';'.
[0m11:29:59.356179 [debug] [Thread-3 (]: Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:29:59.356179 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A07B0E3C0>]}
[0m11:29:59.356179 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model ANALYTICS_analytics.stg_production_orders . [[31mERROR[0m in 1.41s]
[0m11:29:59.356179 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m11:29:59.356179 [debug] [Thread-7 (]: Marking all children of 'model.mfg_accelerator.stg_production_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql.
[0m11:29:59.474747 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0f475-0107-3fac-0013-40ff0010a19e
[0m11:29:59.474747 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 42 at position 153 unexpected ';'.
[0m11:29:59.474747 [debug] [Thread-2 (]: Database Error in model stg_materials (models\staging\stg_materials.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 153 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_materials.sql
[0m11:29:59.474747 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb91e45e-0de5-4ac4-b1ce-2c55fc041aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A07B0E480>]}
[0m11:29:59.474747 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model ANALYTICS_analytics.stg_materials ......... [[31mERROR[0m in 1.52s]
[0m11:29:59.474747 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m11:29:59.474747 [debug] [Thread-7 (]: Marking all children of 'model.mfg_accelerator.stg_materials' to be skipped because of status 'error'.  Reason: Database Error in model stg_materials (models\staging\stg_materials.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 153 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_materials.sql.
[0m11:29:59.474747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:29:59.474747 [debug] [MainThread]: Connection 'create_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m11:29:59.474747 [debug] [MainThread]: On create_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m11:29:59.920735 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m11:29:59.920735 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m11:30:00.354747 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_batches' was left open.
[0m11:30:00.354747 [debug] [MainThread]: On model.mfg_accelerator.stg_batches: Close
[0m11:30:00.810189 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_materials' was left open.
[0m11:30:00.810189 [debug] [MainThread]: On model.mfg_accelerator.stg_materials: Close
[0m11:30:01.331487 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_production_orders' was left open.
[0m11:30:01.331487 [debug] [MainThread]: On model.mfg_accelerator.stg_production_orders: Close
[0m11:30:01.786487 [info ] [MainThread]: 
[0m11:30:01.786487 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 7.03 seconds (7.03s).
[0m11:30:01.786487 [debug] [MainThread]: Command end result
[0m11:30:01.823020 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:30:01.826578 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:30:01.830720 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m11:30:01.830720 [info ] [MainThread]: 
[0m11:30:01.830720 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m11:30:01.830720 [info ] [MainThread]: 
[0m11:30:01.839530 [error] [MainThread]: [31mFailure in model stg_batches (models\staging\stg_batches.sql)[0m
[0m11:30:01.840153 [error] [MainThread]:   Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql
[0m11:30:01.840153 [info ] [MainThread]: 
[0m11:30:01.840153 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\staging\stg_batches.sql
[0m11:30:01.843270 [info ] [MainThread]: 
[0m11:30:01.843270 [error] [MainThread]: [31mFailure in model stg_production_orders (models\staging\stg_production_orders.sql)[0m
[0m11:30:01.844317 [error] [MainThread]:   Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:30:01.845420 [info ] [MainThread]: 
[0m11:30:01.845420 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:30:01.846464 [info ] [MainThread]: 
[0m11:30:01.847437 [error] [MainThread]: [31mFailure in model stg_materials (models\staging\stg_materials.sql)[0m
[0m11:30:01.848013 [error] [MainThread]:   Database Error in model stg_materials (models\staging\stg_materials.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 153 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_materials.sql
[0m11:30:01.848013 [info ] [MainThread]: 
[0m11:30:01.848013 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\staging\stg_materials.sql
[0m11:30:01.848013 [info ] [MainThread]: 
[0m11:30:01.848013 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=3
[0m11:30:01.848013 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:30:01.853011 [debug] [MainThread]: Command `dbt run` failed at 11:30:01.853011 after 10.79 seconds
[0m11:30:01.854044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7279E660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A71B69EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A71B687A0>]}
[0m11:30:01.854044 [debug] [MainThread]: Flushing usage events
[0m11:30:02.897350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:32:40.839027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1137B4E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B110E5A390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B113656B70>]}


============================== 11:32:40.849111 | 87632583-3944-4c46-b3ad-dddd93b2faf8 ==============================
[0m11:32:40.849111 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:32:40.849111 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select staging', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m11:32:41.579040 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:32:41.579040 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:32:41.579040 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:32:41.789392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B110F5B3B0>]}
[0m11:32:41.859302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1287A9760>]}
[0m11:32:41.859302 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:32:42.299115 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:32:42.403969 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:32:42.408984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B113A884A0>]}
[0m11:32:43.879450 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m11:32:43.879450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B128CC48C0>]}
[0m11:32:44.054383 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mfg_accelerator.marts
- models.mfg_accelerator.core
[0m11:32:44.067056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B128C6DE50>]}
[0m11:32:44.158886 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:32:44.158886 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:32:44.179214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B128F66690>]}
[0m11:32:44.179214 [info ] [MainThread]: Found 3 models, 10 data tests, 3 sources, 504 macros
[0m11:32:44.179214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B128CEA7E0>]}
[0m11:32:44.184888 [info ] [MainThread]: 
[0m11:32:44.184888 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:32:44.184888 [info ] [MainThread]: 
[0m11:32:44.184888 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:32:44.188909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m11:32:44.295348 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m11:32:44.296349 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m11:32:44.296349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:45.749443 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.455 seconds
[0m11:32:45.749443 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m11:32:45.765150 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m11:32:45.765150 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m11:32:45.765150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:46.929883 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.169 seconds
[0m11:32:46.929883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1110325A0>]}
[0m11:32:46.941814 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m11:32:46.944507 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m11:32:46.944507 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m11:32:46.944507 [info ] [Thread-1 (]: 1 of 3 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m11:32:46.944507 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m11:32:46.944507 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_batches'
[0m11:32:46.944507 [info ] [Thread-3 (]: 3 of 3 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m11:32:46.949108 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m11:32:46.949108 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m11:32:46.949108 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m11:32:46.949108 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m11:32:46.949108 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m11:32:46.959461 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m11:32:46.964356 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m11:32:46.969411 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m11:32:46.969411 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m11:32:46.976130 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m11:32:47.007046 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m11:32:47.015418 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m11:32:47.019388 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m11:32:47.024340 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m11:32:47.027428 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m11:32:47.028400 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m11:32:47.029914 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:32:47.030949 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m11:32:47.032945 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m11:32:47.034954 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m11:32:47.037949 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m11:32:47.037949 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:32:47.039456 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:32:48.271544 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c0f478-0107-38de-0013-40ff00109106
[0m11:32:48.271544 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 45 at position 161 unexpected ';'.
[0m11:32:48.273550 [debug] [Thread-3 (]: Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:32:48.275556 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B129606930>]}
[0m11:32:48.277562 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model ANALYTICS_analytics.stg_production_orders . [[31mERROR[0m in 1.33s]
[0m11:32:48.277562 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m11:32:48.279105 [debug] [Thread-7 (]: Marking all children of 'model.mfg_accelerator.stg_production_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql.
[0m11:32:48.721218 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0f478-0107-3c83-0013-40ff0010720e
[0m11:32:48.721218 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 41 at position 151 unexpected ';'.
[0m11:32:48.729101 [debug] [Thread-1 (]: Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql
[0m11:32:48.729101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B12953CCE0>]}
[0m11:32:48.729101 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model ANALYTICS_analytics.stg_batches ........... [[31mERROR[0m in 1.78s]
[0m11:32:48.729101 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m11:32:48.729101 [debug] [Thread-7 (]: Marking all children of 'model.mfg_accelerator.stg_batches' to be skipped because of status 'error'.  Reason: Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql.
[0m11:32:48.759642 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0f478-0107-3c83-0013-40ff00107212
[0m11:32:48.759642 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 42 at position 153 unexpected ';'.
[0m11:32:48.769100 [debug] [Thread-2 (]: Database Error in model stg_materials (models\staging\stg_materials.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 153 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_materials.sql
[0m11:32:48.769100 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87632583-3944-4c46-b3ad-dddd93b2faf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B12953F890>]}
[0m11:32:48.769100 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model ANALYTICS_analytics.stg_materials ......... [[31mERROR[0m in 1.82s]
[0m11:32:48.774286 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m11:32:48.775293 [debug] [Thread-7 (]: Marking all children of 'model.mfg_accelerator.stg_materials' to be skipped because of status 'error'.  Reason: Database Error in model stg_materials (models\staging\stg_materials.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 153 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_materials.sql.
[0m11:32:48.777146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:48.777146 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR' was left open.
[0m11:32:48.778187 [debug] [MainThread]: On list_MFG_ACCELERATOR: Close
[0m11:32:49.229055 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m11:32:49.229055 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m11:32:49.672888 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_batches' was left open.
[0m11:32:49.672888 [debug] [MainThread]: On model.mfg_accelerator.stg_batches: Close
[0m11:32:50.145570 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_materials' was left open.
[0m11:32:50.145570 [debug] [MainThread]: On model.mfg_accelerator.stg_materials: Close
[0m11:32:50.613200 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_production_orders' was left open.
[0m11:32:50.613200 [debug] [MainThread]: On model.mfg_accelerator.stg_production_orders: Close
[0m11:32:51.091082 [info ] [MainThread]: 
[0m11:32:51.091082 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 6.91 seconds (6.91s).
[0m11:32:51.091082 [debug] [MainThread]: Command end result
[0m11:32:51.119173 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:32:51.119173 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:32:51.132035 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m11:32:51.132035 [info ] [MainThread]: 
[0m11:32:51.132035 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m11:32:51.132035 [info ] [MainThread]: 
[0m11:32:51.132035 [error] [MainThread]: [31mFailure in model stg_production_orders (models\staging\stg_production_orders.sql)[0m
[0m11:32:51.132035 [error] [MainThread]:   Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:32:51.132035 [info ] [MainThread]: 
[0m11:32:51.132035 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:32:51.132035 [info ] [MainThread]: 
[0m11:32:51.139797 [error] [MainThread]: [31mFailure in model stg_batches (models\staging\stg_batches.sql)[0m
[0m11:32:51.140823 [error] [MainThread]:   Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql
[0m11:32:51.141806 [info ] [MainThread]: 
[0m11:32:51.142822 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\staging\stg_batches.sql
[0m11:32:51.143805 [info ] [MainThread]: 
[0m11:32:51.143805 [error] [MainThread]: [31mFailure in model stg_materials (models\staging\stg_materials.sql)[0m
[0m11:32:51.144805 [error] [MainThread]:   Database Error in model stg_materials (models\staging\stg_materials.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 153 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_materials.sql
[0m11:32:51.146295 [info ] [MainThread]: 
[0m11:32:51.146943 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\staging\stg_materials.sql
[0m11:32:51.147964 [info ] [MainThread]: 
[0m11:32:51.149142 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=3
[0m11:32:51.150495 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:32:51.151507 [debug] [MainThread]: Command `dbt run` failed at 11:32:51.151507 after 10.53 seconds
[0m11:32:51.151507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1141B1DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B113656B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11338C110>]}
[0m11:32:51.151507 [debug] [MainThread]: Flushing usage events
[0m11:32:52.189823 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:36:55.360816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EECD5C7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EECA1B7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EECD7858E0>]}


============================== 11:36:55.368148 | 256225e2-2d7b-4f40-85e4-ae497233b24e ==============================
[0m11:36:55.368148 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:36:55.368148 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select staging', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m11:36:56.093327 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:36:56.093327 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:36:56.093327 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:36:56.308134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE22EB680>]}
[0m11:36:56.378211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE22C70B0>]}
[0m11:36:56.378211 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:36:56.808291 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:36:56.958431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:36:56.958431 [debug] [MainThread]: Partial parsing: updated file: mfg_accelerator://models\staging\stg_production_orders.sql
[0m11:36:56.958431 [debug] [MainThread]: Partial parsing: updated file: mfg_accelerator://models\staging\stg_batches.sql
[0m11:36:56.963512 [debug] [MainThread]: Partial parsing: updated file: mfg_accelerator://models\staging\stg_materials.sql
[0m11:36:57.404645 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m11:36:57.404645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE295F020>]}
[0m11:36:57.518410 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mfg_accelerator.core
- models.mfg_accelerator.marts
[0m11:36:57.538364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE291AA80>]}
[0m11:36:57.633313 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:36:57.633313 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:36:57.653623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE2AD5D30>]}
[0m11:36:57.658133 [info ] [MainThread]: Found 3 models, 10 data tests, 3 sources, 504 macros
[0m11:36:57.658133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE2395100>]}
[0m11:36:57.659749 [info ] [MainThread]: 
[0m11:36:57.659749 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:36:57.659749 [info ] [MainThread]: 
[0m11:36:57.659749 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:36:57.659749 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m11:36:57.771453 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m11:36:57.772453 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m11:36:57.772453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:59.418875 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.648 seconds
[0m11:36:59.418875 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m11:36:59.434071 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m11:36:59.434071 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m11:36:59.434071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:00.639307 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.205 seconds
[0m11:37:00.643291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE254B3B0>]}
[0m11:37:00.648464 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m11:37:00.648464 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m11:37:00.648464 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m11:37:00.648464 [info ] [Thread-1 (]: 1 of 3 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m11:37:00.648464 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m11:37:00.648464 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_batches'
[0m11:37:00.648464 [info ] [Thread-3 (]: 3 of 3 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m11:37:00.648464 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m11:37:00.648464 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m11:37:00.658359 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m11:37:00.658359 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m11:37:00.665670 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m11:37:00.668519 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m11:37:00.668519 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m11:37:00.674248 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m11:37:00.674248 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m11:37:00.711972 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m11:37:00.718518 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m11:37:00.718518 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m11:37:00.718518 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m11:37:00.725707 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m11:37:00.727166 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m11:37:00.728672 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m11:37:00.729678 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:37:00.731721 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m11:37:00.733684 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m11:37:00.734685 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m11:37:00.735849 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:37:00.736322 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m11:37:00.741479 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:37:01.905571 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0f47d-0107-3fac-0013-40ff0010a236
[0m11:37:01.905571 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 41 at position 151 unexpected ';'.
[0m11:37:01.908584 [debug] [Thread-1 (]: Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql
[0m11:37:01.910648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE2FCE720>]}
[0m11:37:01.910648 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model ANALYTICS_analytics.stg_batches ........... [[31mERROR[0m in 1.26s]
[0m11:37:01.910648 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m11:37:01.910648 [debug] [Thread-7 (]: Marking all children of 'model.mfg_accelerator.stg_batches' to be skipped because of status 'error'.  Reason: Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql.
[0m11:37:02.098665 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c0f47d-0107-3c83-0013-40ff00107236
[0m11:37:02.098665 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 45 at position 161 unexpected ';'.
[0m11:37:02.103694 [debug] [Thread-3 (]: Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:37:02.103694 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE314FB90>]}
[0m11:37:02.103694 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model ANALYTICS_analytics.stg_production_orders . [[31mERROR[0m in 1.46s]
[0m11:37:02.105706 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m11:37:02.105706 [debug] [Thread-7 (]: Marking all children of 'model.mfg_accelerator.stg_production_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql.
[0m11:37:02.199005 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.467 seconds
[0m11:37:02.218372 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '256225e2-2d7b-4f40-85e4-ae497233b24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EECAC5A4B0>]}
[0m11:37:02.218372 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 1.57s]
[0m11:37:02.224523 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m11:37:02.224523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:02.224523 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR' was left open.
[0m11:37:02.224523 [debug] [MainThread]: On list_MFG_ACCELERATOR: Close
[0m11:37:02.719215 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m11:37:02.719215 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m11:37:03.150482 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_batches' was left open.
[0m11:37:03.150482 [debug] [MainThread]: On model.mfg_accelerator.stg_batches: Close
[0m11:37:03.578477 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_materials' was left open.
[0m11:37:03.578477 [debug] [MainThread]: On model.mfg_accelerator.stg_materials: Close
[0m11:37:04.028873 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_production_orders' was left open.
[0m11:37:04.028873 [debug] [MainThread]: On model.mfg_accelerator.stg_production_orders: Close
[0m11:37:04.521477 [info ] [MainThread]: 
[0m11:37:04.521477 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 6.86 seconds (6.86s).
[0m11:37:04.521477 [debug] [MainThread]: Command end result
[0m11:37:04.553599 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:37:04.553599 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:37:04.565266 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m11:37:04.568531 [info ] [MainThread]: 
[0m11:37:04.568531 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:37:04.568531 [info ] [MainThread]: 
[0m11:37:04.568531 [error] [MainThread]: [31mFailure in model stg_batches (models\staging\stg_batches.sql)[0m
[0m11:37:04.568531 [error] [MainThread]:   Database Error in model stg_batches (models\staging\stg_batches.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 151 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_batches.sql
[0m11:37:04.568531 [info ] [MainThread]: 
[0m11:37:04.568531 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\staging\stg_batches.sql
[0m11:37:04.568531 [info ] [MainThread]: 
[0m11:37:04.574433 [error] [MainThread]: [31mFailure in model stg_production_orders (models\staging\stg_production_orders.sql)[0m
[0m11:37:04.574996 [error] [MainThread]:   Database Error in model stg_production_orders (models\staging\stg_production_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 161 unexpected ';'.
  compiled code at target\run\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:37:04.576005 [info ] [MainThread]: 
[0m11:37:04.576005 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\staging\stg_production_orders.sql
[0m11:37:04.577040 [info ] [MainThread]: 
[0m11:37:04.577040 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=3
[0m11:37:04.578548 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:37:04.580590 [debug] [MainThread]: Command `dbt run` failed at 11:37:04.580590 after 9.45 seconds
[0m11:37:04.580590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EECDF6D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EECDF6E660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE293F440>]}
[0m11:37:04.581588 [debug] [MainThread]: Flushing usage events
[0m11:37:05.638503 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:58.637662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6B1F47D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6B1F75C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6B1F67E0>]}


============================== 11:38:58.649664 | 3b0268e3-fae7-4a29-80df-d1d9528cd084 ==============================
[0m11:38:58.649664 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:38:58.649664 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select staging', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m11:38:59.368038 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:38:59.368038 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:38:59.368038 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:38:59.584123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A7DB0C7D0>]}
[0m11:38:59.648061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A7E455B80>]}
[0m11:38:59.648061 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:39:00.083169 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:39:00.235946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:39:00.237952 [debug] [MainThread]: Partial parsing: updated file: mfg_accelerator://models\staging\stg_production_orders.sql
[0m11:39:00.237952 [debug] [MainThread]: Partial parsing: updated file: mfg_accelerator://models\staging\stg_batches.sql
[0m11:39:00.671496 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m11:39:00.671496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A004697F0>]}
[0m11:39:00.773050 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mfg_accelerator.marts
- models.mfg_accelerator.core
[0m11:39:00.787923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A7FFB60F0>]}
[0m11:39:00.882983 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:39:00.882983 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:39:00.903309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A002D84A0>]}
[0m11:39:00.903309 [info ] [MainThread]: Found 3 models, 10 data tests, 3 sources, 504 macros
[0m11:39:00.907858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A00549EB0>]}
[0m11:39:00.907858 [info ] [MainThread]: 
[0m11:39:00.910873 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:39:00.910873 [info ] [MainThread]: 
[0m11:39:00.910873 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:39:00.918863 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m11:39:01.017991 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m11:39:01.017991 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m11:39:01.017991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:02.694566 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.675 seconds
[0m11:39:02.698080 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m11:39:02.710430 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m11:39:02.710430 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m11:39:02.710430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:04.091315 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.386 seconds
[0m11:39:04.098138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A00244350>]}
[0m11:39:04.103605 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m11:39:04.103605 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m11:39:04.103605 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m11:39:04.103605 [info ] [Thread-1 (]: 1 of 3 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m11:39:04.107975 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m11:39:04.107975 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_batches'
[0m11:39:04.107975 [info ] [Thread-3 (]: 3 of 3 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m11:39:04.107975 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m11:39:04.107975 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m11:39:04.107975 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m11:39:04.107975 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m11:39:04.120933 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m11:39:04.120933 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m11:39:04.125961 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m11:39:04.131707 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m11:39:04.133671 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m11:39:04.145486 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m11:39:04.168208 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m11:39:04.168208 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m11:39:04.168208 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m11:39:04.179520 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m11:39:04.181661 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m11:39:04.181661 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m11:39:04.183659 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m11:39:04.183659 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:39:04.184657 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m11:39:04.186617 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m11:39:04.189067 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:39:04.192070 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m11:39:04.205206 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:39:05.670921 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.466 seconds
[0m11:39:05.692107 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.509 seconds
[0m11:39:05.692107 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A686CA540>]}
[0m11:39:05.692107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A00BC6C90>]}
[0m11:39:05.692107 [info ] [Thread-3 (]: 3 of 3 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 1.58s]
[0m11:39:05.698237 [info ] [Thread-1 (]: 1 of 3 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 1.58s]
[0m11:39:05.698237 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m11:39:05.698237 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m11:39:05.698237 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.513 seconds
[0m11:39:05.708326 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0268e3-fae7-4a29-80df-d1d9528cd084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A00AEA420>]}
[0m11:39:05.708326 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 1.60s]
[0m11:39:05.708326 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m11:39:05.712261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:05.713296 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR' was left open.
[0m11:39:05.713296 [debug] [MainThread]: On list_MFG_ACCELERATOR: Close
[0m11:39:06.178763 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m11:39:06.178763 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m11:39:06.608813 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_batches' was left open.
[0m11:39:06.608813 [debug] [MainThread]: On model.mfg_accelerator.stg_batches: Close
[0m11:39:07.321156 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_materials' was left open.
[0m11:39:07.321156 [debug] [MainThread]: On model.mfg_accelerator.stg_materials: Close
[0m11:39:07.788450 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_production_orders' was left open.
[0m11:39:07.788450 [debug] [MainThread]: On model.mfg_accelerator.stg_production_orders: Close
[0m11:39:08.254819 [info ] [MainThread]: 
[0m11:39:08.257991 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m11:39:08.257991 [debug] [MainThread]: Command end result
[0m11:39:08.287947 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:39:08.293090 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:39:08.297977 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m11:39:08.303123 [info ] [MainThread]: 
[0m11:39:08.303123 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:08.303123 [info ] [MainThread]: 
[0m11:39:08.303123 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m11:39:08.303123 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:39:08.303123 [debug] [MainThread]: Command `dbt run` succeeded at 11:39:08.303123 after 9.90 seconds
[0m11:39:08.308075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6B34B470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6B34B170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A002D9D30>]}
[0m11:39:08.308075 [debug] [MainThread]: Flushing usage events
[0m11:39:09.358668 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:20.447602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B1ECBB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B25E5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B25E7020>]}


============================== 11:40:20.447602 | 6bbf7663-57a9-4bb3-8909-50988303cad1 ==============================
[0m11:40:20.447602 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:40:20.447602 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --select staging', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m11:40:21.179797 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:40:21.179797 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:40:21.179797 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:40:21.407826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bbf7663-57a9-4bb3-8909-50988303cad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C7059730>]}
[0m11:40:21.467559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bbf7663-57a9-4bb3-8909-50988303cad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C72C87D0>]}
[0m11:40:21.467559 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:40:21.902855 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:40:22.053740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:40:22.053740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:40:22.059815 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mfg_accelerator.marts
- models.mfg_accelerator.core
[0m11:40:22.109409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bbf7663-57a9-4bb3-8909-50988303cad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C5405AF0>]}
[0m11:40:22.209401 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:40:22.209401 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:40:22.319446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bbf7663-57a9-4bb3-8909-50988303cad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C7A8F4D0>]}
[0m11:40:22.319446 [info ] [MainThread]: Found 3 models, 10 data tests, 3 sources, 504 macros
[0m11:40:22.319446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bbf7663-57a9-4bb3-8909-50988303cad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C7C479B0>]}
[0m11:40:22.319446 [info ] [MainThread]: 
[0m11:40:22.327538 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:40:22.327538 [info ] [MainThread]: 
[0m11:40:22.327538 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:40:22.337608 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m11:40:22.447723 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m11:40:22.447723 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m11:40:22.447723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:24.018245 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.571 seconds
[0m11:40:24.023721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bbf7663-57a9-4bb3-8909-50988303cad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C7C30500>]}
[0m11:40:24.028159 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m11:40:24.028159 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m11:40:24.028159 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m11:40:24.028159 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m11:40:24.028159 [info ] [Thread-1 (]: 1 of 10 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m11:40:24.028159 [info ] [Thread-2 (]: 2 of 10 START test not_null_stg_batches_material_id ............................ [RUN]
[0m11:40:24.028159 [info ] [Thread-3 (]: 3 of 10 START test not_null_stg_materials_material_id .......................... [RUN]
[0m11:40:24.028159 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0'
[0m11:40:24.028159 [info ] [Thread-4 (]: 4 of 10 START test not_null_stg_production_orders_batch_id ..................... [RUN]
[0m11:40:24.028159 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c'
[0m11:40:24.028159 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89'
[0m11:40:24.038086 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m11:40:24.038086 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5'
[0m11:40:24.038086 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m11:40:24.039837 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m11:40:24.060250 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m11:40:24.061214 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m11:40:24.067939 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m11:40:24.067939 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m11:40:24.073020 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m11:40:24.077916 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m11:40:24.108437 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m11:40:24.109501 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m11:40:24.110161 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m11:40:24.114462 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m11:40:24.114462 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m11:40:24.117839 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m11:40:24.122476 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m11:40:24.123476 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m11:40:24.124439 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m11:40:24.124439 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:40:24.125437 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m11:40:24.128989 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m11:40:24.131003 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m11:40:24.131003 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:40:24.131003 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m11:40:24.131003 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m11:40:24.137925 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m11:40:24.137925 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:40:24.137925 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:40:26.118208 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.977 seconds
[0m11:40:26.127894 [info ] [Thread-2 (]: 2 of 10 PASS not_null_stg_batches_material_id .................................. [[32mPASS[0m in 2.10s]
[0m11:40:26.127894 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m11:40:26.127894 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m11:40:26.127894 [info ] [Thread-2 (]: 5 of 10 START test not_null_stg_production_orders_order_id ..................... [RUN]
[0m11:40:26.127894 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m11:40:26.127894 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m11:40:26.127894 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m11:40:26.137886 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m11:40:26.143313 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m11:40:26.146275 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m11:40:26.147786 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m11:40:26.162128 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.031 seconds
[0m11:40:26.166124 [info ] [Thread-3 (]: 3 of 10 PASS not_null_stg_materials_material_id ................................ [[32mPASS[0m in 2.14s]
[0m11:40:26.168191 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m11:40:26.168191 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m11:40:26.168191 [info ] [Thread-3 (]: 6 of 10 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m11:40:26.168191 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m11:40:26.168191 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m11:40:26.179663 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m11:40:26.182167 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m11:40:26.185178 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m11:40:26.187690 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m11:40:26.187690 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m11:40:26.187690 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.053 seconds
[0m11:40:26.200037 [info ] [Thread-4 (]: 4 of 10 PASS not_null_stg_production_orders_batch_id ........................... [[32mPASS[0m in 2.16s]
[0m11:40:26.201077 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m11:40:26.202059 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m11:40:26.202499 [info ] [Thread-4 (]: 7 of 10 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m11:40:26.202965 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m11:40:26.202965 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m11:40:26.208173 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m11:40:26.208173 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m11:40:26.215969 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m11:40:26.217890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.093 seconds
[0m11:40:26.220931 [info ] [Thread-1 (]: 1 of 10 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 2.19s]
[0m11:40:26.221903 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m11:40:26.223904 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m11:40:26.223904 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m11:40:26.224899 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m11:40:26.225901 [info ] [Thread-1 (]: 8 of 10 START test unique_stg_batches_batch_id ................................. [RUN]
[0m11:40:26.226870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m11:40:26.227869 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m11:40:26.239552 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m11:40:26.239552 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m11:40:26.239552 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m11:40:26.247802 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m11:40:26.248819 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m11:40:26.575143 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.428 seconds
[0m11:40:26.577865 [info ] [Thread-2 (]: 5 of 10 PASS not_null_stg_production_orders_order_id ........................... [[32mPASS[0m in 0.45s]
[0m11:40:26.577865 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m11:40:26.577865 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m11:40:26.577865 [info ] [Thread-2 (]: 9 of 10 START test unique_stg_materials_material_id ............................ [RUN]
[0m11:40:26.577865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m11:40:26.577865 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m11:40:26.577865 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m11:40:26.587738 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m11:40:26.592907 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m11:40:26.596115 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m11:40:26.597113 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m11:40:26.747765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m11:40:26.747765 [info ] [Thread-1 (]: 8 of 10 PASS unique_stg_batches_batch_id ....................................... [[32mPASS[0m in 0.52s]
[0m11:40:26.747765 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m11:40:26.747765 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m11:40:26.747765 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m11:40:26.757809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m11:40:26.757809 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m11:40:26.765370 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m11:40:26.767914 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m11:40:26.767914 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m11:40:26.777863 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m11:40:26.777863 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m11:40:26.841329 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m11:40:26.843309 [info ] [Thread-3 (]: 6 of 10 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.68s]
[0m11:40:26.844311 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m11:40:26.909075 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.683 seconds
[0m11:40:26.912070 [info ] [Thread-4 (]: 7 of 10 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.71s]
[0m11:40:26.914042 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m11:40:26.947509 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.351 seconds
[0m11:40:26.947509 [info ] [Thread-2 (]: 9 of 10 PASS unique_stg_materials_material_id .................................. [[32mPASS[0m in 0.37s]
[0m11:40:26.947509 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m11:40:27.247653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.474 seconds
[0m11:40:27.247653 [info ] [Thread-1 (]: 10 of 10 PASS unique_stg_production_orders_order_id ............................ [[32mPASS[0m in 0.50s]
[0m11:40:27.247653 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m11:40:27.257908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:40:27.257908 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m11:40:27.257908 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m11:40:27.722124 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m11:40:27.722124 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m11:40:28.178130 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m11:40:28.178130 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m11:40:28.607695 [debug] [MainThread]: Connection 'test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2' was left open.
[0m11:40:28.609874 [debug] [MainThread]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: Close
[0m11:40:29.048422 [debug] [MainThread]: Connection 'test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519' was left open.
[0m11:40:29.048422 [debug] [MainThread]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: Close
[0m11:40:29.498119 [info ] [MainThread]: 
[0m11:40:29.498119 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 7.17 seconds (7.17s).
[0m11:40:29.502567 [debug] [MainThread]: Command end result
[0m11:40:29.534668 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m11:40:29.538185 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m11:40:29.538185 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m11:40:29.546380 [info ] [MainThread]: 
[0m11:40:29.546380 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:40:29.547889 [info ] [MainThread]: 
[0m11:40:29.548567 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m11:40:29.548567 [debug] [MainThread]: Command `dbt test` succeeded at 11:40:29.548567 after 9.27 seconds
[0m11:40:29.548567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C7B87EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192C7B87C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B22F0B00>]}
[0m11:40:29.548567 [debug] [MainThread]: Flushing usage events
[0m11:40:30.520488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:55:47.958286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3C04A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3B74EBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3EC77530>]}


============================== 12:55:47.958286 | 05473aa6-fed4-4292-91d4-a4b8f6f34813 ==============================
[0m12:55:47.958286 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:55:47.968380 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select core', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m12:55:48.808223 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:55:48.813372 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:55:48.813372 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:55:49.025207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C51E6ED80>]}
[0m12:55:49.089615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3EC76480>]}
[0m12:55:49.089615 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m12:55:49.563552 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:55:49.723241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m12:55:49.724287 [debug] [MainThread]: Partial parsing: added file: mfg_accelerator://models\core\core_materials.sql
[0m12:55:49.724287 [debug] [MainThread]: Partial parsing: added file: mfg_accelerator://models\core\core_batches.sql
[0m12:55:49.724287 [debug] [MainThread]: Partial parsing: added file: mfg_accelerator://models\core\core_schema.yml
[0m12:55:49.724287 [debug] [MainThread]: Partial parsing: added file: mfg_accelerator://models\core\fct_production_orders.sql
[0m12:55:50.158387 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m12:55:50.158387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C53EF7020>]}
[0m12:55:50.253426 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mfg_accelerator.marts
[0m12:55:50.268376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C53F3A6C0>]}
[0m12:55:50.363529 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m12:55:50.363529 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m12:55:50.390564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C54083230>]}
[0m12:55:50.390564 [info ] [MainThread]: Found 6 models, 20 data tests, 3 sources, 504 macros
[0m12:55:50.390564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3F497020>]}
[0m12:55:50.394624 [info ] [MainThread]: 
[0m12:55:50.394624 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:55:50.394624 [info ] [MainThread]: 
[0m12:55:50.394624 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:55:50.400331 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m12:55:50.528420 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m12:55:50.528420 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m12:55:50.528420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:52.575776 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.048 seconds
[0m12:55:52.578457 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m12:55:52.591512 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m12:55:52.591512 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m12:55:52.591512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:53.974874 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.381 seconds
[0m12:55:53.978581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C53FFBBC0>]}
[0m12:55:53.978581 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.core_materials
[0m12:55:53.978581 [info ] [Thread-1 (]: 1 of 3 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m12:55:53.978581 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_materials'
[0m12:55:53.978581 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.core_materials
[0m12:55:53.994475 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m12:55:53.996481 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.core_materials
[0m12:55:54.038313 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m12:55:54.042494 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m12:55:54.044830 [debug] [Thread-1 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m12:55:54.044830 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:55:57.179045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.138 seconds
[0m12:55:57.206435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3C14A630>]}
[0m12:55:57.206435 [info ] [Thread-1 (]: 1 of 3 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 3.23s]
[0m12:55:57.208443 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.core_materials
[0m12:55:57.208443 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.core_batches
[0m12:55:57.208443 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m12:55:57.208443 [info ] [Thread-3 (]: 2 of 3 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m12:55:57.208443 [info ] [Thread-4 (]: 3 of 3 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m12:55:57.208443 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_batches'
[0m12:55:57.214248 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.fct_production_orders'
[0m12:55:57.215149 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.core_batches
[0m12:55:57.215792 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m12:55:57.218428 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m12:55:57.225360 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m12:55:57.226299 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.core_batches
[0m12:55:57.228312 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m12:55:57.228312 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m12:55:57.228312 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m12:55:57.238361 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m12:55:57.238361 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m12:55:57.244058 [debug] [Thread-3 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m12:55:57.244058 [debug] [Thread-4 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m12:55:57.244058 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:55:57.246931 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:56:00.018663 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.772 seconds
[0m12:56:00.021319 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C547519D0>]}
[0m12:56:00.021319 [info ] [Thread-4 (]: 3 of 3 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 2.81s]
[0m12:56:00.021319 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m12:56:00.060562 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.815 seconds
[0m12:56:00.060562 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05473aa6-fed4-4292-91d4-a4b8f6f34813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C54760500>]}
[0m12:56:00.060562 [info ] [Thread-3 (]: 2 of 3 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 2.85s]
[0m12:56:00.060562 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.core_batches
[0m12:56:00.060562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:00.068363 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR' was left open.
[0m12:56:00.068363 [debug] [MainThread]: On list_MFG_ACCELERATOR: Close
[0m12:56:00.548386 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m12:56:00.548386 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m12:56:01.009295 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_materials' was left open.
[0m12:56:01.009295 [debug] [MainThread]: On model.mfg_accelerator.core_materials: Close
[0m12:56:01.459253 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m12:56:01.459253 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m12:56:01.925345 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m12:56:01.928661 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m12:56:02.348322 [info ] [MainThread]: 
[0m12:56:02.348322 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.95 seconds (11.95s).
[0m12:56:02.348322 [debug] [MainThread]: Command end result
[0m12:56:02.386304 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m12:56:02.388344 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m12:56:02.398604 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m12:56:02.398604 [info ] [MainThread]: 
[0m12:56:02.398604 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:02.398604 [info ] [MainThread]: 
[0m12:56:02.398604 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:56:02.398604 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:56:02.398604 [debug] [MainThread]: Command `dbt run` succeeded at 12:56:02.398604 after 14.67 seconds
[0m12:56:02.398604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3F338C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C5400F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C54401490>]}
[0m12:56:02.398604 [debug] [MainThread]: Flushing usage events
[0m12:56:03.408454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:47.727997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246EAE41A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246ECDFEC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246ECDFDEB0>]}


============================== 12:56:47.739410 | f54b7a05-4124-499a-8edc-1254388cda55 ==============================
[0m12:56:47.739410 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:56:47.739410 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --select core', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m12:56:48.489493 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:56:48.489493 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:56:48.489493 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:56:48.698406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f54b7a05-4124-499a-8edc-1254388cda55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002468221AF60>]}
[0m12:56:48.768241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f54b7a05-4124-499a-8edc-1254388cda55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002468092DB80>]}
[0m12:56:48.768241 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m12:56:49.218086 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:56:49.378064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:49.378064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:49.378064 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mfg_accelerator.marts
[0m12:56:49.435702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f54b7a05-4124-499a-8edc-1254388cda55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246822D7E30>]}
[0m12:56:49.532397 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m12:56:49.532397 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m12:56:49.618244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f54b7a05-4124-499a-8edc-1254388cda55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246824857F0>]}
[0m12:56:49.618244 [info ] [MainThread]: Found 6 models, 20 data tests, 3 sources, 504 macros
[0m12:56:49.618244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f54b7a05-4124-499a-8edc-1254388cda55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246824E4C50>]}
[0m12:56:49.627954 [info ] [MainThread]: 
[0m12:56:49.627954 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:56:49.627954 [info ] [MainThread]: 
[0m12:56:49.627954 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:56:49.637976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m12:56:49.772990 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m12:56:49.772990 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m12:56:49.772990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:51.228403 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.455 seconds
[0m12:56:51.228403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f54b7a05-4124-499a-8edc-1254388cda55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024681C51FA0>]}
[0m12:56:51.238129 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m12:56:51.238129 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m12:56:51.238129 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m12:56:51.238129 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m12:56:51.238129 [info ] [Thread-1 (]: 1 of 10 START test not_null_core_batches_batch_id .............................. [RUN]
[0m12:56:51.238129 [info ] [Thread-2 (]: 2 of 10 START test not_null_core_batches_material_id ........................... [RUN]
[0m12:56:51.238129 [info ] [Thread-3 (]: 3 of 10 START test not_null_core_materials_material_id ......................... [RUN]
[0m12:56:51.238129 [info ] [Thread-4 (]: 4 of 10 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m12:56:51.238129 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c'
[0m12:56:51.244401 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m12:56:51.244401 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m12:56:51.244401 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m12:56:51.244401 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m12:56:51.244401 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m12:56:51.244401 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m12:56:51.248440 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m12:56:51.268456 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m12:56:51.273668 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m12:56:51.278483 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m12:56:51.278483 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m12:56:51.287590 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m12:56:51.288680 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m12:56:51.288680 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m12:56:51.318599 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m12:56:51.318599 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m12:56:51.318599 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m12:56:51.325964 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m12:56:51.330512 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m12:56:51.331285 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m12:56:51.331285 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m12:56:51.333811 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m12:56:51.333811 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m12:56:51.333811 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m12:56:51.333811 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m12:56:51.333811 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m12:56:51.338390 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:56:51.338390 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m12:56:51.338390 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:56:51.338390 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:56:51.341867 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:56:52.538270 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.200 seconds
[0m12:56:52.551963 [info ] [Thread-3 (]: 3 of 10 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.30s]
[0m12:56:52.551963 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m12:56:52.554114 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m12:56:52.554114 [info ] [Thread-3 (]: 5 of 10 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m12:56:52.554114 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m12:56:52.554114 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m12:56:52.563111 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m12:56:52.565120 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m12:56:52.569661 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m12:56:52.573283 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m12:56:52.573283 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m12:56:52.648601 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.309 seconds
[0m12:56:52.648601 [info ] [Thread-4 (]: 4 of 10 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.40s]
[0m12:56:52.648601 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m12:56:52.654572 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m12:56:52.654572 [info ] [Thread-4 (]: 6 of 10 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m12:56:52.654572 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m12:56:52.654572 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m12:56:52.663012 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m12:56:52.663012 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m12:56:52.668213 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m12:56:52.668213 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m12:56:52.668213 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m12:56:52.876054 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.538 seconds
[0m12:56:52.880121 [info ] [Thread-2 (]: 2 of 10 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.64s]
[0m12:56:52.882305 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m12:56:52.886404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.546 seconds
[0m12:56:52.886404 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m12:56:52.893843 [info ] [Thread-1 (]: 1 of 10 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 1.65s]
[0m12:56:52.895870 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m12:56:52.898382 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m12:56:52.893843 [info ] [Thread-2 (]: 7 of 10 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m12:56:52.900469 [info ] [Thread-1 (]: 8 of 10 START test unique_core_batches_batch_id ................................ [RUN]
[0m12:56:52.900469 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m12:56:52.903351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m12:56:52.905364 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m12:56:52.906876 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m12:56:52.926474 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m12:56:52.943265 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m12:56:52.947323 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m12:56:52.954525 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m12:56:52.956538 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m12:56:52.964002 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m12:56:52.966014 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m12:56:52.968025 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m12:56:52.969072 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m12:56:52.969072 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m12:56:53.048385 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.475 seconds
[0m12:56:53.052488 [info ] [Thread-3 (]: 5 of 10 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.50s]
[0m12:56:53.052488 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m12:56:53.052488 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m12:56:53.055915 [info ] [Thread-3 (]: 9 of 10 START test unique_core_materials_material_id ........................... [RUN]
[0m12:56:53.055915 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m12:56:53.055915 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m12:56:53.058428 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m12:56:53.058428 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m12:56:53.069099 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m12:56:53.072166 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m12:56:53.072166 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m12:56:53.081241 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m12:56:53.084507 [info ] [Thread-4 (]: 6 of 10 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.43s]
[0m12:56:53.088075 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m12:56:53.088075 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m12:56:53.088075 [info ] [Thread-4 (]: 10 of 10 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m12:56:53.088075 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m12:56:53.088075 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m12:56:53.101769 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m12:56:53.101769 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m12:56:53.111350 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m12:56:53.116221 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m12:56:53.118216 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m12:56:53.324831 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.352 seconds
[0m12:56:53.324831 [info ] [Thread-1 (]: 8 of 10 PASS unique_core_batches_batch_id ...................................... [[32mPASS[0m in 0.42s]
[0m12:56:53.328038 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m12:56:53.438581 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.472 seconds
[0m12:56:53.443390 [info ] [Thread-2 (]: 7 of 10 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.54s]
[0m12:56:53.443390 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m12:56:53.476071 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m12:56:53.478409 [info ] [Thread-3 (]: 9 of 10 PASS unique_core_materials_material_id ................................. [[32mPASS[0m in 0.42s]
[0m12:56:53.478409 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m12:56:53.511552 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m12:56:53.518253 [info ] [Thread-4 (]: 10 of 10 PASS unique_fct_production_orders_order_id ............................ [[32mPASS[0m in 0.43s]
[0m12:56:53.518253 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m12:56:53.518253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:53.518253 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m12:56:53.518253 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m12:56:53.988495 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf' was left open.
[0m12:56:53.988495 [debug] [MainThread]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: Close
[0m12:56:54.478645 [debug] [MainThread]: Connection 'test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d' was left open.
[0m12:56:54.478645 [debug] [MainThread]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: Close
[0m12:56:54.908914 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2' was left open.
[0m12:56:54.908914 [debug] [MainThread]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: Close
[0m12:56:55.343105 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442' was left open.
[0m12:56:55.345120 [debug] [MainThread]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: Close
[0m12:56:55.808850 [info ] [MainThread]: 
[0m12:56:55.808850 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 6.18 seconds (6.18s).
[0m12:56:55.808850 [debug] [MainThread]: Command end result
[0m12:56:55.848386 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m12:56:55.848386 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m12:56:55.860364 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m12:56:55.860364 [info ] [MainThread]: 
[0m12:56:55.860364 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:55.860364 [info ] [MainThread]: 
[0m12:56:55.860364 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m12:56:55.860364 [debug] [MainThread]: Command `dbt test` succeeded at 12:56:55.860364 after 8.27 seconds
[0m12:56:55.860364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024682693FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024682693DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246825DDB20>]}
[0m12:56:55.860364 [debug] [MainThread]: Flushing usage events
[0m12:56:56.782438 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:57:14.436011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E313BBB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2E9F14F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2E60F830>]}


============================== 14:57:14.460564 | 589c1eca-2303-40ab-8cb6-d7d965444772 ==============================
[0m14:57:14.460564 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:57:14.461586 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select marts', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m14:57:20.835709 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:57:20.835709 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:57:20.835709 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:57:21.135719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '589c1eca-2303-40ab-8cb6-d7d965444772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2F38B350>]}
[0m14:57:21.201008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '589c1eca-2303-40ab-8cb6-d7d965444772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E4436F380>]}
[0m14:57:21.211398 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:57:21.735657 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:57:21.895603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m14:57:21.897256 [debug] [MainThread]: Partial parsing: added file: mfg_accelerator://models\marts\mfg_plant_daily_kpis.sql
[0m14:57:21.897256 [debug] [MainThread]: Partial parsing: added file: mfg_accelerator://models\marts\mfg_ml_features_orders.sql
[0m14:57:21.897256 [debug] [MainThread]: Partial parsing: added file: mfg_accelerator://models\marts\marts_schema.yml
[0m14:57:22.412851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '589c1eca-2303-40ab-8cb6-d7d965444772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E470A61B0>]}
[0m14:57:22.515823 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m14:57:22.519027 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m14:57:22.725942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '589c1eca-2303-40ab-8cb6-d7d965444772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E4708CA10>]}
[0m14:57:22.731014 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:57:22.731014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '589c1eca-2303-40ab-8cb6-d7d965444772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E4723E1E0>]}
[0m14:57:22.731014 [info ] [MainThread]: 
[0m14:57:22.731014 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:57:22.731014 [info ] [MainThread]: 
[0m14:57:22.735679 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:57:22.735679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m14:57:22.951620 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m14:57:22.951620 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m14:57:22.951620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:24.651150 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.699 seconds
[0m14:57:24.659000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m14:57:24.671263 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:57:24.671263 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:57:24.674777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:25.886351 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.219 seconds
[0m14:57:25.895907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '589c1eca-2303-40ab-8cb6-d7d965444772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E472F5100>]}
[0m14:57:25.905838 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:57:25.914260 [info ] [Thread-1 (]: 1 of 1 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m14:57:25.914260 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mfg_accelerator.mfg_ml_features_orders'
[0m14:57:25.915766 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m14:57:25.915766 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:57:25.926116 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m14:57:25.958967 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:57:25.966169 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:57:25.966169 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m14:57:25.966169 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:57:29.235715 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.267 seconds
[0m14:57:29.265950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '589c1eca-2303-40ab-8cb6-d7d965444772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2F38A510>]}
[0m14:57:29.265950 [info ] [Thread-1 (]: 1 of 1 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 3.34s]
[0m14:57:29.265950 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:57:29.265950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:29.265950 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR' was left open.
[0m14:57:29.265950 [debug] [MainThread]: On list_MFG_ACCELERATOR: Close
[0m14:57:29.800944 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m14:57:29.800944 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m14:57:30.246118 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m14:57:30.246118 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m14:57:30.716308 [info ] [MainThread]: 
[0m14:57:30.718665 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.98 seconds (7.98s).
[0m14:57:30.720404 [debug] [MainThread]: Command end result
[0m14:57:30.752600 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m14:57:30.755887 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m14:57:30.766628 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m14:57:30.766628 [info ] [MainThread]: 
[0m14:57:30.766628 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:57:30.766628 [info ] [MainThread]: 
[0m14:57:30.766628 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:57:30.766628 [debug] [MainThread]: Command `dbt run` succeeded at 14:57:30.766628 after 16.56 seconds
[0m14:57:30.766628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E322485C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E31BE6900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E3216B170>]}
[0m14:57:30.773202 [debug] [MainThread]: Flushing usage events
[0m14:57:31.815989 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:27.145420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BE9DBBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BE81D970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BC8AA1B0>]}


============================== 14:58:27.145420 | 5b6e5ba4-2c85-4291-92f8-dec9592ab906 ==============================
[0m14:58:27.145420 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:58:27.151748 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt test --select marts', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m14:58:27.895457 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:58:27.895457 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:58:27.895457 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:58:28.105562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b6e5ba4-2c85-4291-92f8-dec9592ab906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D3F5ED80>]}
[0m14:58:28.175826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b6e5ba4-2c85-4291-92f8-dec9592ab906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D2ACC5F0>]}
[0m14:58:28.175826 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:58:28.625851 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:58:28.775533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:58:28.775533 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:58:28.825894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b6e5ba4-2c85-4291-92f8-dec9592ab906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D42C7A70>]}
[0m14:58:28.920963 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m14:58:28.922711 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m14:58:29.035624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b6e5ba4-2c85-4291-92f8-dec9592ab906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D41B7950>]}
[0m14:58:29.035624 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:58:29.035624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b6e5ba4-2c85-4291-92f8-dec9592ab906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D42355E0>]}
[0m14:58:29.039955 [info ] [MainThread]: 
[0m14:58:29.039955 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:58:29.039955 [info ] [MainThread]: 
[0m14:58:29.039955 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:58:29.045816 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m14:58:29.165702 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:58:29.165702 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:58:29.165702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:30.745819 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.580 seconds
[0m14:58:30.745819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b6e5ba4-2c85-4291-92f8-dec9592ab906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D40C3C20>]}
[0m14:58:30.755753 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:58:30.755753 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:58:30.755753 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:58:30.755753 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:58:30.755753 [info ] [Thread-1 (]: 1 of 4 START test not_null_mfg_ml_features_orders_order_id ..................... [RUN]
[0m14:58:30.755753 [info ] [Thread-2 (]: 2 of 4 START test not_null_mfg_plant_daily_kpis_calendar_date .................. [RUN]
[0m14:58:30.755753 [info ] [Thread-3 (]: 3 of 4 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............. [RUN]
[0m14:58:30.761656 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213'
[0m14:58:30.755753 [info ] [Thread-4 (]: 4 of 4 START test unique_mfg_ml_features_orders_order_id ....................... [RUN]
[0m14:58:30.761656 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8'
[0m14:58:30.761656 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68'
[0m14:58:30.761656 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:58:30.761656 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd'
[0m14:58:30.766072 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:58:30.766072 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:58:30.785755 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:58:30.785755 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:58:30.794473 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:58:30.796057 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:58:30.808107 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:58:30.809659 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:58:30.842006 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:58:30.843042 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:58:30.845698 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:58:30.845698 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:58:30.845698 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:58:30.850200 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:58:30.855828 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:58:30.855828 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:58:30.855828 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:58:30.858436 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m14:58:30.859968 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:58:30.859968 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m14:58:30.859968 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:58:30.862811 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:58:30.863442 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m14:58:30.863442 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:58:30.863442 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m14:58:30.865951 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:58:30.865951 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:58:32.565875 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c0f546-0107-4035-0013-40ff0010d142
[0m14:58:32.571144 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'MFG_ACCELERATOR.ANALYTICS_ANALYTICS.MFG_PLANT_DAILY_KPIS' does not exist or not authorized.
[0m14:58:32.571144 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0f546-0107-4035-0013-40ff0010d13e
[0m14:58:32.575552 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'MFG_ACCELERATOR.ANALYTICS_ANALYTICS.MFG_PLANT_DAILY_KPIS' does not exist or not authorized.
[0m14:58:32.595508 [debug] [Thread-3 (]: Database Error in test not_null_mfg_plant_daily_kpis_manufacturing_site (models\marts\marts_schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'MFG_ACCELERATOR.ANALYTICS_ANALYTICS.MFG_PLANT_DAILY_KPIS' does not exist or not authorized.
  compiled code at target\run\mfg_accelerator\models\marts\marts_schema.yml\not_null_mfg_plant_daily_kpis_manufacturing_site.sql
[0m14:58:32.595508 [debug] [Thread-2 (]: Database Error in test not_null_mfg_plant_daily_kpis_calendar_date (models\marts\marts_schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'MFG_ACCELERATOR.ANALYTICS_ANALYTICS.MFG_PLANT_DAILY_KPIS' does not exist or not authorized.
  compiled code at target\run\mfg_accelerator\models\marts\marts_schema.yml\not_null_mfg_plant_daily_kpis_calendar_date.sql
[0m14:58:32.595508 [error] [Thread-3 (]: 3 of 4 ERROR not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[31mERROR[0m in 1.83s]
[0m14:58:32.595508 [error] [Thread-2 (]: 2 of 4 ERROR not_null_mfg_plant_daily_kpis_calendar_date ....................... [[31mERROR[0m in 1.83s]
[0m14:58:32.595508 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:58:32.595508 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:58:32.605399 [debug] [Thread-7 (]: Marking all children of 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mfg_plant_daily_kpis_manufacturing_site (models\marts\marts_schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'MFG_ACCELERATOR.ANALYTICS_ANALYTICS.MFG_PLANT_DAILY_KPIS' does not exist or not authorized.
  compiled code at target\run\mfg_accelerator\models\marts\marts_schema.yml\not_null_mfg_plant_daily_kpis_manufacturing_site.sql.
[0m14:58:32.605399 [debug] [Thread-7 (]: Marking all children of 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mfg_plant_daily_kpis_calendar_date (models\marts\marts_schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'MFG_ACCELERATOR.ANALYTICS_ANALYTICS.MFG_PLANT_DAILY_KPIS' does not exist or not authorized.
  compiled code at target\run\mfg_accelerator\models\marts\marts_schema.yml\not_null_mfg_plant_daily_kpis_calendar_date.sql.
[0m14:58:33.093510 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.221 seconds
[0m14:58:33.102236 [info ] [Thread-4 (]: 4 of 4 PASS unique_mfg_ml_features_orders_order_id ............................. [[32mPASS[0m in 2.34s]
[0m14:58:33.102236 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.242 seconds
[0m14:58:33.105967 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:58:33.108081 [info ] [Thread-1 (]: 1 of 4 PASS not_null_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 2.35s]
[0m14:58:33.108081 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:58:33.110736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:33.110736 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m14:58:33.110736 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m14:58:33.592702 [debug] [MainThread]: Connection 'test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213' was left open.
[0m14:58:33.592702 [debug] [MainThread]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: Close
[0m14:58:34.065928 [debug] [MainThread]: Connection 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8' was left open.
[0m14:58:34.065928 [debug] [MainThread]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: Close
[0m14:58:34.516007 [debug] [MainThread]: Connection 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68' was left open.
[0m14:58:34.516007 [debug] [MainThread]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: Close
[0m14:58:34.969990 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m14:58:34.969990 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m14:58:35.415638 [info ] [MainThread]: 
[0m14:58:35.415638 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 6.38 seconds (6.38s).
[0m14:58:35.415638 [debug] [MainThread]: Command end result
[0m14:58:35.447645 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m14:58:35.447645 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m14:58:35.465867 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m14:58:35.465867 [info ] [MainThread]: 
[0m14:58:35.465867 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m14:58:35.465867 [info ] [MainThread]: 
[0m14:58:35.465867 [error] [MainThread]: [31mFailure in test not_null_mfg_plant_daily_kpis_manufacturing_site (models\marts\marts_schema.yml)[0m
[0m14:58:35.465867 [error] [MainThread]:   Database Error in test not_null_mfg_plant_daily_kpis_manufacturing_site (models\marts\marts_schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'MFG_ACCELERATOR.ANALYTICS_ANALYTICS.MFG_PLANT_DAILY_KPIS' does not exist or not authorized.
  compiled code at target\run\mfg_accelerator\models\marts\marts_schema.yml\not_null_mfg_plant_daily_kpis_manufacturing_site.sql
[0m14:58:35.465867 [info ] [MainThread]: 
[0m14:58:35.471901 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\marts\marts_schema.yml\not_null_mfg_plant_daily_kpis_manufacturing_site.sql
[0m14:58:35.473419 [info ] [MainThread]: 
[0m14:58:35.473419 [error] [MainThread]: [31mFailure in test not_null_mfg_plant_daily_kpis_calendar_date (models\marts\marts_schema.yml)[0m
[0m14:58:35.473419 [error] [MainThread]:   Database Error in test not_null_mfg_plant_daily_kpis_calendar_date (models\marts\marts_schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'MFG_ACCELERATOR.ANALYTICS_ANALYTICS.MFG_PLANT_DAILY_KPIS' does not exist or not authorized.
  compiled code at target\run\mfg_accelerator\models\marts\marts_schema.yml\not_null_mfg_plant_daily_kpis_calendar_date.sql
[0m14:58:35.475928 [info ] [MainThread]: 
[0m14:58:35.475928 [info ] [MainThread]:   compiled code at target\compiled\mfg_accelerator\models\marts\marts_schema.yml\not_null_mfg_plant_daily_kpis_calendar_date.sql
[0m14:58:35.475928 [info ] [MainThread]: 
[0m14:58:35.480144 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=4
[0m14:58:35.480144 [debug] [MainThread]: Command `dbt test` failed at 14:58:35.480144 after 8.49 seconds
[0m14:58:35.483399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BE5C59A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BF8D1DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BEDB1F70>]}
[0m14:58:35.483399 [debug] [MainThread]: Flushing usage events
[0m14:58:36.406457 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:59:39.935281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D7F2BBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D83DBFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D83DA570>]}


============================== 14:59:39.942477 | a069c169-33a1-4247-9b12-20c1dbe41459 ==============================
[0m14:59:39.942477 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:59:39.942477 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'invocation_command': 'dbt run --select marts', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m14:59:40.705581 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:59:40.705581 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:59:40.705581 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:59:40.925336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a069c169-33a1-4247-9b12-20c1dbe41459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D6094080>]}
[0m14:59:40.995498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a069c169-33a1-4247-9b12-20c1dbe41459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D8A25D60>]}
[0m14:59:40.995498 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:59:41.475438 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:59:41.635494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:59:41.635494 [debug] [MainThread]: Partial parsing: updated file: mfg_accelerator://models\marts\mfg_plant_daily_kpis.sql
[0m14:59:42.143080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a069c169-33a1-4247-9b12-20c1dbe41459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5ED744CE0>]}
[0m14:59:42.235610 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m14:59:42.237673 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m14:59:42.259595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a069c169-33a1-4247-9b12-20c1dbe41459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5ED7C7260>]}
[0m14:59:42.261603 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:59:42.261603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a069c169-33a1-4247-9b12-20c1dbe41459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5EDA8DBE0>]}
[0m14:59:42.261603 [info ] [MainThread]: 
[0m14:59:42.265374 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:59:42.265374 [info ] [MainThread]: 
[0m14:59:42.265374 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:59:42.273079 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m14:59:42.385212 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m14:59:42.385212 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m14:59:42.385212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:44.181329 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.797 seconds
[0m14:59:44.185930 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m14:59:44.200668 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:59:44.200668 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:59:44.200668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:45.585610 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.383 seconds
[0m14:59:45.585610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a069c169-33a1-4247-9b12-20c1dbe41459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5ED746CC0>]}
[0m14:59:45.591994 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:59:45.591994 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:59:45.591994 [info ] [Thread-1 (]: 1 of 2 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m14:59:45.596246 [info ] [Thread-2 (]: 2 of 2 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m14:59:45.596246 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mfg_accelerator.mfg_ml_features_orders'
[0m14:59:45.596246 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.mfg_plant_daily_kpis'
[0m14:59:45.596246 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m14:59:45.596246 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:59:45.607750 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:59:45.612108 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:59:45.615515 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m14:59:45.625889 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:59:45.655738 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:59:45.655738 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:59:45.661057 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:59:45.661057 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m14:59:45.665670 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:59:45.665670 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:59:45.665670 [debug] [Thread-2 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m14:59:45.665670 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:59:48.786122 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.121 seconds
[0m14:59:48.813327 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a069c169-33a1-4247-9b12-20c1dbe41459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D5EFA570>]}
[0m14:59:48.813327 [info ] [Thread-2 (]: 2 of 2 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 3.22s]
[0m14:59:48.815836 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:59:48.894252 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.225 seconds
[0m14:59:48.900463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a069c169-33a1-4247-9b12-20c1dbe41459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5EE3902C0>]}
[0m14:59:48.900463 [info ] [Thread-1 (]: 1 of 2 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 3.30s]
[0m14:59:48.900463 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:59:48.900463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:48.900463 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR' was left open.
[0m14:59:48.900463 [debug] [MainThread]: On list_MFG_ACCELERATOR: Close
[0m14:59:49.345880 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m14:59:49.345880 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m14:59:49.772747 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m14:59:49.772747 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m14:59:50.216045 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m14:59:50.216045 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m14:59:50.700011 [info ] [MainThread]: 
[0m14:59:50.700011 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 8.43 seconds (8.43s).
[0m14:59:50.700011 [debug] [MainThread]: Command end result
[0m14:59:50.736678 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m14:59:50.736678 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m14:59:50.745980 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m14:59:50.745980 [info ] [MainThread]: 
[0m14:59:50.745980 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:59:50.745980 [info ] [MainThread]: 
[0m14:59:50.745980 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:59:50.745980 [debug] [MainThread]: Command `dbt run` succeeded at 14:59:50.745980 after 10.98 seconds
[0m14:59:50.745980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D5D98710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5EDD67CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5EDCA8560>]}
[0m14:59:50.745980 [debug] [MainThread]: Flushing usage events
[0m14:59:51.802192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:06.455422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C2671EB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C277CFC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C27152ED0>]}


============================== 15:00:06.455422 | da30ca4a-6c21-49c8-9798-54a7cddf3a33 ==============================
[0m15:00:06.455422 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:00:06.455422 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --select marts', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\sanofi-accelerator-mfg-data-platform\\dbt_project\\logs'}
[0m15:00:07.202716 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:00:07.202716 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:00:07.202716 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:00:07.405507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da30ca4a-6c21-49c8-9798-54a7cddf3a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3A37ED80>]}
[0m15:00:07.470439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da30ca4a-6c21-49c8-9798-54a7cddf3a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C26B072C0>]}
[0m15:00:07.475473 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m15:00:07.925115 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:00:08.103386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:00:08.103386 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:00:08.161353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da30ca4a-6c21-49c8-9798-54a7cddf3a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C396FC050>]}
[0m15:00:08.265500 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m15:00:08.267559 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m15:00:08.352899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da30ca4a-6c21-49c8-9798-54a7cddf3a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3BEB5B80>]}
[0m15:00:08.352899 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m15:00:08.355405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da30ca4a-6c21-49c8-9798-54a7cddf3a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3BF7A7B0>]}
[0m15:00:08.355405 [info ] [MainThread]: 
[0m15:00:08.355405 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:00:08.355405 [info ] [MainThread]: 
[0m15:00:08.355405 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:00:08.365495 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m15:00:08.475269 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m15:00:08.475269 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m15:00:08.482998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:10.728301 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.246 seconds
[0m15:00:10.728301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da30ca4a-6c21-49c8-9798-54a7cddf3a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3BED8980>]}
[0m15:00:10.735806 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m15:00:10.735806 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m15:00:10.735806 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m15:00:10.735806 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m15:00:10.735806 [info ] [Thread-1 (]: 1 of 4 START test not_null_mfg_ml_features_orders_order_id ..................... [RUN]
[0m15:00:10.735806 [info ] [Thread-2 (]: 2 of 4 START test not_null_mfg_plant_daily_kpis_calendar_date .................. [RUN]
[0m15:00:10.735806 [info ] [Thread-3 (]: 3 of 4 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............. [RUN]
[0m15:00:10.735806 [info ] [Thread-4 (]: 4 of 4 START test unique_mfg_ml_features_orders_order_id ....................... [RUN]
[0m15:00:10.735806 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213'
[0m15:00:10.735806 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8'
[0m15:00:10.744184 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68'
[0m15:00:10.744184 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd'
[0m15:00:10.745691 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m15:00:10.745691 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m15:00:10.745691 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m15:00:10.745691 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m15:00:10.768227 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m15:00:10.768227 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m15:00:10.776646 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m15:00:10.785592 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m15:00:10.785592 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m15:00:10.785592 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m15:00:10.794280 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m15:00:10.815469 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m15:00:10.815469 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m15:00:10.818541 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m15:00:10.823414 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m15:00:10.826189 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m15:00:10.827840 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m15:00:10.827840 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m15:00:10.827840 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m15:00:10.827840 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m15:00:10.833512 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m15:00:10.834550 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m15:00:10.835557 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m15:00:10.836101 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:00:10.836725 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m15:00:10.836725 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:00:10.836725 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:00:10.836725 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:00:12.578418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.743 seconds
[0m15:00:12.585558 [info ] [Thread-1 (]: 1 of 4 PASS not_null_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 1.85s]
[0m15:00:12.585558 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m15:00:12.945428 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.109 seconds
[0m15:00:12.947843 [info ] [Thread-2 (]: 2 of 4 PASS not_null_mfg_plant_daily_kpis_calendar_date ........................ [[32mPASS[0m in 2.21s]
[0m15:00:12.947843 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m15:00:13.304659 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.467 seconds
[0m15:00:13.305692 [info ] [Thread-3 (]: 3 of 4 PASS not_null_mfg_plant_daily_kpis_manufacturing_site ................... [[32mPASS[0m in 2.56s]
[0m15:00:13.305692 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m15:00:13.416303 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.579 seconds
[0m15:00:13.416303 [info ] [Thread-4 (]: 4 of 4 PASS unique_mfg_ml_features_orders_order_id ............................. [[32mPASS[0m in 2.67s]
[0m15:00:13.416303 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m15:00:13.416303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:13.416303 [debug] [MainThread]: Connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics' was left open.
[0m15:00:13.416303 [debug] [MainThread]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: Close
[0m15:00:13.865548 [debug] [MainThread]: Connection 'test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213' was left open.
[0m15:00:13.865548 [debug] [MainThread]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: Close
[0m15:00:14.407871 [debug] [MainThread]: Connection 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8' was left open.
[0m15:00:14.407871 [debug] [MainThread]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: Close
[0m15:00:14.956922 [debug] [MainThread]: Connection 'test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68' was left open.
[0m15:00:14.956922 [debug] [MainThread]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: Close
[0m15:00:15.445649 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m15:00:15.445649 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m15:00:15.966881 [info ] [MainThread]: 
[0m15:00:15.966881 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 7.61 seconds (7.61s).
[0m15:00:15.966881 [debug] [MainThread]: Command end result
[0m15:00:15.995733 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\manifest.json
[0m15:00:16.005353 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\semantic_manifest.json
[0m15:00:16.013309 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\User\Desktop\Projects\sanofi-accelerator-mfg-data-platform\dbt_project\target\run_results.json
[0m15:00:16.015361 [info ] [MainThread]: 
[0m15:00:16.015361 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:00:16.015361 [info ] [MainThread]: 
[0m15:00:16.015361 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m15:00:16.015361 [debug] [MainThread]: Command `dbt test` succeeded at 15:00:16.015361 after 9.70 seconds
[0m15:00:16.015361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C27152E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C27152ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C27151130>]}
[0m15:00:16.015361 [debug] [MainThread]: Flushing usage events
[0m15:00:16.875351 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:04:13.310485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77431d8e0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77431f88b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77431d8e0e30>]}


============================== 11:04:13.319685 | 99c65b28-f95f-4881-9baf-558cc8ed1283 ==============================
[0m11:04:13.319685 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:04:13.321614 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True', 'write_json': 'True', 'printer_width': '80', 'fail_fast': 'False', 'partial_parse': 'True', 'log_format': 'default', 'quiet': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'no_print': 'None', 'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles'}
[0m11:04:14.116570 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:04:14.118094 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:04:14.119467 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:04:14.195131 [error] [MainThread]:  adapter: Invalid profile: 'user' is a required property.
[0m11:04:14.388966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99c65b28-f95f-4881-9baf-558cc8ed1283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7742fbaf6c90>]}
[0m11:04:14.468933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99c65b28-f95f-4881-9baf-558cc8ed1283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77431db02060>]}
[0m11:04:14.471103 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:04:14.649734 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:04:14.817353 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:04:14.818952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '99c65b28-f95f-4881-9baf-558cc8ed1283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77431c1e4b00>]}
[0m11:04:16.507220 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m11:04:16.509394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '99c65b28-f95f-4881-9baf-558cc8ed1283', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7742fb6b9040>]}
[0m11:04:16.849311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99c65b28-f95f-4881-9baf-558cc8ed1283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7742fa20ecc0>]}
[0m11:04:16.996731 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m11:04:17.003000 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m11:04:17.042844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99c65b28-f95f-4881-9baf-558cc8ed1283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7742fa2ee2a0>]}
[0m11:04:17.044609 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m11:04:17.046031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99c65b28-f95f-4881-9baf-558cc8ed1283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7742fa40a990>]}
[0m11:04:17.049341 [info ] [MainThread]: 
[0m11:04:17.050686 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:04:17.052152 [info ] [MainThread]: 
[0m11:04:17.053827 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:04:17.061747 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_'
[0m11:04:17.110106 [debug] [ThreadPool]: Using snowflake connection "list_"
[0m11:04:17.111642 [debug] [ThreadPool]: On list_: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m11:04:17.112964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:17.117376 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m11:04:17.118684 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:04:17.120091 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m11:04:17.121307 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:04:17.124006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:17.126162 [debug] [MainThread]: Connection 'list_' was left open.
[0m11:04:17.127832 [debug] [MainThread]: On list_: No close available on handle
[0m11:04:17.129218 [info ] [MainThread]: 
[0m11:04:17.130588 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m11:04:17.132073 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database ""
  Database Error
    251005: User is empty, but it must be provided unless authenticator is one of PAT_WITH_EXTERNAL_SESSION, NO_AUTH, OAUTH, PROGRAMMATIC_ACCESS_TOKEN, WORKLOAD_IDENTITY.
[0m11:04:17.133686 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:04:17.135844 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.921848, "process_in_blocks": "3344", "process_kernel_time": 1.352746, "process_mem_max_rss": "214452", "process_out_blocks": "1256", "process_user_time": 5.803201}
[0m11:04:17.137484 [debug] [MainThread]: Command `dbt run` failed at 11:04:17.137339 after 3.92 seconds
[0m11:04:17.139018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77431d8af9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7742fb6170b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7742fa356720>]}
[0m11:04:17.141868 [debug] [MainThread]: Flushing usage events
[0m11:04:17.878739 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:09:22.459142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578c3fcde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578c3157a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578c2e54230>]}


============================== 11:09:22.467051 | d12cadb8-944f-4f34-9ebf-59d29321527e ==============================
[0m11:09:22.467051 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:09:22.468660 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'quiet': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'static_parser': 'True', 'introspect': 'True', 'version_check': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'printer_width': '80', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'empty': 'False', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_cache_events': 'False', 'log_format': 'default', 'use_colors': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m11:09:23.291247 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:09:23.293339 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:09:23.295567 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:09:23.361829 [error] [MainThread]:  adapter: Invalid profile: 'user' is a required property.
[0m11:09:23.507641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd12cadb8-944f-4f34-9ebf-59d29321527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578c31a1ee0>]}
[0m11:09:23.580552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd12cadb8-944f-4f34-9ebf-59d29321527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578a7520800>]}
[0m11:09:23.583250 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:09:23.740070 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:09:24.016875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:09:24.018902 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:09:24.089503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd12cadb8-944f-4f34-9ebf-59d29321527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578a51e0680>]}
[0m11:09:24.257125 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m11:09:24.266767 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m11:09:24.305535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd12cadb8-944f-4f34-9ebf-59d29321527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578a47ab080>]}
[0m11:09:24.306953 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m11:09:24.308451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd12cadb8-944f-4f34-9ebf-59d29321527e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578a47503b0>]}
[0m11:09:24.314460 [info ] [MainThread]: 
[0m11:09:24.316586 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:09:24.318175 [info ] [MainThread]: 
[0m11:09:24.319721 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:09:24.325525 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_'
[0m11:09:24.375547 [debug] [ThreadPool]: Using snowflake connection "list_"
[0m11:09:24.377785 [debug] [ThreadPool]: On list_: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m11:09:24.379503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:24.384136 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m11:09:24.385517 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:09:24.386931 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m11:09:24.388342 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:09:24.390297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:24.391572 [debug] [MainThread]: Connection 'list_' was left open.
[0m11:09:24.393022 [debug] [MainThread]: On list_: No close available on handle
[0m11:09:24.394347 [info ] [MainThread]: 
[0m11:09:24.395919 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m11:09:24.397516 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database ""
  Database Error
    251005: User is empty, but it must be provided unless authenticator is one of PROGRAMMATIC_ACCESS_TOKEN, NO_AUTH, WORKLOAD_IDENTITY, OAUTH, PAT_WITH_EXTERNAL_SESSION.
[0m11:09:24.399484 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.024958, "process_in_blocks": "0", "process_kernel_time": 1.280511, "process_mem_max_rss": "206984", "process_out_blocks": "0", "process_user_time": 3.961209}
[0m11:09:24.401066 [debug] [MainThread]: Command `dbt run` failed at 11:09:24.400930 after 2.03 seconds
[0m11:09:24.402402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578c1df03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578a4bc14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578a478a300>]}
[0m11:09:24.403620 [debug] [MainThread]: Flushing usage events
[0m11:09:25.037072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:15.920415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa6c289e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa6c275cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa6c403bad0>]}


============================== 11:46:15.928612 | d55e198a-50b3-4559-a813-acb712a48d20 ==============================
[0m11:46:15.928612 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:46:15.930397 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'debug': 'False', 'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'fail_fast': 'False', 'introspect': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'quiet': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'no_print': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'write_json': 'True'}
[0m11:46:16.648224 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:46:16.649801 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:46:16.651208 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:46:16.714130 [error] [MainThread]:  adapter: Invalid profile: 'user' is a required property.
[0m11:46:16.865683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd55e198a-50b3-4559-a813-acb712a48d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa6a4400980>]}
[0m11:46:16.937234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd55e198a-50b3-4559-a813-acb712a48d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa6a41b3dd0>]}
[0m11:46:16.939345 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:46:17.095016 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:46:17.349547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:17.351003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:17.400648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd55e198a-50b3-4559-a813-acb712a48d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa6a4164320>]}
[0m11:46:17.526322 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m11:46:17.534166 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m11:46:17.567667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd55e198a-50b3-4559-a813-acb712a48d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa69fc9b320>]}
[0m11:46:17.569145 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m11:46:17.570375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd55e198a-50b3-4559-a813-acb712a48d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa6a4145340>]}
[0m11:46:17.573674 [info ] [MainThread]: 
[0m11:46:17.575034 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:46:17.576623 [info ] [MainThread]: 
[0m11:46:17.578783 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:46:17.585346 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_'
[0m11:46:17.632030 [debug] [ThreadPool]: Using snowflake connection "list_"
[0m11:46:17.633463 [debug] [ThreadPool]: On list_: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m11:46:17.634724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:17.639650 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m11:46:17.641724 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:46:17.643677 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m11:46:17.645312 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:46:17.647692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:17.649146 [debug] [MainThread]: Connection 'list_' was left open.
[0m11:46:17.650559 [debug] [MainThread]: On list_: No close available on handle
[0m11:46:17.651752 [info ] [MainThread]: 
[0m11:46:17.653093 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m11:46:17.654573 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database ""
  Database Error
    251005: User is empty, but it must be provided unless authenticator is one of PROGRAMMATIC_ACCESS_TOKEN, WORKLOAD_IDENTITY, PAT_WITH_EXTERNAL_SESSION, NO_AUTH, OAUTH.
[0m11:46:17.656561 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8203367, "process_in_blocks": "0", "process_kernel_time": 1.196564, "process_mem_max_rss": "207184", "process_out_blocks": "0", "process_user_time": 3.597669}
[0m11:46:17.658268 [debug] [MainThread]: Command `dbt run` failed at 11:46:17.658087 after 1.82 seconds
[0m11:46:17.659628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa6c1355c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa69f035490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa69ff0b830>]}
[0m11:46:17.661220 [debug] [MainThread]: Flushing usage events
[0m11:46:18.309745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:22.361270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931194b7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931181a8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793118da7ec0>]}


============================== 11:51:22.370708 | 4fde6060-611f-4bd6-a135-3f40e775ac57 ==============================
[0m11:51:22.370708 [info ] [MainThread]: Running with dbt=1.10.15
[0m11:51:22.372337 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'quiet': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'empty': 'False'}
[0m11:51:23.109008 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:51:23.110727 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:51:23.112184 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:51:23.175118 [error] [MainThread]:  adapter: Invalid profile: 'user' is a required property.
[0m11:51:23.327304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fde6060-611f-4bd6-a135-3f40e775ac57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7930f6d024e0>]}
[0m11:51:23.402491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fde6060-611f-4bd6-a135-3f40e775ac57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793117dea780>]}
[0m11:51:23.404444 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m11:51:23.571150 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m11:51:23.854736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:51:23.856274 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:51:23.915228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fde6060-611f-4bd6-a135-3f40e775ac57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793117f62b10>]}
[0m11:51:24.045843 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m11:51:24.054067 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m11:51:24.087850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fde6060-611f-4bd6-a135-3f40e775ac57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7930f6a23d70>]}
[0m11:51:24.089341 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m11:51:24.090739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fde6060-611f-4bd6-a135-3f40e775ac57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7930f6e89340>]}
[0m11:51:24.093965 [info ] [MainThread]: 
[0m11:51:24.095516 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:51:24.097062 [info ] [MainThread]: 
[0m11:51:24.099024 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:51:24.105115 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_'
[0m11:51:24.154141 [debug] [ThreadPool]: Using snowflake connection "list_"
[0m11:51:24.155667 [debug] [ThreadPool]: On list_: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m11:51:24.157063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:24.161716 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m11:51:24.163391 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:51:24.165431 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m11:51:24.166872 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:51:24.168842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:24.170086 [debug] [MainThread]: Connection 'list_' was left open.
[0m11:51:24.171401 [debug] [MainThread]: On list_: No close available on handle
[0m11:51:24.172651 [info ] [MainThread]: 
[0m11:51:24.174087 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m11:51:24.175685 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database ""
  Database Error
    251005: User is empty, but it must be provided unless authenticator is one of OAUTH, PAT_WITH_EXTERNAL_SESSION, WORKLOAD_IDENTITY, PROGRAMMATIC_ACCESS_TOKEN, NO_AUTH.
[0m11:51:24.177717 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9125297, "process_in_blocks": "0", "process_kernel_time": 1.238331, "process_mem_max_rss": "206896", "process_out_blocks": "0", "process_user_time": 3.826843}
[0m11:51:24.179360 [debug] [MainThread]: Command `dbt run` failed at 11:51:24.179187 after 1.91 seconds
[0m11:51:24.180952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793117f5e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7931194b7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7930f5d595e0>]}
[0m11:51:24.182555 [debug] [MainThread]: Flushing usage events
[0m11:51:24.848234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:16:20.392296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726153c53d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7261523a9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726151f5e240>]}


============================== 12:16:20.400602 | 4d251e0e-6df9-4282-abcd-a41e0b434799 ==============================
[0m12:16:20.400602 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:16:20.402313 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'version_check': 'True', 'target_path': 'None', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'quiet': 'False', 'write_json': 'True', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'static_parser': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager'}
[0m12:16:21.113907 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:16:21.115579 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:16:21.116952 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:16:21.187269 [error] [MainThread]:  adapter: Invalid profile: 'user' is a required property.
[0m12:16:21.330009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d251e0e-6df9-4282-abcd-a41e0b434799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72613790a540>]}
[0m12:16:21.398618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d251e0e-6df9-4282-abcd-a41e0b434799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72612ffb6b10>]}
[0m12:16:21.400647 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m12:16:21.557529 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:16:21.841883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:16:21.843613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:16:21.905184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d251e0e-6df9-4282-abcd-a41e0b434799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72612ff7f320>]}
[0m12:16:22.055384 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:16:22.063185 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:16:22.096509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d251e0e-6df9-4282-abcd-a41e0b434799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72612f803e30>]}
[0m12:16:22.097912 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m12:16:22.099121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d251e0e-6df9-4282-abcd-a41e0b434799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72612f9dae10>]}
[0m12:16:22.102374 [info ] [MainThread]: 
[0m12:16:22.103739 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:16:22.104935 [info ] [MainThread]: 
[0m12:16:22.106484 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:16:22.112719 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_'
[0m12:16:22.155282 [debug] [ThreadPool]: Using snowflake connection "list_"
[0m12:16:22.157243 [debug] [ThreadPool]: On list_: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m12:16:22.159193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:22.164127 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m12:16:22.165449 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:16:22.166867 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m12:16:22.168048 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:16:22.169925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:22.171194 [debug] [MainThread]: Connection 'list_' was left open.
[0m12:16:22.172490 [debug] [MainThread]: On list_: No close available on handle
[0m12:16:22.174567 [info ] [MainThread]: 
[0m12:16:22.177426 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m12:16:22.180979 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database ""
  Database Error
    251005: User is empty, but it must be provided unless authenticator is one of NO_AUTH, OAUTH, PAT_WITH_EXTERNAL_SESSION, WORKLOAD_IDENTITY, PROGRAMMATIC_ACCESS_TOKEN.
[0m12:16:22.185499 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.877425, "process_in_blocks": "0", "process_kernel_time": 1.188332, "process_mem_max_rss": "207400", "process_out_blocks": "1256", "process_user_time": 3.600887}
[0m12:16:22.188261 [debug] [MainThread]: Command `dbt run` failed at 12:16:22.187983 after 1.88 seconds
[0m12:16:22.190375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7261511a9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72612fa44290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72612f803c50>]}
[0m12:16:22.192547 [debug] [MainThread]: Flushing usage events
[0m12:16:22.996365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:26.839495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc8cdea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc7e65a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc952c6b0>]}


============================== 12:21:26.847616 | 48c3318d-4df3-4b24-a95d-23e3d589c7ec ==============================
[0m12:21:26.847616 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:21:26.849365 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_format': 'default', 'indirect_selection': 'eager', 'write_json': 'True', 'printer_width': '80', 'empty': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'quiet': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles'}
[0m12:21:27.566590 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:21:27.568344 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:21:27.570123 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:21:27.632638 [error] [MainThread]:  adapter: Invalid profile: 'user' is a required property.
[0m12:21:27.787924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48c3318d-4df3-4b24-a95d-23e3d589c7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc77b2270>]}
[0m12:21:27.867355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48c3318d-4df3-4b24-a95d-23e3d589c7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da6a3d3d0>]}
[0m12:21:27.869230 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m12:21:28.028068 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:21:28.287506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:21:28.289276 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:21:28.341358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48c3318d-4df3-4b24-a95d-23e3d589c7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc7996d20>]}
[0m12:21:28.472095 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:21:28.478497 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:21:28.511182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48c3318d-4df3-4b24-a95d-23e3d589c7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da6356450>]}
[0m12:21:28.513476 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m12:21:28.515164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48c3318d-4df3-4b24-a95d-23e3d589c7ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da63288c0>]}
[0m12:21:28.518783 [info ] [MainThread]: 
[0m12:21:28.520189 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:21:28.521454 [info ] [MainThread]: 
[0m12:21:28.522979 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:21:28.528992 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_'
[0m12:21:28.574207 [debug] [ThreadPool]: Using snowflake connection "list_"
[0m12:21:28.575820 [debug] [ThreadPool]: On list_: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m12:21:28.577178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:28.581489 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: show terse schemas in database 
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_"} */
[0m12:21:28.582981 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:21:28.584474 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m12:21:28.585749 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:21:28.587682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:28.589157 [debug] [MainThread]: Connection 'list_' was left open.
[0m12:21:28.590641 [debug] [MainThread]: On list_: No close available on handle
[0m12:21:28.591881 [info ] [MainThread]: 
[0m12:21:28.593236 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m12:21:28.594701 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database ""
  Database Error
    251005: User is empty, but it must be provided unless authenticator is one of PROGRAMMATIC_ACCESS_TOKEN, PAT_WITH_EXTERNAL_SESSION, WORKLOAD_IDENTITY, NO_AUTH, OAUTH.
[0m12:21:28.596545 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8508052, "process_in_blocks": "0", "process_kernel_time": 1.203511, "process_mem_max_rss": "207220", "process_out_blocks": "0", "process_user_time": 3.802456}
[0m12:21:28.598027 [debug] [MainThread]: Command `dbt run` failed at 12:21:28.597890 after 1.85 seconds
[0m12:21:28.599386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc7af45c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da6357fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da61f8710>]}
[0m12:21:28.600743 [debug] [MainThread]: Flushing usage events
[0m12:21:29.398707 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:04.714627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a12873b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a12e7bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a10f36660>]}


============================== 12:57:04.725125 | 18f15b79-eb7e-4a3d-953d-8c71f98a41bb ==============================
[0m12:57:04.725125 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:57:04.727136 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'target_path': 'None', 'warn_error': 'None', 'write_json': 'True', 'log_format': 'default', 'empty': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'quiet': 'False', 'use_colors': 'True', 'introspect': 'True', 'printer_width': '80', 'fail_fast': 'False', 'partial_parse': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_cache_events': 'False'}
[0m12:57:05.514687 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:57:05.516476 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:57:05.518145 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:57:05.742729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a115fe2a0>]}
[0m12:57:05.819088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a12b6e8d0>]}
[0m12:57:05.820951 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m12:57:06.006669 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:57:06.151481 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:57:06.154045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a10e91370>]}
[0m12:57:07.785478 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m12:57:07.787428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399edab53d0>]}
[0m12:57:08.106690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399ed89de50>]}
[0m12:57:08.241325 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:57:08.249188 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:57:08.283549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399ed8d0680>]}
[0m12:57:08.284899 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m12:57:08.286243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399eed8b950>]}
[0m12:57:08.289618 [info ] [MainThread]: 
[0m12:57:08.290851 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:57:08.292123 [info ] [MainThread]: 
[0m12:57:08.293807 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:57:08.300617 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m12:57:08.346282 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m12:57:08.348273 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m12:57:08.349634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:09.869747 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.520 seconds
[0m12:57:09.874383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m12:57:09.890214 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m12:57:09.891972 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m12:57:10.295469 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.402 seconds
[0m12:57:10.301111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399eec7bb30>]}
[0m12:57:10.309336 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m12:57:10.310010 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m12:57:10.310592 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m12:57:10.312584 [info ] [Thread-1 (]: 1 of 8 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m12:57:10.314609 [info ] [Thread-2 (]: 2 of 8 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m12:57:10.316500 [info ] [Thread-3 (]: 3 of 8 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m12:57:10.318021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m12:57:10.319694 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m12:57:10.321205 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m12:57:10.322545 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m12:57:10.323958 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m12:57:10.325304 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m12:57:10.335590 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m12:57:10.340579 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m12:57:10.344427 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m12:57:10.353303 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m12:57:10.354190 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m12:57:10.361167 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m12:57:10.404849 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m12:57:10.415819 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m12:57:10.419071 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m12:57:10.428900 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m12:57:10.431262 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m12:57:10.432801 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m12:57:10.435305 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m12:57:10.435872 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m12:57:10.439361 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m12:57:10.441574 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:57:10.443258 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:57:10.904419 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m12:57:10.935395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a12b6a540>]}
[0m12:57:10.937309 [info ] [Thread-1 (]: 1 of 8 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 0.62s]
[0m12:57:10.938941 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m12:57:11.913661 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.470 seconds
[0m12:57:11.919775 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399c5706f30>]}
[0m12:57:11.921989 [info ] [Thread-3 (]: 3 of 8 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 1.60s]
[0m12:57:11.923983 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m12:57:11.943626 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.502 seconds
[0m12:57:11.949020 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399ec9d37a0>]}
[0m12:57:11.950924 [info ] [Thread-2 (]: 2 of 8 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 1.63s]
[0m12:57:11.952747 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m12:57:11.955027 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.core_materials
[0m12:57:11.956743 [info ] [Thread-4 (]: 4 of 8 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m12:57:11.958574 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_materials'
[0m12:57:11.960079 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.core_materials
[0m12:57:11.965729 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m12:57:11.976055 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.core_materials
[0m12:57:12.006509 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m12:57:12.020432 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m12:57:12.021939 [debug] [Thread-4 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m12:57:12.023162 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:57:14.652140 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.629 seconds
[0m12:57:14.656024 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399c57b5460>]}
[0m12:57:14.657825 [info ] [Thread-4 (]: 4 of 8 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 2.70s]
[0m12:57:14.659893 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.core_materials
[0m12:57:14.662203 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.core_batches
[0m12:57:14.663689 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m12:57:14.665148 [info ] [Thread-3 (]: 5 of 8 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m12:57:14.666905 [info ] [Thread-2 (]: 6 of 8 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m12:57:14.668565 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_production_orders, now model.mfg_accelerator.core_batches)
[0m12:57:14.670319 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_materials, now model.mfg_accelerator.fct_production_orders)
[0m12:57:14.671897 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.core_batches
[0m12:57:14.673213 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m12:57:14.677512 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m12:57:14.683334 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m12:57:14.694313 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.core_batches
[0m12:57:14.696249 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m12:57:14.701997 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m12:57:14.707296 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m12:57:14.720130 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m12:57:14.722229 [debug] [Thread-3 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m12:57:14.726653 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m12:57:14.731037 [debug] [Thread-2 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m12:57:18.542656 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.814 seconds
[0m12:57:18.547109 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399c57089b0>]}
[0m12:57:18.549301 [info ] [Thread-3 (]: 5 of 8 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 3.88s]
[0m12:57:18.551041 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.core_batches
[0m12:57:31.117924 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 16.389 seconds
[0m12:57:31.121733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399c5709a00>]}
[0m12:57:31.123539 [info ] [Thread-2 (]: 6 of 8 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 16.45s]
[0m12:57:31.125453 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m12:57:31.127994 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m12:57:31.128794 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m12:57:31.130279 [info ] [Thread-4 (]: 7 of 8 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m12:57:31.132102 [info ] [Thread-1 (]: 8 of 8 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m12:57:31.133543 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.core_materials, now model.mfg_accelerator.mfg_ml_features_orders)
[0m12:57:31.135071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_batches, now model.mfg_accelerator.mfg_plant_daily_kpis)
[0m12:57:31.136245 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m12:57:31.137680 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m12:57:31.142412 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m12:57:31.148817 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m12:57:31.156452 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m12:57:31.161708 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m12:57:31.162486 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m12:57:31.169729 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m12:57:31.179004 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m12:57:31.181147 [debug] [Thread-4 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m12:57:31.185810 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m12:57:31.188975 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m12:57:37.264491 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 6.074 seconds
[0m12:57:37.269153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399ec99bc80>]}
[0m12:57:37.271287 [info ] [Thread-1 (]: 8 of 8 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 6.13s]
[0m12:57:37.273319 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m13:07:34.904773 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 603.789 seconds
[0m13:07:34.909274 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f15b79-eb7e-4a3d-953d-8c71f98a41bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399c57e79b0>]}
[0m13:07:34.911001 [info ] [Thread-4 (]: 7 of 8 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 603.78s]
[0m13:07:34.912743 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m13:07:34.916300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:34.917903 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m13:07:34.919640 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m13:07:35.983212 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m13:07:35.984651 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m13:07:36.931741 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m13:07:36.933509 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m13:07:37.837702 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m13:07:37.839418 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m13:07:38.267979 [info ] [MainThread]: 
[0m13:07:38.270283 [info ] [MainThread]: Finished running 5 table models, 3 view models in 0 hours 10 minutes and 29.97 seconds (629.97s).
[0m13:07:38.273959 [debug] [MainThread]: Command end result
[0m13:07:38.336456 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m13:07:38.345019 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m13:07:38.359878 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m13:07:38.361112 [info ] [MainThread]: 
[0m13:07:38.362341 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:07:38.363642 [info ] [MainThread]: 
[0m13:07:38.364956 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m13:07:38.366641 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:07:38.369445 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 633.82385, "process_in_blocks": "40", "process_kernel_time": 1.367591, "process_mem_max_rss": "229744", "process_out_blocks": "1272", "process_user_time": 6.610024}
[0m13:07:38.371618 [debug] [MainThread]: Command `dbt run` succeeded at 13:07:38.371353 after 633.83 seconds
[0m13:07:38.373315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a115807a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a10f36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a1067e510>]}
[0m13:07:38.374739 [debug] [MainThread]: Flushing usage events
[0m13:07:39.185075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:07:43.133624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c255a26e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c255b6c8740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c255a15aa50>]}


============================== 13:07:43.143030 | ac2db550-cf85-46bb-82df-eee00583579d ==============================
[0m13:07:43.143030 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:07:43.144484 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt_project/logs', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m13:07:43.909306 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:07:43.910927 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:07:43.912354 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:07:44.150736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac2db550-cf85-46bb-82df-eee00583579d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c253e562300>]}
[0m13:07:44.231759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac2db550-cf85-46bb-82df-eee00583579d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2559d0deb0>]}
[0m13:07:44.233993 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m13:07:44.408741 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m13:07:44.689276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:07:44.690960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:07:44.745403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac2db550-cf85-46bb-82df-eee00583579d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2537bce8d0>]}
[0m13:07:44.880760 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m13:07:44.888406 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m13:07:44.932153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac2db550-cf85-46bb-82df-eee00583579d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2537630140>]}
[0m13:07:44.933807 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m13:07:44.935159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac2db550-cf85-46bb-82df-eee00583579d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2537621f40>]}
[0m13:07:44.940942 [info ] [MainThread]: 
[0m13:07:44.942894 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:07:44.944304 [info ] [MainThread]: 
[0m13:07:44.945943 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:07:44.952446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m13:07:45.007989 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m13:07:45.009634 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m13:07:45.011038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:46.623815 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.613 seconds
[0m13:07:46.629071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac2db550-cf85-46bb-82df-eee00583579d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c255b2a14c0>]}
[0m13:07:46.636295 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m13:07:46.637275 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m13:07:46.638304 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m13:07:46.639124 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m13:07:46.640271 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m13:07:46.641893 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m13:07:46.643639 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m13:07:46.645198 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m13:07:46.647009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m13:07:46.648569 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m13:07:46.650096 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m13:07:46.651707 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m13:07:46.653279 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m13:07:46.655538 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m13:07:46.657175 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m13:07:46.658690 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m13:07:46.679458 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m13:07:46.684099 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m13:07:46.691258 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m13:07:46.696483 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m13:07:46.707664 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m13:07:46.708539 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m13:07:46.709546 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m13:07:46.721936 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m13:07:46.745112 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m13:07:46.747370 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m13:07:46.751678 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m13:07:46.756376 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m13:07:46.765536 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m13:07:46.767004 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m13:07:46.768392 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m13:07:46.769897 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m13:07:46.772000 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m13:07:46.773496 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m13:07:46.775050 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:07:46.776594 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m13:07:46.777849 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m13:07:46.779098 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:07:46.788294 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:07:47.105939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.315 seconds
[0m13:07:47.116734 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.47s]
[0m13:07:47.118513 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m13:07:47.120429 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m13:07:47.123068 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m13:07:47.124851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m13:07:47.126387 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m13:07:47.131566 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m13:07:47.144955 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m13:07:47.149026 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m13:07:47.162237 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m13:07:47.163609 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m13:07:47.674356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.510 seconds
[0m13:07:47.678422 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.55s]
[0m13:07:47.680333 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m13:07:47.682083 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m13:07:47.683720 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m13:07:47.685394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m13:07:47.686905 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m13:07:47.692923 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m13:07:47.705543 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m13:07:47.709431 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m13:07:47.722743 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m13:07:47.724232 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m13:07:48.178770 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.391 seconds
[0m13:07:48.182159 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.53s]
[0m13:07:48.184170 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m13:07:48.185941 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.407 seconds
[0m13:07:48.187470 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m13:07:48.191917 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.54s]
[0m13:07:48.193138 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.468 seconds
[0m13:07:48.194816 [info ] [Thread-3 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m13:07:48.196601 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m13:07:48.199747 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.51s]
[0m13:07:48.201451 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m13:07:48.203061 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m13:07:48.205378 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m13:07:48.207125 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m13:07:48.208582 [info ] [Thread-2 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m13:07:48.210329 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m13:07:48.215799 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m13:07:48.217443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m13:07:48.218868 [info ] [Thread-1 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m13:07:48.222263 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m13:07:48.224106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m13:07:48.229840 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m13:07:48.231470 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m13:07:48.242063 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m13:07:48.243984 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m13:07:48.249532 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m13:07:48.250280 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m13:07:48.257109 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m13:07:48.260570 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m13:07:48.265527 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m13:07:48.268396 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m13:07:48.269854 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m13:07:48.271787 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m13:07:48.273632 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m13:07:48.280573 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m13:07:48.282455 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m13:07:48.291157 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.516 seconds
[0m13:07:48.294789 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.64s]
[0m13:07:48.296500 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m13:07:48.297988 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m13:07:48.299400 [info ] [Thread-4 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m13:07:48.300953 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m13:07:48.302323 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m13:07:48.308783 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m13:07:48.320941 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m13:07:48.325486 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m13:07:48.338533 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m13:07:48.340172 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m13:07:48.677896 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.336 seconds
[0m13:07:48.681895 [info ] [Thread-4 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.38s]
[0m13:07:48.683933 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m13:07:48.685745 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m13:07:48.687928 [info ] [Thread-4 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m13:07:48.690251 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m13:07:48.691980 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m13:07:48.698548 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m13:07:48.714098 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m13:07:48.719274 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m13:07:48.733581 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m13:07:48.735212 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m13:07:48.922659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m13:07:48.927329 [info ] [Thread-1 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.70s]
[0m13:07:48.929776 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m13:07:48.931616 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m13:07:48.933370 [info ] [Thread-1 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m13:07:48.935317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m13:07:48.937220 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m13:07:48.944086 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m13:07:48.962557 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m13:07:48.974936 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m13:07:48.990936 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m13:07:48.992310 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m13:07:49.073131 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.336 seconds
[0m13:07:49.076709 [info ] [Thread-4 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.39s]
[0m13:07:49.078526 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m13:07:49.080028 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m13:07:49.081497 [info ] [Thread-4 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m13:07:49.083185 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m13:07:49.084583 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m13:07:49.090846 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m13:07:49.103871 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m13:07:49.109973 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m13:07:49.125923 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m13:07:49.127322 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m13:07:49.325012 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.050 seconds
[0m13:07:49.330077 [info ] [Thread-2 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 1.11s]
[0m13:07:49.332461 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m13:07:49.334469 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m13:07:49.336444 [info ] [Thread-2 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m13:07:49.339205 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m13:07:49.340987 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m13:07:49.354435 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m13:07:49.369221 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m13:07:49.375165 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m13:07:49.387208 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.110 seconds
[0m13:07:49.393970 [info ] [Thread-3 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 1.19s]
[0m13:07:49.397088 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m13:07:49.399407 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m13:07:49.401052 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m13:07:49.402955 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m13:07:49.405483 [info ] [Thread-3 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m13:07:49.410456 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m13:07:49.412806 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m13:07:49.425039 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m13:07:49.441129 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m13:07:49.446180 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m13:07:49.460711 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m13:07:49.462165 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m13:07:49.494512 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m13:07:49.499284 [info ] [Thread-1 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.56s]
[0m13:07:49.502013 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m13:07:49.504357 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m13:07:49.506705 [info ] [Thread-1 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m13:07:49.508798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m13:07:49.510445 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m13:07:49.521416 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m13:07:49.535567 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.407 seconds
[0m13:07:49.542078 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m13:07:49.541183 [info ] [Thread-4 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.46s]
[0m13:07:49.548379 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m13:07:49.550744 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m13:07:49.554499 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m13:07:49.556888 [info ] [Thread-4 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m13:07:49.559551 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m13:07:49.561765 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m13:07:49.574733 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m13:07:49.579489 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m13:07:49.581893 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m13:07:49.590930 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m13:07:49.596208 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m13:07:49.611427 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m13:07:49.613186 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m13:07:49.770091 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.363 seconds
[0m13:07:49.774399 [info ] [Thread-2 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.44s]
[0m13:07:49.776380 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m13:07:49.777849 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m13:07:49.779274 [info ] [Thread-2 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m13:07:49.780705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m13:07:49.782038 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m13:07:49.790616 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m13:07:49.803186 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m13:07:49.808942 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m13:07:49.822239 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m13:07:49.823705 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m13:07:50.030003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.446 seconds
[0m13:07:50.034069 [info ] [Thread-1 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.53s]
[0m13:07:50.035916 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.421 seconds
[0m13:07:50.037702 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m13:07:50.039213 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m13:07:50.042511 [info ] [Thread-4 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.48s]
[0m13:07:50.044187 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m13:07:50.047334 [info ] [Thread-3 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.64s]
[0m13:07:50.049276 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m13:07:50.050970 [info ] [Thread-1 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m13:07:50.052753 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m13:07:50.054483 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m13:07:50.056497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m13:07:50.058002 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m13:07:50.059359 [info ] [Thread-4 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m13:07:50.060883 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m13:07:50.062259 [info ] [Thread-3 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m13:07:50.063824 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m13:07:50.069844 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m13:07:50.071726 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m13:07:50.073609 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m13:07:50.076245 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m13:07:50.081966 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m13:07:50.089097 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m13:07:50.091301 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m13:07:50.097805 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m13:07:50.102214 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m13:07:50.109712 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m13:07:50.110549 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m13:07:50.117534 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m13:07:50.121005 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m13:07:50.123265 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m13:07:50.125274 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m13:07:50.130662 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m13:07:50.132805 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m13:07:50.136927 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m13:07:50.192012 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.367 seconds
[0m13:07:50.195486 [error] [Thread-2 (]: 18 of 24 FAIL 10000 unique_core_batches_batch_id ............................... [[31mFAIL 10000[0m in 0.41s]
[0m13:07:50.197335 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m13:07:50.198969 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m13:07:50.200371 [info ] [Thread-2 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m13:07:50.201846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m13:07:50.203271 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m13:07:50.210786 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m13:07:50.222347 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m13:07:50.226369 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m13:07:50.240323 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m13:07:50.241864 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m13:07:50.446584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.320 seconds
[0m13:07:50.451097 [error] [Thread-1 (]: 19 of 24 FAIL 500 unique_core_materials_material_id ............................ [[31mFAIL 500[0m in 0.39s]
[0m13:07:50.452988 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m13:07:50.454991 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m13:07:50.456844 [info ] [Thread-1 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m13:07:50.458496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m13:07:50.459887 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m13:07:50.465706 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m13:07:50.479532 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m13:07:50.483724 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m13:07:50.488952 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.354 seconds
[0m13:07:50.493662 [error] [Thread-4 (]: 20 of 24 FAIL 10000 unique_fct_production_orders_order_id ...................... [[31mFAIL 10000[0m in 0.43s]
[0m13:07:50.496061 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m13:07:50.497861 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m13:07:50.499493 [info ] [Thread-4 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m13:07:50.501861 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m13:07:50.504013 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m13:07:50.505551 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m13:07:50.507453 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m13:07:50.513750 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m13:07:50.530342 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m13:07:50.534718 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m13:07:50.548240 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m13:07:50.549481 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m13:07:50.581371 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.338 seconds
[0m13:07:50.584559 [error] [Thread-2 (]: 22 of 24 FAIL 10000 unique_stg_batches_batch_id ................................ [[31mFAIL 10000[0m in 0.38s]
[0m13:07:50.586180 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m13:07:50.970605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.455 seconds
[0m13:07:50.974984 [error] [Thread-1 (]: 23 of 24 FAIL 500 unique_stg_materials_material_id ............................. [[31mFAIL 500[0m in 0.52s]
[0m13:07:50.977301 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m13:07:51.091951 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.541 seconds
[0m13:07:51.096245 [error] [Thread-4 (]: 24 of 24 FAIL 10000 unique_stg_production_orders_order_id ...................... [[31mFAIL 10000[0m in 0.59s]
[0m13:07:51.098091 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m13:07:57.921521 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 7.782 seconds
[0m13:07:57.927004 [error] [Thread-3 (]: 21 of 24 FAIL 10000 unique_mfg_ml_features_orders_order_id ..................... [[31mFAIL 10000[0m in 7.86s]
[0m13:07:57.929050 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m13:07:57.932576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:57.934160 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m13:07:57.935852 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m13:07:58.461648 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m13:07:58.463313 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m13:07:58.892263 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m13:07:58.895090 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m13:07:59.347004 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m13:07:59.348826 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m13:07:59.772129 [info ] [MainThread]: 
[0m13:07:59.773843 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 14.83 seconds (14.83s).
[0m13:07:59.779436 [debug] [MainThread]: Command end result
[0m13:07:59.864525 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m13:07:59.874778 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m13:07:59.894498 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m13:07:59.895903 [info ] [MainThread]: 
[0m13:07:59.897336 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m13:07:59.898628 [info ] [MainThread]: 
[0m13:07:59.900064 [error] [MainThread]: [31mFailure in test unique_core_batches_batch_id (models/core/core_schema.yml)[0m
[0m13:07:59.901877 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:07:59.904364 [info ] [MainThread]: 
[0m13:07:59.906045 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/core/core_schema.yml/unique_core_batches_batch_id.sql
[0m13:07:59.907494 [info ] [MainThread]: 
[0m13:07:59.908849 [error] [MainThread]: [31mFailure in test unique_core_materials_material_id (models/core/core_schema.yml)[0m
[0m13:07:59.910233 [error] [MainThread]:   Got 500 results, configured to fail if != 0
[0m13:07:59.911567 [info ] [MainThread]: 
[0m13:07:59.912930 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/core/core_schema.yml/unique_core_materials_material_id.sql
[0m13:07:59.914299 [info ] [MainThread]: 
[0m13:07:59.915771 [error] [MainThread]: [31mFailure in test unique_fct_production_orders_order_id (models/core/core_schema.yml)[0m
[0m13:07:59.917134 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:07:59.918664 [info ] [MainThread]: 
[0m13:07:59.920986 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/core/core_schema.yml/unique_fct_production_orders_order_id.sql
[0m13:07:59.922740 [info ] [MainThread]: 
[0m13:07:59.924726 [error] [MainThread]: [31mFailure in test unique_stg_batches_batch_id (models/staging/staging_schema.yml)[0m
[0m13:07:59.926151 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:07:59.927486 [info ] [MainThread]: 
[0m13:07:59.928702 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/staging/staging_schema.yml/unique_stg_batches_batch_id.sql
[0m13:07:59.929903 [info ] [MainThread]: 
[0m13:07:59.931234 [error] [MainThread]: [31mFailure in test unique_stg_materials_material_id (models/staging/staging_schema.yml)[0m
[0m13:07:59.933369 [error] [MainThread]:   Got 500 results, configured to fail if != 0
[0m13:07:59.935425 [info ] [MainThread]: 
[0m13:07:59.938090 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/staging/staging_schema.yml/unique_stg_materials_material_id.sql
[0m13:07:59.940145 [info ] [MainThread]: 
[0m13:07:59.941883 [error] [MainThread]: [31mFailure in test unique_stg_production_orders_order_id (models/staging/staging_schema.yml)[0m
[0m13:07:59.943762 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:07:59.945430 [info ] [MainThread]: 
[0m13:07:59.947264 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/staging/staging_schema.yml/unique_stg_production_orders_order_id.sql
[0m13:07:59.949034 [info ] [MainThread]: 
[0m13:07:59.950783 [error] [MainThread]: [31mFailure in test unique_mfg_ml_features_orders_order_id (models/marts/marts_schema.yml)[0m
[0m13:07:59.953265 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:07:59.955318 [info ] [MainThread]: 
[0m13:07:59.957587 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/marts/marts_schema.yml/unique_mfg_ml_features_orders_order_id.sql
[0m13:07:59.959446 [info ] [MainThread]: 
[0m13:07:59.961189 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=7 SKIP=0 NO-OP=0 TOTAL=24
[0m13:07:59.963666 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 16.915257, "process_in_blocks": "0", "process_kernel_time": 1.400955, "process_mem_max_rss": "224200", "process_out_blocks": "16", "process_user_time": 5.164777}
[0m13:07:59.965756 [debug] [MainThread]: Command `dbt test` failed at 13:07:59.965588 after 16.92 seconds
[0m13:07:59.967282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c255ba2b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c255bd93f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c25345efa40>]}
[0m13:07:59.968787 [debug] [MainThread]: Flushing usage events
[0m13:08:00.590240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:13:04.297901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72faadd36cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72faadd37560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72faadd37ec0>]}


============================== 13:13:04.306153 | 39434e54-2432-4e86-bba2-6507dc7e18c9 ==============================
[0m13:13:04.306153 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:13:04.307855 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'printer_width': '80', 'partial_parse': 'True', 'introspect': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'quiet': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False'}
[0m13:13:04.979785 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:13:04.981871 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:13:04.983598 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:13:05.179418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39434e54-2432-4e86-bba2-6507dc7e18c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fa9102e960>]}
[0m13:13:05.246231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39434e54-2432-4e86-bba2-6507dc7e18c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fa92659af0>]}
[0m13:13:05.248217 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m13:13:05.398590 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m13:13:05.736219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:13:05.737826 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:13:05.787721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39434e54-2432-4e86-bba2-6507dc7e18c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fa8bed5580>]}
[0m13:13:05.913321 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m13:13:05.921171 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m13:13:05.964951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39434e54-2432-4e86-bba2-6507dc7e18c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fa8b987710>]}
[0m13:13:05.966463 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m13:13:05.967644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39434e54-2432-4e86-bba2-6507dc7e18c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fa90395c70>]}
[0m13:13:05.971539 [info ] [MainThread]: 
[0m13:13:05.972813 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:13:05.974232 [info ] [MainThread]: 
[0m13:13:05.975746 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:13:05.981741 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m13:13:06.031466 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m13:13:06.032700 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m13:13:06.033775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:07.727837 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.694 seconds
[0m13:13:07.733421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39434e54-2432-4e86-bba2-6507dc7e18c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fa9031d040>]}
[0m13:13:07.740707 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m13:13:07.741420 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m13:13:07.742119 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m13:13:07.742756 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m13:13:07.743786 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m13:13:07.745467 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m13:13:07.746947 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m13:13:07.748719 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m13:13:07.750617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m13:13:07.752489 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m13:13:07.753843 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m13:13:07.755382 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m13:13:07.756776 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m13:13:07.758275 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m13:13:07.759601 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m13:13:07.760875 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m13:13:07.783083 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m13:13:07.788002 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m13:13:07.793467 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m13:13:07.799116 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m13:13:07.808423 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m13:13:07.809373 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m13:13:07.810671 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m13:13:07.822648 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m13:13:07.848900 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m13:13:07.850952 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m13:13:07.855501 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m13:13:07.860502 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m13:13:07.872148 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m13:13:07.875013 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m13:13:07.876125 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m13:13:07.877644 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m13:13:07.879096 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m13:13:07.880583 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m13:13:07.882600 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:13:07.884649 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m13:13:07.886520 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m13:13:07.897583 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:13:07.899220 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:13:08.391163 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m13:13:08.402779 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.65s]
[0m13:13:08.404605 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m13:13:08.406139 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m13:13:08.407659 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m13:13:08.409315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m13:13:08.410764 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m13:13:08.418175 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m13:13:08.450874 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m13:13:08.456639 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m13:13:08.468925 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m13:13:08.470507 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m13:13:08.729428 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m13:13:08.733181 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.32s]
[0m13:13:08.735119 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m13:13:08.736801 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m13:13:08.738351 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m13:13:08.739956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m13:13:08.741528 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m13:13:08.746791 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m13:13:08.760028 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m13:13:08.764160 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m13:13:08.778485 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m13:13:08.780023 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m13:13:09.051662 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.270 seconds
[0m13:13:09.055565 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.32s]
[0m13:13:09.057663 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m13:13:09.059268 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m13:13:09.060812 [info ] [Thread-1 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m13:13:09.062781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m13:13:09.064484 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m13:13:09.070563 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m13:13:09.083507 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m13:13:09.089990 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m13:13:09.107854 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m13:13:09.109330 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m13:13:09.250988 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.368 seconds
[0m13:13:09.254407 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.50s]
[0m13:13:09.256131 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m13:13:09.257669 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m13:13:09.259114 [info ] [Thread-2 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m13:13:09.260553 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m13:13:09.261970 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m13:13:09.267021 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m13:13:09.278220 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.379 seconds
[0m13:13:09.282633 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.53s]
[0m13:13:09.283562 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m13:13:09.285150 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m13:13:09.289361 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m13:13:09.290913 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m13:13:09.293513 [info ] [Thread-3 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m13:13:09.294987 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m13:13:09.296447 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m13:13:09.303002 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m13:13:09.306810 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m13:13:09.308228 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m13:13:09.316199 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m13:13:09.320690 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m13:13:09.332442 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m13:13:09.333866 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m13:13:09.407142 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.510 seconds
[0m13:13:09.410280 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.65s]
[0m13:13:09.411980 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m13:13:09.413443 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m13:13:09.414700 [info ] [Thread-4 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m13:13:09.416227 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m13:13:09.417466 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m13:13:09.422524 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m13:13:09.432009 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m13:13:09.436143 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m13:13:09.438427 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.328 seconds
[0m13:13:09.443246 [info ] [Thread-1 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 0.38s]
[0m13:13:09.445450 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m13:13:09.447084 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m13:13:09.448529 [info ] [Thread-1 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m13:13:09.450273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m13:13:09.451931 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m13:13:09.452899 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m13:13:09.454186 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m13:13:09.459510 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m13:13:09.473456 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m13:13:09.477554 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m13:13:09.490577 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m13:13:09.492120 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m13:13:09.568653 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.259 seconds
[0m13:13:09.572372 [info ] [Thread-2 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 0.31s]
[0m13:13:09.574193 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m13:13:09.575734 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m13:13:09.577315 [info ] [Thread-2 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m13:13:09.578925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m13:13:09.580350 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m13:13:09.587463 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m13:13:09.600190 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m13:13:09.604014 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m13:13:09.615375 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m13:13:09.616664 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m13:13:09.647198 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.312 seconds
[0m13:13:09.650867 [info ] [Thread-3 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.36s]
[0m13:13:09.652730 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m13:13:09.654330 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m13:13:09.655742 [info ] [Thread-3 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m13:13:09.657282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m13:13:09.658804 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m13:13:09.663898 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m13:13:09.675262 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m13:13:09.679376 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m13:13:09.692500 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m13:13:09.694101 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m13:13:09.757277 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.296 seconds
[0m13:13:09.761945 [info ] [Thread-4 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.35s]
[0m13:13:09.764378 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m13:13:09.766371 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m13:13:09.768800 [info ] [Thread-4 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m13:13:09.771738 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m13:13:09.773773 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m13:13:09.790181 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m13:13:09.792649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.299 seconds
[0m13:13:09.800076 [info ] [Thread-1 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.35s]
[0m13:13:09.802696 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m13:13:09.804661 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m13:13:09.806136 [info ] [Thread-1 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m13:13:09.808219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m13:13:09.810327 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m13:13:09.811443 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m13:13:09.819628 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m13:13:09.824361 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m13:13:09.839169 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m13:13:09.841086 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m13:13:09.845875 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m13:13:09.847847 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m13:13:09.863862 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m13:13:09.865509 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m13:13:09.889420 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.272 seconds
[0m13:13:09.892859 [info ] [Thread-2 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.31s]
[0m13:13:09.894503 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m13:13:09.896076 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m13:13:09.897630 [info ] [Thread-2 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m13:13:09.899160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m13:13:09.900656 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m13:13:09.906697 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m13:13:09.918625 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m13:13:09.924474 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m13:13:09.943506 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m13:13:09.945865 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m13:13:09.968239 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.272 seconds
[0m13:13:09.972949 [info ] [Thread-3 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.32s]
[0m13:13:09.975908 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m13:13:09.978261 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m13:13:09.980353 [info ] [Thread-3 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m13:13:09.982169 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m13:13:09.983914 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m13:13:09.994219 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m13:13:10.012712 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m13:13:10.021420 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m13:13:10.042119 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m13:13:10.043837 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m13:13:10.119998 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.269 seconds
[0m13:13:10.124385 [info ] [Thread-4 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.35s]
[0m13:13:10.126338 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m13:13:10.127848 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m13:13:10.129435 [info ] [Thread-4 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m13:13:10.131083 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m13:13:10.132569 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m13:13:10.140744 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m13:13:10.142899 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.276 seconds
[0m13:13:10.147498 [info ] [Thread-1 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.34s]
[0m13:13:10.149475 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m13:13:10.151040 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m13:13:10.152389 [info ] [Thread-1 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m13:13:10.153913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m13:13:10.155474 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m13:13:10.161480 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m13:13:10.162018 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m13:13:10.167867 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m13:13:10.175782 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m13:13:10.180787 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m13:13:10.183479 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m13:13:10.185206 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m13:13:10.195178 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m13:13:10.197021 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m13:13:10.305639 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.358 seconds
[0m13:13:10.315012 [info ] [Thread-2 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.42s]
[0m13:13:10.318579 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m13:13:10.321354 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m13:13:10.323817 [info ] [Thread-2 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m13:13:10.326595 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m13:13:10.329050 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m13:13:10.341611 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m13:13:10.344144 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m13:13:10.350950 [info ] [Thread-3 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.37s]
[0m13:13:10.353787 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m13:13:10.356362 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m13:13:10.358453 [info ] [Thread-3 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m13:13:10.361048 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m13:13:10.362955 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m13:13:10.363838 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m13:13:10.369433 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m13:13:10.376394 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m13:13:10.391131 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m13:13:10.392246 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m13:13:10.394368 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m13:13:10.402219 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m13:13:10.419077 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m13:13:10.420613 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m13:13:10.426480 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m13:13:10.432390 [error] [Thread-4 (]: 18 of 24 FAIL 10000 unique_core_batches_batch_id ............................... [[31mFAIL 10000[0m in 0.30s]
[0m13:13:10.434758 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m13:13:10.436334 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m13:13:10.437883 [info ] [Thread-4 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m13:13:10.439973 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m13:13:10.442307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.244 seconds
[0m13:13:10.443980 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m13:13:10.449746 [error] [Thread-1 (]: 19 of 24 FAIL 500 unique_core_materials_material_id ............................ [[31mFAIL 500[0m in 0.30s]
[0m13:13:10.458185 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m13:13:10.460334 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m13:13:10.463294 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m13:13:10.465004 [info ] [Thread-1 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m13:13:10.467156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m13:13:10.469511 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m13:13:10.478901 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m13:13:10.481446 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m13:13:10.487931 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m13:13:10.491653 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m13:13:10.500904 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m13:13:10.510871 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m13:13:10.512988 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m13:13:10.514658 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m13:13:10.516415 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m13:13:10.650653 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m13:13:10.657637 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.235 seconds
[0m13:13:10.655925 [error] [Thread-2 (]: 20 of 24 FAIL 10000 unique_fct_production_orders_order_id ...................... [[31mFAIL 10000[0m in 0.33s]
[0m13:13:10.661837 [error] [Thread-3 (]: 21 of 24 FAIL 10000 unique_mfg_ml_features_orders_order_id ..................... [[31mFAIL 10000[0m in 0.30s]
[0m13:13:10.664448 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m13:13:10.666872 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m13:13:10.668803 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m13:13:10.671692 [info ] [Thread-2 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m13:13:10.673442 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m13:13:10.675008 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m13:13:10.683711 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m13:13:10.696958 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m13:13:10.701626 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m13:13:10.714877 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m13:13:10.716368 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m13:13:10.763646 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.243 seconds
[0m13:13:10.767323 [error] [Thread-1 (]: 23 of 24 FAIL 500 unique_stg_materials_material_id ............................. [[31mFAIL 500[0m in 0.30s]
[0m13:13:10.769094 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m13:13:10.842927 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.325 seconds
[0m13:13:10.846322 [error] [Thread-4 (]: 22 of 24 FAIL 10000 unique_stg_batches_batch_id ................................ [[31mFAIL 10000[0m in 0.41s]
[0m13:13:10.848268 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m13:13:10.971937 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.254 seconds
[0m13:13:10.975498 [error] [Thread-2 (]: 24 of 24 FAIL 10000 unique_stg_production_orders_order_id ...................... [[31mFAIL 10000[0m in 0.30s]
[0m13:13:10.977293 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m13:13:10.980546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:10.982166 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m13:13:10.983559 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m13:13:11.385700 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m13:13:11.387323 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m13:13:11.841708 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m13:13:11.843968 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m13:13:12.312094 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m13:13:12.314016 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m13:13:12.726441 [info ] [MainThread]: 
[0m13:13:12.728372 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 6.75 seconds (6.75s).
[0m13:13:12.735137 [debug] [MainThread]: Command end result
[0m13:13:12.823863 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m13:13:12.832369 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m13:13:12.849409 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m13:13:12.850893 [info ] [MainThread]: 
[0m13:13:12.852521 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m13:13:12.854141 [info ] [MainThread]: 
[0m13:13:12.855786 [error] [MainThread]: [31mFailure in test unique_core_batches_batch_id (models/core/core_schema.yml)[0m
[0m13:13:12.857454 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:13:12.858917 [info ] [MainThread]: 
[0m13:13:12.860553 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/core/core_schema.yml/unique_core_batches_batch_id.sql
[0m13:13:12.861941 [info ] [MainThread]: 
[0m13:13:12.863630 [error] [MainThread]: [31mFailure in test unique_core_materials_material_id (models/core/core_schema.yml)[0m
[0m13:13:12.865388 [error] [MainThread]:   Got 500 results, configured to fail if != 0
[0m13:13:12.866832 [info ] [MainThread]: 
[0m13:13:12.868416 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/core/core_schema.yml/unique_core_materials_material_id.sql
[0m13:13:12.869884 [info ] [MainThread]: 
[0m13:13:12.871353 [error] [MainThread]: [31mFailure in test unique_fct_production_orders_order_id (models/core/core_schema.yml)[0m
[0m13:13:12.872919 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:13:12.874395 [info ] [MainThread]: 
[0m13:13:12.876134 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/core/core_schema.yml/unique_fct_production_orders_order_id.sql
[0m13:13:12.877997 [info ] [MainThread]: 
[0m13:13:12.879791 [error] [MainThread]: [31mFailure in test unique_mfg_ml_features_orders_order_id (models/marts/marts_schema.yml)[0m
[0m13:13:12.881561 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:13:12.883065 [info ] [MainThread]: 
[0m13:13:12.884711 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/marts/marts_schema.yml/unique_mfg_ml_features_orders_order_id.sql
[0m13:13:12.886251 [info ] [MainThread]: 
[0m13:13:12.887978 [error] [MainThread]: [31mFailure in test unique_stg_materials_material_id (models/staging/staging_schema.yml)[0m
[0m13:13:12.889723 [error] [MainThread]:   Got 500 results, configured to fail if != 0
[0m13:13:12.891288 [info ] [MainThread]: 
[0m13:13:12.892954 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/staging/staging_schema.yml/unique_stg_materials_material_id.sql
[0m13:13:12.894433 [info ] [MainThread]: 
[0m13:13:12.896013 [error] [MainThread]: [31mFailure in test unique_stg_batches_batch_id (models/staging/staging_schema.yml)[0m
[0m13:13:12.897749 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:13:12.899185 [info ] [MainThread]: 
[0m13:13:12.900711 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/staging/staging_schema.yml/unique_stg_batches_batch_id.sql
[0m13:13:12.902311 [info ] [MainThread]: 
[0m13:13:12.904588 [error] [MainThread]: [31mFailure in test unique_stg_production_orders_order_id (models/staging/staging_schema.yml)[0m
[0m13:13:12.906978 [error] [MainThread]:   Got 10000 results, configured to fail if != 0
[0m13:13:12.908513 [info ] [MainThread]: 
[0m13:13:12.910264 [info ] [MainThread]:   compiled code at target/compiled/mfg_accelerator/models/staging/staging_schema.yml/unique_stg_production_orders_order_id.sql
[0m13:13:12.912120 [info ] [MainThread]: 
[0m13:13:12.913819 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=7 SKIP=0 NO-OP=0 TOTAL=24
[0m13:13:12.916360 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 8.706298, "process_in_blocks": "0", "process_kernel_time": 1.261551, "process_mem_max_rss": "224188", "process_out_blocks": "16", "process_user_time": 4.806672}
[0m13:13:12.918187 [debug] [MainThread]: Command `dbt test` failed at 13:13:12.918019 after 8.71 seconds
[0m13:13:12.919834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72faadf4deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72faadd36cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fa8bef03e0>]}
[0m13:13:12.921496 [debug] [MainThread]: Flushing usage events
[0m13:13:13.616053 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:34.129669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe801bb6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe7fae57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe7fae7fe0>]}


============================== 13:59:34.137593 | 84ced0b6-c756-4fcb-8a10-2dd0c68d6acb ==============================
[0m13:59:34.137593 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:59:34.139372 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'write_json': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'debug': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'empty': 'False', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt_profiles', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'version_check': 'True'}
[0m13:59:34.886478 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m13:59:34.888152 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m13:59:34.889683 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m13:59:35.100241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5dcf9af0>]}
[0m13:59:35.171679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe64793590>]}
[0m13:59:35.173798 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m13:59:35.336559 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m13:59:35.644179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:35.645735 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:35.699675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5dbf25d0>]}
[0m13:59:35.824679 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m13:59:35.831715 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m13:59:35.864109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5d907dd0>]}
[0m13:59:35.865479 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m13:59:35.866948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5d87ee70>]}
[0m13:59:35.870472 [info ] [MainThread]: 
[0m13:59:35.872343 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:59:35.873801 [info ] [MainThread]: 
[0m13:59:35.875309 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:59:35.881418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m13:59:35.926204 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m13:59:35.928007 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m13:59:35.929395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:37.438195 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.509 seconds
[0m13:59:37.442832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m13:59:37.458778 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m13:59:37.460671 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m13:59:37.744978 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.283 seconds
[0m13:59:37.758260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5d824980>]}
[0m13:59:37.774574 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m13:59:37.776221 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m13:59:37.777503 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m13:59:37.780432 [info ] [Thread-1 (]: 1 of 8 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m13:59:37.785886 [info ] [Thread-2 (]: 2 of 8 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m13:59:37.788444 [info ] [Thread-3 (]: 3 of 8 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m13:59:37.791010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m13:59:37.793987 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m13:59:37.796593 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m13:59:37.798410 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m13:59:37.801171 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m13:59:37.803016 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m13:59:37.822340 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m13:59:37.888917 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m13:59:37.892640 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m13:59:37.900899 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m13:59:37.902050 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m13:59:37.908742 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m13:59:37.957495 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m13:59:37.959460 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m13:59:37.962945 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m13:59:37.973868 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m13:59:37.976671 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m13:59:37.978888 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m13:59:37.980202 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m13:59:37.982183 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m13:59:37.984084 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m13:59:37.985811 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:59:37.987740 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:59:38.396816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.407 seconds
[0m13:59:38.424046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe81842240>]}
[0m13:59:38.425818 [info ] [Thread-1 (]: 1 of 8 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 0.63s]
[0m13:59:38.427665 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m13:59:39.616130 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.628 seconds
[0m13:59:39.617987 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.632 seconds
[0m13:59:39.621978 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5dad78c0>]}
[0m13:59:39.625704 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5d6a75f0>]}
[0m13:59:39.627397 [info ] [Thread-3 (]: 3 of 8 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 1.83s]
[0m13:59:39.629369 [info ] [Thread-2 (]: 2 of 8 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 1.83s]
[0m13:59:39.631024 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m13:59:39.632813 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m13:59:39.635936 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.core_materials
[0m13:59:39.637715 [info ] [Thread-4 (]: 4 of 8 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m13:59:39.639297 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_materials'
[0m13:59:39.640852 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.core_materials
[0m13:59:39.646313 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m13:59:39.658326 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.core_materials
[0m13:59:39.689509 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m13:59:39.702975 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m13:59:39.704469 [debug] [Thread-4 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m13:59:39.705764 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:59:41.589126 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.883 seconds
[0m13:59:41.592911 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5c937ce0>]}
[0m13:59:41.594582 [info ] [Thread-4 (]: 4 of 8 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 1.95s]
[0m13:59:41.596218 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.core_materials
[0m13:59:41.598396 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.core_batches
[0m13:59:41.599121 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m13:59:41.600665 [info ] [Thread-3 (]: 5 of 8 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m13:59:41.603635 [info ] [Thread-2 (]: 6 of 8 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m13:59:41.605786 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_production_orders, now model.mfg_accelerator.core_batches)
[0m13:59:41.607640 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_materials, now model.mfg_accelerator.fct_production_orders)
[0m13:59:41.609008 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.core_batches
[0m13:59:41.610437 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m13:59:41.614767 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m13:59:41.620642 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m13:59:41.627967 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.core_batches
[0m13:59:41.629738 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m13:59:41.633746 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m13:59:41.639089 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m13:59:41.649388 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m13:59:41.652471 [debug] [Thread-3 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m13:59:41.656836 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m13:59:41.661821 [debug] [Thread-2 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m13:59:45.622460 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.963 seconds
[0m13:59:45.626196 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe7ee375c0>]}
[0m13:59:45.627700 [info ] [Thread-3 (]: 5 of 8 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 4.02s]
[0m13:59:45.629181 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.core_batches
[0m14:00:04.065131 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 22.403 seconds
[0m14:00:04.073976 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5c93f0e0>]}
[0m14:00:04.077152 [info ] [Thread-2 (]: 6 of 8 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 22.47s]
[0m14:00:04.079798 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m14:00:04.083333 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:00:04.084765 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:00:04.087090 [info ] [Thread-4 (]: 7 of 8 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m14:00:04.089542 [info ] [Thread-1 (]: 8 of 8 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m14:00:04.091946 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.core_materials, now model.mfg_accelerator.mfg_ml_features_orders)
[0m14:00:04.094232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_batches, now model.mfg_accelerator.mfg_plant_daily_kpis)
[0m14:00:04.096347 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m14:00:04.098193 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:00:04.108339 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:00:04.115262 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:00:04.122763 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:00:04.129525 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m14:00:04.129110 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:00:04.134107 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:00:04.144913 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:00:04.148549 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:00:04.149869 [debug] [Thread-4 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m14:00:04.151798 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m14:00:13.141609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 8.986 seconds
[0m14:00:13.146022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ced0b6-c756-4fcb-8a10-2dd0c68d6acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe5c9705f0>]}
[0m14:00:13.147724 [info ] [Thread-1 (]: 8 of 8 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 9.05s]
[0m14:00:13.149977 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:05:05.820529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa86650e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa868766960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8664dba70>]}


============================== 14:05:05.829862 | 0fc58a16-4ce2-45bf-83fc-95e0a69791d5 ==============================
[0m14:05:05.829862 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:05:05.831579 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt_profiles', 'indirect_selection': 'eager', 'version_check': 'True', 'printer_width': '80', 'empty': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'warn_error': 'None', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'quiet': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'write_json': 'True', 'log_path': '/opt/airflow/dbt_project/logs'}
[0m14:05:06.572890 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:05:06.574941 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:05:06.576553 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:05:06.809431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa84ac26450>]}
[0m14:05:06.888077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa866297530>]}
[0m14:05:06.890641 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:05:07.064916 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:05:07.351855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:07.353605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:07.415096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa849280200>]}
[0m14:05:07.552207 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:05:07.561208 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:05:07.597039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa843fb2ae0>]}
[0m14:05:07.598489 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:05:07.599903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa843f87080>]}
[0m14:05:07.604172 [info ] [MainThread]: 
[0m14:05:07.606328 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:05:07.607735 [info ] [MainThread]: 
[0m14:05:07.609319 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:05:07.615207 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m14:05:07.663237 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m14:05:07.664830 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m14:05:07.666258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:09.157759 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.491 seconds
[0m14:05:09.162561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m14:05:09.179544 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:05:09.181632 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:05:09.560911 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.377 seconds
[0m14:05:09.566283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8482999d0>]}
[0m14:05:09.574322 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m14:05:09.574996 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m14:05:09.575611 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m14:05:09.577096 [info ] [Thread-1 (]: 1 of 8 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m14:05:09.579019 [info ] [Thread-2 (]: 2 of 8 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m14:05:09.580842 [info ] [Thread-3 (]: 3 of 8 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m14:05:09.582590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m14:05:09.584133 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m14:05:09.585487 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m14:05:09.587301 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m14:05:09.589676 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m14:05:09.591354 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m14:05:09.601282 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m14:05:09.671207 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m14:05:09.676123 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m14:05:09.684415 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m14:05:09.685306 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m14:05:09.697814 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m14:05:09.744440 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m14:05:09.750135 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m14:05:09.750934 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m14:05:09.761325 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m14:05:09.764473 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m14:05:09.765197 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m14:05:09.766994 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m14:05:09.768697 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m14:05:09.771043 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:05:09.773568 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m14:05:09.783670 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:05:10.331958 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.557 seconds
[0m14:05:10.396676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8680cf020>]}
[0m14:05:10.398576 [info ] [Thread-1 (]: 1 of 8 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 0.81s]
[0m14:05:10.400416 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m14:05:11.612672 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.842 seconds
[0m14:05:11.618745 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8680cf020>]}
[0m14:05:11.621456 [info ] [Thread-2 (]: 2 of 8 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 2.03s]
[0m14:05:11.624011 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m14:05:11.626410 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.core_materials
[0m14:05:11.628585 [info ] [Thread-4 (]: 4 of 8 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m14:05:11.631139 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_materials'
[0m14:05:11.633254 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.core_materials
[0m14:05:11.641311 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m14:05:11.648498 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.865 seconds
[0m14:05:11.657433 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa848706810>]}
[0m14:05:11.661315 [info ] [Thread-3 (]: 3 of 8 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 2.07s]
[0m14:05:11.662857 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.core_materials
[0m14:05:11.664947 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m14:05:11.700425 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m14:05:11.712846 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m14:05:11.714045 [debug] [Thread-4 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m14:05:11.715050 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:05:13.815694 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.101 seconds
[0m14:05:13.819538 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8654687d0>]}
[0m14:05:13.821783 [info ] [Thread-4 (]: 4 of 8 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 2.19s]
[0m14:05:13.824192 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.core_materials
[0m14:05:13.826412 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.core_batches
[0m14:05:13.827405 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m14:05:13.828483 [info ] [Thread-2 (]: 5 of 8 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m14:05:13.830224 [info ] [Thread-1 (]: 6 of 8 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m14:05:13.831644 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_materials, now model.mfg_accelerator.core_batches)
[0m14:05:13.833075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_batches, now model.mfg_accelerator.fct_production_orders)
[0m14:05:13.834633 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.core_batches
[0m14:05:13.836115 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m14:05:13.842128 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m14:05:13.846778 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m14:05:13.856526 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.core_batches
[0m14:05:13.861735 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m14:05:13.862343 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m14:05:13.867447 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m14:05:13.877123 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m14:05:13.880487 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m14:05:13.881766 [debug] [Thread-2 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m14:05:13.883429 [debug] [Thread-1 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m14:05:15.262591 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.378 seconds
[0m14:05:15.266806 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa843e0ef00>]}
[0m14:05:15.268565 [info ] [Thread-2 (]: 5 of 8 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 1.44s]
[0m14:05:15.270467 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.core_batches
[0m14:05:16.073685 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.186 seconds
[0m14:05:16.079304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa84308ab10>]}
[0m14:05:16.081227 [info ] [Thread-1 (]: 6 of 8 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 2.25s]
[0m14:05:16.083047 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m14:05:16.085007 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:05:16.085795 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:05:16.087254 [info ] [Thread-4 (]: 7 of 8 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m14:05:16.091316 [info ] [Thread-3 (]: 8 of 8 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m14:05:16.093592 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.core_materials, now model.mfg_accelerator.mfg_ml_features_orders)
[0m14:05:16.095487 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_production_orders, now model.mfg_accelerator.mfg_plant_daily_kpis)
[0m14:05:16.097070 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m14:05:16.098435 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:05:16.103640 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:05:16.112113 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:05:16.120004 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:05:16.122950 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m14:05:16.130401 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:05:16.134202 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:05:16.148938 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:05:16.152049 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:05:16.153569 [debug] [Thread-3 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m14:05:16.157885 [debug] [Thread-4 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m14:05:17.466011 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.306 seconds
[0m14:05:17.469720 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa843092f30>]}
[0m14:05:17.472132 [info ] [Thread-3 (]: 8 of 8 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 1.37s]
[0m14:05:17.474556 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:05:17.562120 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.400 seconds
[0m14:05:17.565962 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fc58a16-4ce2-45bf-83fc-95e0a69791d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8430a7380>]}
[0m14:05:17.567754 [info ] [Thread-4 (]: 7 of 8 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 1.47s]
[0m14:05:17.569922 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:05:17.574150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:17.575923 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m14:05:17.577376 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m14:05:17.998402 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m14:05:18.010379 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m14:05:18.457240 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m14:05:18.459412 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m14:05:18.920092 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m14:05:18.922858 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m14:05:19.341195 [info ] [MainThread]: 
[0m14:05:19.343390 [info ] [MainThread]: Finished running 5 table models, 3 view models in 0 hours 0 minutes and 11.73 seconds (11.73s).
[0m14:05:19.346965 [debug] [MainThread]: Command end result
[0m14:05:19.415218 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:05:19.422949 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:05:19.437012 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:05:19.438861 [info ] [MainThread]: 
[0m14:05:19.440984 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:19.442299 [info ] [MainThread]: 
[0m14:05:19.443650 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m14:05:19.445864 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.71813, "process_in_blocks": "0", "process_kernel_time": 1.311729, "process_mem_max_rss": "221724", "process_out_blocks": "16", "process_user_time": 4.985376}
[0m14:05:19.447407 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:19.447286 after 13.72 seconds
[0m14:05:19.448826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa865833fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa866983ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa866dd3320>]}
[0m14:05:19.450235 [debug] [MainThread]: Flushing usage events
[0m14:05:20.204087 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:24.291428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92118c3cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92118c2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92117e1850>]}


============================== 14:05:24.301360 | d01ed73f-cd11-4c8f-a2c8-2700bbe719de ==============================
[0m14:05:24.301360 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:05:24.303413 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'target_path': 'None', 'quiet': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'no_print': 'None', 'empty': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:05:25.428658 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:05:25.430711 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:05:25.432538 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:05:25.706697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd01ed73f-cd11-4c8f-a2c8-2700bbe719de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91f505dc70>]}
[0m14:05:25.797692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd01ed73f-cd11-4c8f-a2c8-2700bbe719de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91f44f5c70>]}
[0m14:05:25.799985 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:05:26.008995 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:05:26.540039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:26.542256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:26.621002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd01ed73f-cd11-4c8f-a2c8-2700bbe719de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91f43051c0>]}
[0m14:05:26.833313 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:05:26.843905 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:05:26.893152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd01ed73f-cd11-4c8f-a2c8-2700bbe719de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91efe9f110>]}
[0m14:05:26.894738 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:05:26.895915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd01ed73f-cd11-4c8f-a2c8-2700bbe719de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91f43f9880>]}
[0m14:05:26.899783 [info ] [MainThread]: 
[0m14:05:26.900713 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:05:26.901888 [info ] [MainThread]: 
[0m14:05:26.903678 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:05:26.911720 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m14:05:26.977377 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:05:26.978997 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:05:26.980359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:28.472636 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.495 seconds
[0m14:05:28.478472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd01ed73f-cd11-4c8f-a2c8-2700bbe719de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91f44cdca0>]}
[0m14:05:28.486038 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:05:28.486748 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:05:28.487361 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:05:28.488086 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:05:28.489159 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m14:05:28.491016 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m14:05:28.492774 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m14:05:28.494426 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m14:05:28.495967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m14:05:28.497602 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m14:05:28.499131 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m14:05:28.500560 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m14:05:28.502037 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:05:28.503368 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:05:28.505120 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:05:28.506820 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:05:28.525788 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:05:28.530483 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:05:28.535815 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:05:28.541519 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:05:28.551193 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:05:28.552285 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:05:28.553768 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:05:28.559712 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:05:28.583875 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:05:28.584382 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:05:28.589892 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:05:28.594107 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:05:28.604010 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:05:28.605277 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:05:28.607021 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:05:28.607726 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m14:05:28.609199 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:05:28.610897 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m14:05:28.612516 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m14:05:28.614233 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:05:28.615707 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m14:05:28.617157 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:05:28.624456 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:05:28.991936 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.373 seconds
[0m14:05:29.003231 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.51s]
[0m14:05:29.005418 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:05:29.007078 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:05:29.008698 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m14:05:29.010333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m14:05:29.011775 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:05:29.017358 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:05:29.031374 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:05:29.035562 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:05:29.047739 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:05:29.049166 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m14:05:29.438815 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.388 seconds
[0m14:05:29.442124 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.43s]
[0m14:05:29.443740 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:05:29.445225 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:05:29.446700 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m14:05:29.448151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m14:05:29.449536 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:05:29.455491 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:05:29.469558 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:05:29.473807 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:05:29.485869 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:05:29.487783 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m14:05:29.899631 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.285 seconds
[0m14:05:29.904168 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.40s]
[0m14:05:29.906168 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:05:29.907705 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:05:29.909201 [info ] [Thread-3 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m14:05:29.910940 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m14:05:29.912401 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:05:29.917823 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:05:29.919148 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m14:05:29.924644 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.48s]
[0m14:05:29.926676 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:05:29.928221 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:05:29.929654 [info ] [Thread-1 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m14:05:29.931141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m14:05:29.932680 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:05:29.933773 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:05:29.940623 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:05:29.946052 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:05:29.958898 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:05:29.960181 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:05:29.964093 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:05:29.965591 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m14:05:29.979167 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:05:29.980597 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m14:05:30.107072 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.483 seconds
[0m14:05:30.110248 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.61s]
[0m14:05:30.111883 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:05:30.113375 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:05:30.114763 [info ] [Thread-4 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m14:05:30.116450 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m14:05:30.118077 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:05:30.123459 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:05:30.136417 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:05:30.141948 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:05:30.155241 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:05:30.156574 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m14:05:30.190937 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.574 seconds
[0m14:05:30.194428 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.70s]
[0m14:05:30.196263 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:05:30.197796 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:05:30.199290 [info ] [Thread-2 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m14:05:30.201000 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m14:05:30.202506 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:05:30.207851 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:05:30.221743 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:05:30.225592 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:05:30.238442 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:05:30.239717 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m14:05:30.459990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.478 seconds
[0m14:05:30.463245 [info ] [Thread-1 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 0.53s]
[0m14:05:30.465051 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:05:30.466596 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:05:30.468395 [info ] [Thread-1 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m14:05:30.470757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m14:05:30.472225 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:05:30.477889 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:05:30.490408 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:05:30.496539 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:05:30.515007 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:05:30.517455 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m14:05:30.534281 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.376 seconds
[0m14:05:30.538562 [info ] [Thread-4 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.42s]
[0m14:05:30.540814 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:05:30.542602 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:05:30.544233 [info ] [Thread-4 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m14:05:30.546071 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m14:05:30.547645 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:05:30.554115 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:05:30.575661 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:05:30.582162 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:05:30.595989 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:05:30.597574 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m14:05:30.876474 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.908 seconds
[0m14:05:30.879659 [info ] [Thread-3 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 0.97s]
[0m14:05:30.881348 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:05:30.882773 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:05:30.884134 [info ] [Thread-3 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m14:05:30.885520 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m14:05:30.887008 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:05:30.892908 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:05:30.895799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.376 seconds
[0m14:05:30.900410 [info ] [Thread-1 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.43s]
[0m14:05:30.902749 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:05:30.904880 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:05:30.906688 [info ] [Thread-1 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m14:05:30.908536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m14:05:30.910277 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:05:30.911751 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m14:05:30.912554 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:05:30.922422 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:05:30.925415 [info ] [Thread-2 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.72s]
[0m14:05:30.929632 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:05:30.932516 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:05:30.935594 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:05:30.937863 [info ] [Thread-2 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m14:05:30.940623 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m14:05:30.942591 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:05:30.950787 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:05:30.952758 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:05:30.957275 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:05:30.958346 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:05:30.961858 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m14:05:30.972994 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:05:30.973744 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:05:30.975044 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m14:05:30.978941 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:05:30.993935 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:05:30.995384 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m14:05:31.014288 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.415 seconds
[0m14:05:31.017822 [info ] [Thread-4 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.47s]
[0m14:05:31.019800 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:05:31.021255 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:05:31.022725 [info ] [Thread-4 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m14:05:31.024304 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m14:05:31.025611 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:05:31.031789 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:05:31.045417 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:05:31.049425 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:05:31.064553 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:05:31.065876 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m14:05:31.406752 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.443 seconds
[0m14:05:31.411794 [info ] [Thread-3 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.53s]
[0m14:05:31.414196 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:05:31.416019 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:05:31.418161 [info ] [Thread-3 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m14:05:31.420243 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m14:05:31.422011 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:05:31.430005 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:05:31.444297 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:05:31.450116 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:05:31.464033 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:05:31.465370 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m14:05:31.538177 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m14:05:31.541496 [info ] [Thread-2 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.60s]
[0m14:05:31.543270 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:05:31.544795 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:05:31.546146 [info ] [Thread-2 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m14:05:31.547651 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m14:05:31.549282 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:05:31.557063 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:05:31.571868 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:05:31.575599 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:05:31.588510 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:05:31.589894 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m14:05:31.670048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m14:05:31.673936 [info ] [Thread-1 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.77s]
[0m14:05:31.675974 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:05:31.677682 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:05:31.679120 [info ] [Thread-1 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m14:05:31.680647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m14:05:31.682050 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:05:31.687258 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:05:31.697162 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:05:31.701051 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:05:31.713570 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:05:31.714716 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m14:05:31.934586 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.468 seconds
[0m14:05:31.938657 [info ] [Thread-3 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.52s]
[0m14:05:31.940806 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:05:31.942335 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:05:31.943653 [info ] [Thread-3 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m14:05:31.945096 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m14:05:31.946410 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:05:31.951436 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:05:31.961978 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:05:31.965870 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:05:31.978965 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:05:31.980225 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m14:05:32.004045 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.937 seconds
[0m14:05:32.007919 [info ] [Thread-4 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.98s]
[0m14:05:32.009813 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:05:32.011295 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:05:32.012817 [info ] [Thread-4 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m14:05:32.014422 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m14:05:32.016007 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:05:32.022085 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:05:32.034315 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:05:32.038743 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:05:32.040062 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.449 seconds
[0m14:05:32.044231 [info ] [Thread-2 (]: 18 of 24 PASS unique_core_batches_batch_id ..................................... [[32mPASS[0m in 0.50s]
[0m14:05:32.046159 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:05:32.047620 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:05:32.049159 [info ] [Thread-2 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m14:05:32.050829 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m14:05:32.052483 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:05:32.054219 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:05:32.060902 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:05:32.062253 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m14:05:32.078606 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:05:32.084803 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:05:32.086262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.370 seconds
[0m14:05:32.091715 [info ] [Thread-1 (]: 19 of 24 PASS unique_core_materials_material_id ................................ [[32mPASS[0m in 0.41s]
[0m14:05:32.093864 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:05:32.095602 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:05:32.097418 [info ] [Thread-1 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m14:05:32.099308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m14:05:32.101406 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:05:32.103485 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:05:32.109554 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:05:32.111212 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m14:05:32.129395 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:05:32.134735 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:05:32.149467 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:05:32.151082 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m14:05:32.511843 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.446 seconds
[0m14:05:32.515894 [info ] [Thread-4 (]: 21 of 24 PASS unique_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 0.50s]
[0m14:05:32.518152 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:05:32.520024 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:05:32.521821 [info ] [Thread-4 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m14:05:32.523817 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m14:05:32.527332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.374 seconds
[0m14:05:32.528242 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:05:32.532832 [info ] [Thread-1 (]: 23 of 24 PASS unique_stg_materials_material_id ................................. [[32mPASS[0m in 0.43s]
[0m14:05:32.538576 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:05:32.540469 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:05:32.548462 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m14:05:32.553515 [info ] [Thread-3 (]: 20 of 24 PASS unique_fct_production_orders_order_id ............................ [[32mPASS[0m in 0.61s]
[0m14:05:32.555903 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:05:32.556965 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:05:32.559487 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m14:05:32.564073 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:05:32.567642 [info ] [Thread-2 (]: 22 of 24 PASS unique_stg_batches_batch_id ...................................... [[32mPASS[0m in 0.52s]
[0m14:05:32.570580 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:05:32.579780 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:05:32.581062 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m14:05:33.005133 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.423 seconds
[0m14:05:33.008490 [info ] [Thread-4 (]: 24 of 24 PASS unique_stg_production_orders_order_id ............................ [[32mPASS[0m in 0.48s]
[0m14:05:33.010212 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:05:33.013532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:33.015136 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m14:05:33.016679 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m14:05:33.434568 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m14:05:33.436424 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m14:05:33.854347 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442' was left open.
[0m14:05:33.856077 [debug] [MainThread]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: Close
[0m14:05:34.291257 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m14:05:34.292866 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m14:05:34.717581 [info ] [MainThread]: 
[0m14:05:34.719635 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 7.81 seconds (7.81s).
[0m14:05:34.727138 [debug] [MainThread]: Command end result
[0m14:05:34.794613 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:05:34.801926 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:05:34.817763 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:05:34.819172 [info ] [MainThread]: 
[0m14:05:34.820873 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:34.822277 [info ] [MainThread]: 
[0m14:05:34.823649 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m14:05:34.825733 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.705065, "process_in_blocks": "0", "process_kernel_time": 1.447355, "process_mem_max_rss": "224444", "process_out_blocks": "16", "process_user_time": 5.797507}
[0m14:05:34.827192 [debug] [MainThread]: Command `dbt test` succeeded at 14:05:34.827038 after 10.71 seconds
[0m14:05:34.828795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92114e42f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9214022630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e92117e1850>]}
[0m14:05:34.830365 [debug] [MainThread]: Flushing usage events
[0m14:05:35.479803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:36.883296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4043d013a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4045a81310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4044edecf0>]}


============================== 14:25:36.892889 | 4928dff0-731e-4f89-9a94-bec6af123903 ==============================
[0m14:25:36.892889 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:25:36.894774 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'quiet': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'version_check': 'True', 'use_colors': 'True', 'debug': 'False', 'target_path': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles'}
[0m14:25:37.652878 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:25:37.654373 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:25:37.655625 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:25:37.875647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4022263aa0>]}
[0m14:25:37.950972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a404314a810>]}
[0m14:25:37.952797 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:25:38.126262 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:25:38.525066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:38.526427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:38.583235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4021dfb230>]}
[0m14:25:38.717499 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:25:38.726536 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:25:38.769144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4021b8af90>]}
[0m14:25:38.770579 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:25:38.771863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4021dac380>]}
[0m14:25:38.776451 [info ] [MainThread]: 
[0m14:25:38.778112 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:38.779535 [info ] [MainThread]: 
[0m14:25:38.781112 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:25:38.786984 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m14:25:38.846099 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m14:25:38.847632 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m14:25:38.849044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:40.594338 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.745 seconds
[0m14:25:40.598964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m14:25:40.615407 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:25:40.616901 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:25:40.885059 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.267 seconds
[0m14:25:40.890681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4042fbcfb0>]}
[0m14:25:40.899242 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m14:25:40.899918 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m14:25:40.900525 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m14:25:40.901972 [info ] [Thread-1 (]: 1 of 8 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m14:25:40.903678 [info ] [Thread-2 (]: 2 of 8 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m14:25:40.905540 [info ] [Thread-3 (]: 3 of 8 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m14:25:40.908171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m14:25:40.910798 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m14:25:40.912413 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m14:25:40.913812 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m14:25:40.915242 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m14:25:40.916703 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m14:25:40.993814 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m14:25:40.998140 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m14:25:41.002178 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m14:25:41.012928 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m14:25:41.013861 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m14:25:41.022215 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m14:25:41.110885 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m14:25:41.129201 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m14:25:41.131779 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m14:25:41.143112 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m14:25:41.145414 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m14:25:41.146993 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m14:25:41.148734 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m14:25:41.150337 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m14:25:41.151560 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:25:41.153000 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:25:41.154469 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m14:25:41.637662 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.472 seconds
[0m14:25:41.671031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4045b51880>]}
[0m14:25:41.675208 [info ] [Thread-1 (]: 1 of 8 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 0.76s]
[0m14:25:41.696773 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m14:25:42.465283 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.314 seconds
[0m14:25:42.469458 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4020c3df40>]}
[0m14:25:42.471136 [info ] [Thread-2 (]: 2 of 8 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 1.56s]
[0m14:25:42.472790 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m14:25:42.475184 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.core_materials
[0m14:25:42.477336 [info ] [Thread-4 (]: 4 of 8 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m14:25:42.479027 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_materials'
[0m14:25:42.480394 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.core_materials
[0m14:25:42.484423 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m14:25:42.497440 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.core_materials
[0m14:25:42.528782 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m14:25:42.541847 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m14:25:42.543755 [debug] [Thread-4 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m14:25:42.545456 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:25:42.676405 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.523 seconds
[0m14:25:42.680883 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4021f15ca0>]}
[0m14:25:42.682596 [info ] [Thread-3 (]: 3 of 8 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 1.77s]
[0m14:25:42.684411 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m14:25:44.632797 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.087 seconds
[0m14:25:44.637609 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4020c3f0e0>]}
[0m14:25:44.639819 [info ] [Thread-4 (]: 4 of 8 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 2.16s]
[0m14:25:44.642656 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.core_materials
[0m14:25:44.645591 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.core_batches
[0m14:25:44.646592 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m14:25:44.648197 [info ] [Thread-2 (]: 5 of 8 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m14:25:44.650199 [info ] [Thread-1 (]: 6 of 8 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m14:25:44.652183 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_materials, now model.mfg_accelerator.core_batches)
[0m14:25:44.653869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_batches, now model.mfg_accelerator.fct_production_orders)
[0m14:25:44.655595 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.core_batches
[0m14:25:44.657485 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m14:25:44.663832 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m14:25:44.669558 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m14:25:44.680107 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.core_batches
[0m14:25:44.681609 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m14:25:44.686245 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m14:25:44.692794 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m14:25:44.704892 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m14:25:44.708196 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m14:25:44.710369 [debug] [Thread-1 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m14:25:44.712532 [debug] [Thread-2 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m14:25:45.996544 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.282 seconds
[0m14:25:46.001156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a40219a3950>]}
[0m14:25:46.003091 [info ] [Thread-1 (]: 6 of 8 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 1.35s]
[0m14:25:46.005602 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m14:25:46.382217 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.666 seconds
[0m14:25:46.385977 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4020c3fb60>]}
[0m14:25:46.387703 [info ] [Thread-2 (]: 5 of 8 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 1.73s]
[0m14:25:46.389448 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.core_batches
[0m14:25:46.392148 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:25:46.393074 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:25:46.394677 [info ] [Thread-4 (]: 7 of 8 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m14:25:46.396267 [info ] [Thread-3 (]: 8 of 8 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m14:25:46.397868 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.core_materials, now model.mfg_accelerator.mfg_ml_features_orders)
[0m14:25:46.399221 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_production_orders, now model.mfg_accelerator.mfg_plant_daily_kpis)
[0m14:25:46.400437 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m14:25:46.401612 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:25:46.406295 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:25:46.414486 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:25:46.422339 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m14:25:46.424852 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:25:46.429396 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:25:46.433607 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:25:46.446149 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:25:46.447812 [debug] [Thread-4 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m14:25:46.452196 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:25:46.455843 [debug] [Thread-3 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m14:25:47.653754 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.200 seconds
[0m14:25:47.658835 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a40219a3f20>]}
[0m14:25:47.661121 [info ] [Thread-4 (]: 7 of 8 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 1.26s]
[0m14:25:47.662915 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:25:47.715578 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.257 seconds
[0m14:25:47.719481 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928dff0-731e-4f89-9a94-bec6af123903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a40220ae930>]}
[0m14:25:47.721318 [info ] [Thread-3 (]: 8 of 8 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 1.32s]
[0m14:25:47.723207 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:25:47.727665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:47.729362 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m14:25:47.730732 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m14:25:48.153986 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m14:25:48.155798 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m14:25:48.565778 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m14:25:48.567660 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m14:25:49.011371 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m14:25:49.012842 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m14:25:49.460587 [info ] [MainThread]: 
[0m14:25:49.462408 [info ] [MainThread]: Finished running 5 table models, 3 view models in 0 hours 0 minutes and 10.68 seconds (10.68s).
[0m14:25:49.465597 [debug] [MainThread]: Command end result
[0m14:25:49.531197 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:25:49.538241 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:25:49.553776 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:25:49.555055 [info ] [MainThread]: 
[0m14:25:49.556443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:25:49.558705 [info ] [MainThread]: 
[0m14:25:49.560765 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m14:25:49.563106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.771294, "process_in_blocks": "0", "process_kernel_time": 1.375372, "process_mem_max_rss": "222432", "process_out_blocks": "2288", "process_user_time": 4.815796}
[0m14:25:49.564493 [debug] [MainThread]: Command `dbt run` succeeded at 14:25:49.564361 after 12.77 seconds
[0m14:25:49.565754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4043198920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4028acf620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4021b5dee0>]}
[0m14:25:49.566961 [debug] [MainThread]: Flushing usage events
[0m14:25:50.356594 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:54.331382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515d785c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515d952b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515d6a3cbf0>]}


============================== 14:25:54.339937 | 4509f6c0-1cb7-4908-8813-ca9a5a150518 ==============================
[0m14:25:54.339937 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:25:54.341980 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'introspect': 'True', 'static_parser': 'True', 'version_check': 'True', 'write_json': 'True', 'no_print': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'log_format': 'default', 'empty': 'None', 'use_colors': 'True', 'quiet': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'cache_selected_only': 'False'}
[0m14:25:55.119554 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:25:55.121285 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:25:55.122729 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:25:55.352005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4509f6c0-1cb7-4908-8813-ca9a5a150518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515d778a000>]}
[0m14:25:55.430461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4509f6c0-1cb7-4908-8813-ca9a5a150518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515d6d41d00>]}
[0m14:25:55.432392 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:25:55.607070 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:25:55.905378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:55.907018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:55.971816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4509f6c0-1cb7-4908-8813-ca9a5a150518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515b54fd4c0>]}
[0m14:25:56.107228 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:25:56.115952 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:25:56.161879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4509f6c0-1cb7-4908-8813-ca9a5a150518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515b5168620>]}
[0m14:25:56.163445 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:25:56.164697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4509f6c0-1cb7-4908-8813-ca9a5a150518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515b56c1880>]}
[0m14:25:56.168708 [info ] [MainThread]: 
[0m14:25:56.170034 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:56.171432 [info ] [MainThread]: 
[0m14:25:56.173085 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:25:56.181121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m14:25:56.245758 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:25:56.247286 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:25:56.248626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:57.799909 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.551 seconds
[0m14:25:57.805165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4509f6c0-1cb7-4908-8813-ca9a5a150518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515b54ff020>]}
[0m14:25:57.814098 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:25:57.814748 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:25:57.815306 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:25:57.815934 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:25:57.816997 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m14:25:57.818711 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m14:25:57.820357 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m14:25:57.821991 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m14:25:57.823707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m14:25:57.826045 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m14:25:57.828640 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m14:25:57.830228 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m14:25:57.831640 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:25:57.833130 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:25:57.834413 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:25:57.835834 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:25:57.856156 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:25:57.862971 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:25:57.868067 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:25:57.873068 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:25:57.883833 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:25:57.885538 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:25:57.892202 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:25:57.901396 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:25:57.922598 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:25:57.924827 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:25:57.929899 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:25:57.933902 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:25:57.946927 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:25:57.948377 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:25:57.949467 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:25:57.950960 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m14:25:57.952814 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m14:25:57.953865 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:25:57.955441 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m14:25:57.957275 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:25:57.959224 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:25:57.961302 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m14:25:57.979904 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:25:58.256645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.296 seconds
[0m14:25:58.268356 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.44s]
[0m14:25:58.270365 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:25:58.271944 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:25:58.273918 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m14:25:58.276557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m14:25:58.278354 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:25:58.283492 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:25:58.298439 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:25:58.302505 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:25:58.315709 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:25:58.317102 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m14:25:58.605248 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m14:25:58.610143 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.33s]
[0m14:25:58.612146 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:25:58.613750 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:25:58.615082 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m14:25:58.616454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m14:25:58.617732 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:25:58.624148 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:25:58.637894 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:25:58.643391 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:25:58.655677 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:25:58.657531 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m14:25:59.046002 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.387 seconds
[0m14:25:59.050126 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.43s]
[0m14:25:59.051952 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:25:59.053399 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:25:59.054716 [info ] [Thread-1 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m14:25:59.056741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m14:25:59.058984 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:25:59.068137 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:25:59.083487 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:25:59.091525 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:25:59.103973 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:25:59.105358 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m14:25:59.359865 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.382 seconds
[0m14:25:59.364149 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.54s]
[0m14:25:59.365896 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:25:59.367346 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:25:59.368739 [info ] [Thread-2 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m14:25:59.370261 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m14:25:59.371595 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:25:59.378298 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:25:59.392290 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:25:59.396535 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:25:59.411542 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:25:59.413034 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m14:25:59.460454 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.353 seconds
[0m14:25:59.464156 [info ] [Thread-1 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 0.41s]
[0m14:25:59.465986 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:25:59.467867 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:25:59.469615 [info ] [Thread-1 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m14:25:59.471271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m14:25:59.472831 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:25:59.474871 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.519 seconds
[0m14:25:59.481240 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:25:59.484484 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.66s]
[0m14:25:59.487560 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:25:59.489297 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:25:59.491721 [info ] [Thread-3 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m14:25:59.494410 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m14:25:59.495914 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:25:59.501885 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:25:59.503810 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:25:59.509580 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:25:59.512645 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.555 seconds
[0m14:25:59.513904 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:25:59.518568 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.69s]
[0m14:25:59.524562 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:25:59.527587 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:25:59.529853 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:25:59.531397 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:25:59.532872 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m14:25:59.534198 [info ] [Thread-4 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m14:25:59.538316 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m14:25:59.541065 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:25:59.543449 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:25:59.549148 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:25:59.550788 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m14:25:59.567230 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:25:59.571274 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:25:59.583105 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:25:59.584293 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m14:25:59.793323 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.379 seconds
[0m14:25:59.797000 [info ] [Thread-2 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 0.43s]
[0m14:25:59.799068 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:25:59.800620 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:25:59.802194 [info ] [Thread-2 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m14:25:59.803869 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m14:25:59.805406 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:25:59.812345 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:25:59.827575 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:25:59.832977 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:25:59.848481 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:25:59.850207 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m14:25:59.866747 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.331 seconds
[0m14:25:59.871476 [info ] [Thread-1 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.40s]
[0m14:25:59.874800 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.321 seconds
[0m14:25:59.876650 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:25:59.880819 [info ] [Thread-3 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.39s]
[0m14:25:59.883009 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:25:59.885208 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:25:59.887029 [info ] [Thread-1 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m14:25:59.889091 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:25:59.891565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m14:25:59.893959 [info ] [Thread-3 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m14:25:59.896005 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:25:59.897880 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m14:25:59.905028 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:25:59.906964 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:25:59.923645 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:25:59.930365 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:25:59.935602 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:25:59.940416 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:25:59.948198 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:25:59.959014 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:25:59.961467 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m14:25:59.965035 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:25:59.967667 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m14:26:00.029106 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.443 seconds
[0m14:26:00.032589 [info ] [Thread-4 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.49s]
[0m14:26:00.034485 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:26:00.035999 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:26:00.037386 [info ] [Thread-4 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m14:26:00.038812 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m14:26:00.040429 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:26:00.048416 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:26:00.063184 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:26:00.067011 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:26:00.080717 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:26:00.082110 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m14:26:00.204360 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.353 seconds
[0m14:26:00.210135 [info ] [Thread-2 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.41s]
[0m14:26:00.212715 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:26:00.214878 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:26:00.216786 [info ] [Thread-2 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m14:26:00.218853 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m14:26:00.220752 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:26:00.232760 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:26:00.236473 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.273 seconds
[0m14:26:00.242312 [info ] [Thread-1 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.35s]
[0m14:26:00.245469 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:26:00.247987 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:26:00.249933 [info ] [Thread-1 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m14:26:00.252493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m14:26:00.254476 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:26:00.255307 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:26:00.261759 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:26:00.271678 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:26:00.288647 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:26:00.290138 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:26:00.292761 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m14:26:00.297876 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:26:00.316416 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:26:00.317877 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m14:26:00.394391 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.311 seconds
[0m14:26:00.398048 [info ] [Thread-4 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.36s]
[0m14:26:00.399960 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:26:00.401428 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:26:00.402831 [info ] [Thread-4 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m14:26:00.404340 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m14:26:00.405837 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:26:00.415286 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:26:00.429823 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:26:00.433807 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:26:00.447622 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:26:00.448835 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m14:26:00.578010 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.608 seconds
[0m14:26:00.581529 [info ] [Thread-3 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.68s]
[0m14:26:00.583264 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:26:00.584769 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:26:00.586163 [info ] [Thread-3 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m14:26:00.587619 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m14:26:00.589138 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:26:00.596638 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:26:00.612308 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:26:00.616435 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:26:00.628308 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:26:00.629597 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m14:26:00.677738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.359 seconds
[0m14:26:00.681395 [info ] [Thread-1 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.43s]
[0m14:26:00.683225 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:26:00.684744 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:26:00.686321 [info ] [Thread-1 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m14:26:00.687942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m14:26:00.689477 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:26:00.698711 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:26:00.715166 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:26:00.720204 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:26:00.736257 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:26:00.737890 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m14:26:00.749756 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.450 seconds
[0m14:26:00.753973 [info ] [Thread-2 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.54s]
[0m14:26:00.756279 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:26:00.758568 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:26:00.760839 [info ] [Thread-2 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m14:26:00.762751 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m14:26:00.764582 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:26:00.772058 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:26:00.789069 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:26:00.796165 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:26:00.814923 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:26:00.816680 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m14:26:00.822564 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.372 seconds
[0m14:26:00.830916 [info ] [Thread-4 (]: 18 of 24 PASS unique_core_batches_batch_id ..................................... [[32mPASS[0m in 0.43s]
[0m14:26:00.833593 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:26:00.835692 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:26:00.837566 [info ] [Thread-4 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m14:26:00.840595 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m14:26:00.843638 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:26:00.851840 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:26:00.869965 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:26:00.876833 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:26:00.891493 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:26:00.893438 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m14:26:00.956323 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.325 seconds
[0m14:26:00.960919 [info ] [Thread-3 (]: 19 of 24 PASS unique_core_materials_material_id ................................ [[32mPASS[0m in 0.37s]
[0m14:26:00.962926 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:26:00.964548 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:26:00.966113 [info ] [Thread-3 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m14:26:00.967785 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m14:26:00.969235 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:26:00.975285 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:26:00.985966 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:26:00.990515 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:26:01.003836 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:26:01.005270 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m14:26:01.081907 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.343 seconds
[0m14:26:01.085339 [info ] [Thread-1 (]: 20 of 24 PASS unique_fct_production_orders_order_id ............................ [[32mPASS[0m in 0.40s]
[0m14:26:01.087220 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:26:01.088808 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:26:01.090503 [info ] [Thread-1 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m14:26:01.092659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m14:26:01.094276 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:26:01.099625 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:26:01.113002 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:26:01.116925 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:26:01.130438 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:26:01.131715 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m14:26:01.188673 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.294 seconds
[0m14:26:01.193160 [info ] [Thread-4 (]: 22 of 24 PASS unique_stg_batches_batch_id ...................................... [[32mPASS[0m in 0.35s]
[0m14:26:01.195413 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:26:01.216906 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m14:26:01.220316 [info ] [Thread-2 (]: 21 of 24 PASS unique_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 0.46s]
[0m14:26:01.222008 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:26:01.327012 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.320 seconds
[0m14:26:01.330423 [info ] [Thread-3 (]: 23 of 24 PASS unique_stg_materials_material_id ................................. [[32mPASS[0m in 0.36s]
[0m14:26:01.332259 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:26:01.560696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.428 seconds
[0m14:26:01.566518 [info ] [Thread-1 (]: 24 of 24 PASS unique_stg_production_orders_order_id ............................ [[32mPASS[0m in 0.47s]
[0m14:26:01.569476 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:26:01.575402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:01.577767 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m14:26:01.580198 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m14:26:02.011950 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m14:26:02.013532 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m14:26:02.425735 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m14:26:02.427829 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m14:26:02.860821 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m14:26:02.862605 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m14:26:03.262698 [info ] [MainThread]: 
[0m14:26:03.264527 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 7.09 seconds (7.09s).
[0m14:26:03.270231 [debug] [MainThread]: Command end result
[0m14:26:03.338685 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:26:03.347216 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:26:03.363859 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:26:03.365627 [info ] [MainThread]: 
[0m14:26:03.367314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:26:03.369052 [info ] [MainThread]: 
[0m14:26:03.370665 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m14:26:03.373565 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.133798, "process_in_blocks": "0", "process_kernel_time": 1.357753, "process_mem_max_rss": "224404", "process_out_blocks": "16", "process_user_time": 5.13151}
[0m14:26:03.379150 [debug] [MainThread]: Command `dbt test` succeeded at 14:26:03.378876 after 9.14 seconds
[0m14:26:03.381018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515d7c6c080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515d7c6c9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515d6872ae0>]}
[0m14:26:03.382682 [debug] [MainThread]: Flushing usage events
[0m14:26:04.138871 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:08:37.043799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef34b23a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef33393650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef32a60bf0>]}


============================== 23:08:37.055706 | 0c931fa4-a7ce-44f3-a41f-c8e55a060c6f ==============================
[0m23:08:37.055706 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:08:37.057838 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'static_parser': 'True', 'printer_width': '80', 'empty': 'False', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'fail_fast': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True', 'introspect': 'True'}
[0m23:08:37.926133 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:08:37.929600 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:08:37.931890 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:08:38.215542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c931fa4-a7ce-44f3-a41f-c8e55a060c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef14ff72c0>]}
[0m23:08:38.291482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c931fa4-a7ce-44f3-a41f-c8e55a060c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef151d8860>]}
[0m23:08:38.293331 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m23:08:38.454139 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:08:38.727637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:08:38.729199 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:08:38.782469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c931fa4-a7ce-44f3-a41f-c8e55a060c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef14b1d850>]}
[0m23:08:38.914178 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:08:38.920897 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:08:38.955531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c931fa4-a7ce-44f3-a41f-c8e55a060c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef14b38c80>]}
[0m23:08:38.956964 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m23:08:38.958198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c931fa4-a7ce-44f3-a41f-c8e55a060c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef1491e6c0>]}
[0m23:08:38.961502 [info ] [MainThread]: 
[0m23:08:38.962863 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:08:38.964210 [info ] [MainThread]: 
[0m23:08:38.966020 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:08:38.972698 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m23:08:39.034280 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m23:08:39.036147 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m23:08:39.037429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:41.349551 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.312 seconds
[0m23:08:41.355950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m23:08:41.375573 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m23:08:41.377206 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m23:08:41.983557 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.605 seconds
[0m23:08:41.989512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c931fa4-a7ce-44f3-a41f-c8e55a060c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef14c67560>]}
[0m23:08:41.996399 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m23:08:41.997020 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m23:08:41.997670 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m23:08:41.999124 [info ] [Thread-1 (]: 1 of 8 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m23:08:42.001183 [info ] [Thread-2 (]: 2 of 8 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m23:08:42.003376 [info ] [Thread-3 (]: 3 of 8 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m23:08:42.005091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m23:08:42.006538 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m23:08:42.008072 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m23:08:42.009353 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m23:08:42.010509 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m23:08:42.012023 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m23:08:42.022627 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m23:08:42.093657 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m23:08:42.097344 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m23:08:42.106340 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m23:08:42.107225 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m23:08:42.114174 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m23:08:42.154291 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m23:08:42.153219 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m23:08:42.157717 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m23:08:42.168011 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m23:08:42.170053 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m23:08:42.171582 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m23:08:42.173324 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m23:08:42.175061 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m23:08:42.176323 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:08:42.179734 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m23:08:42.188430 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:08:42.614070 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.436 seconds
[0m23:08:42.649035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c931fa4-a7ce-44f3-a41f-c8e55a060c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef34816a50>]}
[0m23:08:42.651266 [info ] [Thread-1 (]: 1 of 8 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 0.64s]
[0m23:08:42.653263 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m23:08:43.953605 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.765 seconds
[0m23:08:43.958083 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c931fa4-a7ce-44f3-a41f-c8e55a060c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef320795e0>]}
[0m23:08:43.959721 [info ] [Thread-3 (]: 3 of 8 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 1.95s]
[0m23:08:43.961346 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m23:08:45.848757 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.672 seconds
[0m23:08:45.853034 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c931fa4-a7ce-44f3-a41f-c8e55a060c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef14c93170>]}
[0m23:08:45.854623 [info ] [Thread-2 (]: 2 of 8 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 3.85s]
[0m23:08:45.856101 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m23:08:45.857961 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.core_materials
[0m23:08:45.860144 [info ] [Thread-4 (]: 4 of 8 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m23:08:45.861791 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_materials'
[0m23:08:45.863092 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.core_materials
[0m23:08:45.867496 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m23:08:45.875842 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.core_materials
[0m23:08:45.905970 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m23:08:45.915091 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m23:08:45.916554 [debug] [Thread-4 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m23:08:45.918366 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:08:48.648353 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.730 seconds
[0m23:08:48.652804 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c931fa4-a7ce-44f3-a41f-c8e55a060c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef1415bfe0>]}
[0m23:08:48.654720 [info ] [Thread-4 (]: 4 of 8 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 2.79s]
[0m23:08:48.656456 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.core_materials
[0m23:08:48.658716 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.core_batches
[0m23:08:48.659266 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m23:08:48.660587 [info ] [Thread-3 (]: 5 of 8 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m23:08:48.661953 [info ] [Thread-2 (]: 6 of 8 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m23:08:48.663712 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_production_orders, now model.mfg_accelerator.core_batches)
[0m23:08:48.665367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_materials, now model.mfg_accelerator.fct_production_orders)
[0m23:08:48.666963 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.core_batches
[0m23:08:48.668548 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m23:08:48.673042 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m23:08:48.677195 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m23:08:48.686367 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m23:08:48.687850 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.core_batches
[0m23:08:48.691533 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m23:08:48.695494 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m23:08:48.706341 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m23:08:48.707992 [debug] [Thread-2 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m23:08:48.710724 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m23:08:48.714725 [debug] [Thread-3 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m23:08:50.100960 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.384 seconds
[0m23:08:50.105159 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c931fa4-a7ce-44f3-a41f-c8e55a060c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef14171520>]}
[0m23:08:50.106852 [info ] [Thread-3 (]: 5 of 8 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 1.44s]
[0m23:08:50.108671 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.core_batches
[0m23:08:50.169792 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.458 seconds
[0m23:08:50.173930 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c931fa4-a7ce-44f3-a41f-c8e55a060c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef14195520>]}
[0m23:08:50.175669 [info ] [Thread-2 (]: 6 of 8 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 1.51s]
[0m23:08:50.177510 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m23:08:50.179798 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m23:08:50.180550 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m23:08:50.182255 [info ] [Thread-4 (]: 7 of 8 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m23:08:50.184354 [info ] [Thread-1 (]: 8 of 8 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m23:08:50.186569 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.core_materials, now model.mfg_accelerator.mfg_ml_features_orders)
[0m23:08:50.188226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_batches, now model.mfg_accelerator.mfg_plant_daily_kpis)
[0m23:08:50.189639 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m23:08:50.191016 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m23:08:50.195622 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m23:08:50.201586 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m23:08:50.209939 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m23:08:50.210963 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m23:08:50.215517 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m23:08:50.222372 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m23:08:50.235346 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m23:08:50.237836 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m23:08:50.241427 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m23:08:50.245045 [debug] [Thread-4 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m23:08:51.363005 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.120 seconds
[0m23:08:51.364007 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.117 seconds
[0m23:08:51.368044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c931fa4-a7ce-44f3-a41f-c8e55a060c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef0c72d9d0>]}
[0m23:08:51.372206 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c931fa4-a7ce-44f3-a41f-c8e55a060c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef147667e0>]}
[0m23:08:51.373941 [info ] [Thread-1 (]: 8 of 8 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 1.18s]
[0m23:08:51.375715 [info ] [Thread-4 (]: 7 of 8 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 1.19s]
[0m23:08:51.377447 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m23:08:51.378972 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m23:08:51.383253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:51.384865 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m23:08:51.386272 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m23:08:51.924896 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m23:08:51.926539 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m23:08:52.415461 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m23:08:52.417313 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m23:08:52.926919 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m23:08:52.928619 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m23:08:53.398972 [info ] [MainThread]: 
[0m23:08:53.400807 [info ] [MainThread]: Finished running 5 table models, 3 view models in 0 hours 0 minutes and 14.43 seconds (14.43s).
[0m23:08:53.404535 [debug] [MainThread]: Command end result
[0m23:08:53.473480 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:08:53.479385 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:08:53.493551 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m23:08:53.494777 [info ] [MainThread]: 
[0m23:08:53.496023 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:08:53.497314 [info ] [MainThread]: 
[0m23:08:53.498597 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m23:08:53.500743 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.56389, "process_in_blocks": "0", "process_kernel_time": 1.484382, "process_mem_max_rss": "221660", "process_out_blocks": "1272", "process_user_time": 5.233349}
[0m23:08:53.502510 [debug] [MainThread]: Command `dbt run` succeeded at 23:08:53.502281 after 16.57 seconds
[0m23:08:53.504328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef14dd0fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef14dd1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ef3327c290>]}
[0m23:08:53.505649 [debug] [MainThread]: Flushing usage events
[0m23:08:54.285580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:08:58.823583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7937d819a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7937d971d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7937d6c5b9e0>]}


============================== 23:08:58.831564 | 30bebd40-4930-4dce-b730-1c439d312596 ==============================
[0m23:08:58.831564 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:08:58.833107 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'introspect': 'True', 'quiet': 'False', 'partial_parse': 'True', 'empty': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'static_parser': 'True', 'version_check': 'True', 'printer_width': '80', 'use_colors': 'True', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'target_path': 'None', 'warn_error': 'None', 'write_json': 'True', 'log_cache_events': 'False'}
[0m23:08:59.588636 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:08:59.590301 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:08:59.591621 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:08:59.812135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30bebd40-4930-4dce-b730-1c439d312596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7937d96deed0>]}
[0m23:08:59.885425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30bebd40-4930-4dce-b730-1c439d312596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7937b59d2b70>]}
[0m23:08:59.887733 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m23:09:00.053463 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:09:00.345386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:09:00.346975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:09:00.400713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30bebd40-4930-4dce-b730-1c439d312596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7937b587da90>]}
[0m23:09:00.532047 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:09:00.539087 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:09:00.581746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30bebd40-4930-4dce-b730-1c439d312596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7937b548ffe0>]}
[0m23:09:00.583184 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m23:09:00.584376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30bebd40-4930-4dce-b730-1c439d312596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7937b587c260>]}
[0m23:09:00.589285 [info ] [MainThread]: 
[0m23:09:00.590840 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:09:00.592276 [info ] [MainThread]: 
[0m23:09:00.593881 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:09:00.600088 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m23:09:00.655529 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m23:09:00.657107 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m23:09:00.658483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:02.353063 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.694 seconds
[0m23:09:02.358964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30bebd40-4930-4dce-b730-1c439d312596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7937b551e2a0>]}
[0m23:09:02.366023 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m23:09:02.366701 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m23:09:02.367289 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m23:09:02.368428 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m23:09:02.369890 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m23:09:02.371968 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m23:09:02.373719 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m23:09:02.375239 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m23:09:02.377002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m23:09:02.378570 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m23:09:02.380066 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m23:09:02.381493 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m23:09:02.382865 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m23:09:02.384407 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m23:09:02.385997 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m23:09:02.387566 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m23:09:02.407155 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m23:09:02.411510 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m23:09:02.417064 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m23:09:02.423273 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m23:09:02.432721 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m23:09:02.433647 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m23:09:02.434699 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m23:09:02.441569 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m23:09:02.473147 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m23:09:02.474470 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m23:09:02.478089 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m23:09:02.482709 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m23:09:02.492512 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m23:09:02.494758 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m23:09:02.495734 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m23:09:02.497003 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m23:09:02.498199 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m23:09:02.499334 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m23:09:02.500830 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:09:02.502472 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m23:09:02.504438 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m23:09:02.514226 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:09:02.515804 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:09:03.047988 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m23:09:03.059654 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.68s]
[0m23:09:03.061544 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m23:09:03.063030 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m23:09:03.064434 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m23:09:03.065895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m23:09:03.067277 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m23:09:03.073103 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m23:09:03.084260 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m23:09:03.101325 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m23:09:03.131044 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m23:09:03.132346 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m23:09:03.431858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m23:09:03.436274 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.37s]
[0m23:09:03.439477 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m23:09:03.441681 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m23:09:03.443362 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m23:09:03.445156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m23:09:03.446934 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m23:09:03.453939 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m23:09:03.468846 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m23:09:03.474551 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m23:09:03.494575 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m23:09:03.496565 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m23:09:03.892864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.395 seconds
[0m23:09:03.898131 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.45s]
[0m23:09:03.900700 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m23:09:03.902884 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m23:09:03.905303 [info ] [Thread-1 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m23:09:03.908014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m23:09:03.910747 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m23:09:03.918163 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m23:09:03.936295 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m23:09:03.941306 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m23:09:03.955878 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m23:09:03.957209 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m23:09:04.039864 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.526 seconds
[0m23:09:04.045899 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.67s]
[0m23:09:04.047955 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m23:09:04.049691 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m23:09:04.051279 [info ] [Thread-3 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m23:09:04.053170 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m23:09:04.054924 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m23:09:04.060626 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m23:09:04.074327 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m23:09:04.078246 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m23:09:04.081304 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.565 seconds
[0m23:09:04.085711 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.70s]
[0m23:09:04.088600 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m23:09:04.090270 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m23:09:04.091834 [info ] [Thread-4 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m23:09:04.093551 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m23:09:04.095503 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m23:09:04.096126 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m23:09:04.097527 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m23:09:04.104164 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m23:09:04.111118 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.610 seconds
[0m23:09:04.114865 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.74s]
[0m23:09:04.116952 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m23:09:04.118952 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m23:09:04.120868 [info ] [Thread-2 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m23:09:04.123017 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m23:09:04.124813 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m23:09:04.125472 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m23:09:04.130871 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m23:09:04.135182 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m23:09:04.147851 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m23:09:04.148640 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m23:09:04.150082 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m23:09:04.154950 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m23:09:04.171898 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m23:09:04.173264 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m23:09:04.366883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m23:09:04.370547 [info ] [Thread-1 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 0.46s]
[0m23:09:04.372511 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m23:09:04.373911 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m23:09:04.375297 [info ] [Thread-1 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m23:09:04.376612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m23:09:04.377769 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m23:09:04.382959 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m23:09:04.395687 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m23:09:04.400194 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m23:09:04.413972 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m23:09:04.415432 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m23:09:04.423134 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.317 seconds
[0m23:09:04.426580 [info ] [Thread-3 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 0.37s]
[0m23:09:04.428287 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m23:09:04.429703 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m23:09:04.431096 [info ] [Thread-3 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m23:09:04.432510 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m23:09:04.433859 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m23:09:04.439937 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m23:09:04.449774 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m23:09:04.456528 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m23:09:04.470487 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m23:09:04.471938 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m23:09:04.506545 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.332 seconds
[0m23:09:04.510087 [info ] [Thread-2 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.39s]
[0m23:09:04.511772 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m23:09:04.513356 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m23:09:04.514987 [info ] [Thread-2 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m23:09:04.517586 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.361 seconds
[0m23:09:04.519357 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m23:09:04.523046 [info ] [Thread-4 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.43s]
[0m23:09:04.524718 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m23:09:04.526386 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m23:09:04.532741 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m23:09:04.534538 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m23:09:04.538239 [info ] [Thread-4 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m23:09:04.540227 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m23:09:04.542073 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m23:09:04.558497 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m23:09:04.561231 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m23:09:04.566694 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m23:09:04.578439 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m23:09:04.584065 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m23:09:04.588227 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m23:09:04.590191 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m23:09:04.602234 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m23:09:04.604264 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m23:09:04.902775 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.429 seconds
[0m23:09:04.904682 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m23:09:04.907681 [info ] [Thread-3 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.48s]
[0m23:09:04.911166 [info ] [Thread-1 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.53s]
[0m23:09:04.913028 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m23:09:04.914918 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m23:09:04.916522 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m23:09:04.918176 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m23:09:04.920071 [info ] [Thread-3 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m23:09:04.922113 [info ] [Thread-1 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m23:09:04.923909 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m23:09:04.925743 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.334 seconds
[0m23:09:04.926800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m23:09:04.928305 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m23:09:04.931518 [info ] [Thread-2 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.41s]
[0m23:09:04.933031 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m23:09:04.942856 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m23:09:04.944368 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.338 seconds
[0m23:09:04.945596 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m23:09:04.952319 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m23:09:04.957339 [info ] [Thread-4 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.42s]
[0m23:09:04.959145 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m23:09:04.961963 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m23:09:04.963420 [info ] [Thread-2 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m23:09:04.965610 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m23:09:04.967665 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m23:09:04.968666 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m23:09:04.970526 [info ] [Thread-4 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m23:09:04.972202 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m23:09:04.972841 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m23:09:04.977024 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m23:09:04.978536 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m23:09:04.985362 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m23:09:04.991637 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m23:09:04.994371 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m23:09:05.008715 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m23:09:05.012788 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m23:09:05.014625 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m23:09:05.016551 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m23:09:05.018542 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m23:09:05.019759 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m23:09:05.023588 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m23:09:05.029393 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m23:09:05.033777 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m23:09:05.044538 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m23:09:05.046135 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m23:09:05.047403 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m23:09:05.049008 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m23:09:05.356210 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.306 seconds
[0m23:09:05.359918 [info ] [Thread-4 (]: 18 of 24 PASS unique_core_batches_batch_id ..................................... [[32mPASS[0m in 0.38s]
[0m23:09:05.361752 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m23:09:05.363069 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m23:09:05.364376 [info ] [Thread-4 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m23:09:05.365654 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m23:09:05.366923 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m23:09:05.372825 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m23:09:05.376009 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.354 seconds
[0m23:09:05.380257 [info ] [Thread-3 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.46s]
[0m23:09:05.382319 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m23:09:05.383917 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m23:09:05.385540 [info ] [Thread-3 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m23:09:05.387733 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m23:09:05.388997 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m23:09:05.390005 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m23:09:05.393854 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m23:09:05.398744 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m23:09:05.412579 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m23:09:05.413309 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m23:09:05.414371 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m23:09:05.419168 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m23:09:05.433490 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m23:09:05.434863 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m23:09:05.526454 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m23:09:05.529096 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m23:09:05.535644 [info ] [Thread-1 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.61s]
[0m23:09:05.541843 [info ] [Thread-2 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.57s]
[0m23:09:05.544582 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m23:09:05.547166 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m23:09:05.549369 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m23:09:05.552180 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m23:09:05.555280 [info ] [Thread-1 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m23:09:05.557891 [info ] [Thread-2 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m23:09:05.560524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m23:09:05.562635 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m23:09:05.565192 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m23:09:05.567512 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m23:09:05.579822 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m23:09:05.588829 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m23:09:05.604002 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m23:09:05.605302 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m23:09:05.613604 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m23:09:05.619855 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m23:09:05.634222 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m23:09:05.636915 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m23:09:05.639046 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m23:09:05.640961 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m23:09:05.740998 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.304 seconds
[0m23:09:05.742253 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.321 seconds
[0m23:09:05.745968 [info ] [Thread-3 (]: 20 of 24 PASS unique_fct_production_orders_order_id ............................ [[32mPASS[0m in 0.36s]
[0m23:09:05.749665 [info ] [Thread-4 (]: 19 of 24 PASS unique_core_materials_material_id ................................ [[32mPASS[0m in 0.38s]
[0m23:09:05.751619 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m23:09:05.754029 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m23:09:05.755864 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m23:09:05.757622 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m23:09:05.759235 [info ] [Thread-3 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m23:09:05.760825 [info ] [Thread-4 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m23:09:05.762544 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m23:09:05.764309 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m23:09:05.765820 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m23:09:05.767274 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m23:09:05.773942 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m23:09:05.780446 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m23:09:05.788517 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m23:09:05.793756 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m23:09:05.794486 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m23:09:05.800649 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m23:09:05.809785 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m23:09:05.811697 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m23:09:05.812859 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m23:09:05.814545 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m23:09:06.026625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.384 seconds
[0m23:09:06.030699 [info ] [Thread-1 (]: 21 of 24 PASS unique_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 0.47s]
[0m23:09:06.033188 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m23:09:06.034142 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m23:09:06.038386 [info ] [Thread-2 (]: 22 of 24 PASS unique_stg_batches_batch_id ...................................... [[32mPASS[0m in 0.48s]
[0m23:09:06.041748 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m23:09:06.136097 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m23:09:06.139934 [info ] [Thread-4 (]: 24 of 24 PASS unique_stg_production_orders_order_id ............................ [[32mPASS[0m in 0.38s]
[0m23:09:06.141647 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m23:09:06.355989 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.540 seconds
[0m23:09:06.359600 [info ] [Thread-3 (]: 23 of 24 PASS unique_stg_materials_material_id ................................. [[32mPASS[0m in 0.60s]
[0m23:09:06.361532 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m23:09:06.365415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:06.367029 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m23:09:06.368560 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m23:09:06.849747 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m23:09:06.852706 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m23:09:07.339692 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m23:09:07.341395 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m23:09:07.806020 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m23:09:07.807579 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m23:09:08.272380 [info ] [MainThread]: 
[0m23:09:08.274131 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 7.68 seconds (7.68s).
[0m23:09:08.280235 [debug] [MainThread]: Command end result
[0m23:09:08.347837 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:09:08.355752 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:09:08.371321 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m23:09:08.372837 [info ] [MainThread]: 
[0m23:09:08.374289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:09:08.375567 [info ] [MainThread]: 
[0m23:09:08.376931 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m23:09:08.379026 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.643848, "process_in_blocks": "0", "process_kernel_time": 1.26951, "process_mem_max_rss": "223616", "process_out_blocks": "16", "process_user_time": 5.117965}
[0m23:09:08.380506 [debug] [MainThread]: Command `dbt test` succeeded at 23:09:08.380321 after 9.65 seconds
[0m23:09:08.382027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7937d6c06ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7937b58b5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7937b58b5370>]}
[0m23:09:08.383382 [debug] [MainThread]: Flushing usage events
[0m23:09:09.009929 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:09:34.872753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7969a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac795c7cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac78fcec90>]}


============================== 23:09:34.880552 | dd5f2bc7-263b-4df9-bd9a-e5b75c48276a ==============================
[0m23:09:34.880552 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:09:34.882702 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'target_path': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'empty': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'fail_fast': 'False', 'version_check': 'True'}
[0m23:09:35.579844 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:09:35.581367 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:09:35.582554 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:09:35.782234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd5f2bc7-263b-4df9-bd9a-e5b75c48276a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7961a120>]}
[0m23:09:35.850978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd5f2bc7-263b-4df9-bd9a-e5b75c48276a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac56ece570>]}
[0m23:09:35.852858 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m23:09:36.016911 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:09:36.252959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:09:36.254606 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:09:36.306812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd5f2bc7-263b-4df9-bd9a-e5b75c48276a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac56daed80>]}
[0m23:09:36.423962 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:09:36.430018 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:09:36.460702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd5f2bc7-263b-4df9-bd9a-e5b75c48276a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac56b595b0>]}
[0m23:09:36.462124 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m23:09:36.463368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd5f2bc7-263b-4df9-bd9a-e5b75c48276a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac56dad580>]}
[0m23:09:36.466335 [info ] [MainThread]: 
[0m23:09:36.467571 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:09:36.468838 [info ] [MainThread]: 
[0m23:09:36.470264 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:09:36.476480 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m23:09:36.521606 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m23:09:36.523419 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m23:09:36.525085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:38.218209 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.698 seconds
[0m23:09:38.224940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m23:09:38.247664 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m23:09:38.249938 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m23:09:38.570057 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.318 seconds
[0m23:09:38.576563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd5f2bc7-263b-4df9-bd9a-e5b75c48276a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac56f9f050>]}
[0m23:09:38.585695 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m23:09:38.586747 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m23:09:38.587587 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m23:09:38.591510 [info ] [Thread-1 (]: 1 of 8 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m23:09:38.593527 [info ] [Thread-2 (]: 2 of 8 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m23:09:38.595769 [info ] [Thread-3 (]: 3 of 8 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m23:09:38.597747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m23:09:38.599787 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m23:09:38.601694 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m23:09:38.603497 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m23:09:38.605451 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m23:09:38.607425 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m23:09:38.621042 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m23:09:38.708918 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m23:09:38.714362 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m23:09:38.725240 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m23:09:38.726365 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m23:09:38.733696 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m23:09:38.816664 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m23:09:38.821358 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m23:09:38.826547 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m23:09:38.838502 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m23:09:38.840317 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m23:09:38.842237 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m23:09:38.843905 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m23:09:38.845838 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m23:09:38.847819 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m23:09:38.852081 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:09:38.853919 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:09:39.354780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m23:09:39.388747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd5f2bc7-263b-4df9-bd9a-e5b75c48276a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7aa9a600>]}
[0m23:09:39.390865 [info ] [Thread-1 (]: 1 of 8 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 0.79s]
[0m23:09:39.393040 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m23:09:40.466709 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.615 seconds
[0m23:09:40.468053 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.614 seconds
[0m23:09:40.472706 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd5f2bc7-263b-4df9-bd9a-e5b75c48276a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac77f7db50>]}
[0m23:09:40.477081 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd5f2bc7-263b-4df9-bd9a-e5b75c48276a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac55bddd60>]}
[0m23:09:40.479968 [info ] [Thread-2 (]: 2 of 8 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 1.87s]
[0m23:09:40.482856 [info ] [Thread-3 (]: 3 of 8 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 1.88s]
[0m23:09:40.485234 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m23:09:40.487218 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m23:09:40.490116 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.core_materials
[0m23:09:40.493425 [info ] [Thread-4 (]: 4 of 8 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m23:09:40.495541 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_materials'
[0m23:09:40.497233 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.core_materials
[0m23:09:40.503742 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m23:09:40.517342 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.core_materials
[0m23:09:40.551511 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m23:09:40.565320 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m23:09:40.566967 [debug] [Thread-4 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m23:09:40.568615 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:09:42.648619 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.080 seconds
[0m23:09:42.652725 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd5f2bc7-263b-4df9-bd9a-e5b75c48276a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac56e9fd70>]}
[0m23:09:42.654491 [info ] [Thread-4 (]: 4 of 8 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 2.16s]
[0m23:09:42.656294 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.core_materials
[0m23:09:42.658723 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.core_batches
[0m23:09:42.659285 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m23:09:42.660853 [info ] [Thread-2 (]: 5 of 8 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m23:09:42.662677 [info ] [Thread-1 (]: 6 of 8 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m23:09:42.664360 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_materials, now model.mfg_accelerator.core_batches)
[0m23:09:42.665946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_batches, now model.mfg_accelerator.fct_production_orders)
[0m23:09:42.667354 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.core_batches
[0m23:09:42.668675 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m23:09:42.673082 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m23:09:42.677639 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m23:09:42.685571 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m23:09:42.686907 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.core_batches
[0m23:09:42.691184 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m23:09:42.695266 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m23:09:42.706618 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m23:09:42.708617 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m23:09:42.709990 [debug] [Thread-1 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m23:09:42.711665 [debug] [Thread-2 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m23:09:45.170299 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.455 seconds
[0m23:09:45.174437 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd5f2bc7-263b-4df9-bd9a-e5b75c48276a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac55bde480>]}
[0m23:09:45.176130 [info ] [Thread-2 (]: 5 of 8 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 2.51s]
[0m23:09:45.177936 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.core_batches
[0m23:09:45.625727 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.912 seconds
[0m23:09:45.629782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd5f2bc7-263b-4df9-bd9a-e5b75c48276a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac55b7f9e0>]}
[0m23:09:45.631658 [info ] [Thread-1 (]: 6 of 8 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 2.96s]
[0m23:09:45.633466 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m23:09:45.635699 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m23:09:45.636293 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m23:09:45.637790 [info ] [Thread-4 (]: 7 of 8 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m23:09:45.639463 [info ] [Thread-3 (]: 8 of 8 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m23:09:45.641218 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.core_materials, now model.mfg_accelerator.mfg_ml_features_orders)
[0m23:09:45.642766 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_production_orders, now model.mfg_accelerator.mfg_plant_daily_kpis)
[0m23:09:45.644254 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m23:09:45.645591 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m23:09:45.650353 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m23:09:45.655443 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m23:09:45.663921 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m23:09:45.670533 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m23:09:45.671052 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m23:09:45.676404 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m23:09:45.686528 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m23:09:45.688357 [debug] [Thread-4 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m23:09:45.693225 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m23:09:45.696662 [debug] [Thread-3 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m23:09:46.976355 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.282 seconds
[0m23:09:46.980063 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd5f2bc7-263b-4df9-bd9a-e5b75c48276a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac55c21610>]}
[0m23:09:46.981900 [info ] [Thread-4 (]: 7 of 8 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 1.34s]
[0m23:09:46.983511 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m23:09:47.506444 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.808 seconds
[0m23:09:47.510500 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd5f2bc7-263b-4df9-bd9a-e5b75c48276a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac56ecdd30>]}
[0m23:09:47.512236 [info ] [Thread-3 (]: 8 of 8 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 1.87s]
[0m23:09:47.513976 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m23:09:47.517224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:47.518578 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m23:09:47.519796 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m23:09:47.994926 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m23:09:47.997399 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m23:09:48.513571 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m23:09:48.515199 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m23:09:48.989507 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m23:09:48.991196 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m23:09:49.543845 [info ] [MainThread]: 
[0m23:09:49.545582 [info ] [MainThread]: Finished running 5 table models, 3 view models in 0 hours 0 minutes and 13.07 seconds (13.07s).
[0m23:09:49.548689 [debug] [MainThread]: Command end result
[0m23:09:49.608945 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:09:49.615168 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:09:49.629184 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m23:09:49.630441 [info ] [MainThread]: 
[0m23:09:49.631810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:09:49.632977 [info ] [MainThread]: 
[0m23:09:49.634355 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m23:09:49.636279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.853871, "process_in_blocks": "0", "process_kernel_time": 1.305197, "process_mem_max_rss": "221268", "process_out_blocks": "16", "process_user_time": 4.318432}
[0m23:09:49.637845 [debug] [MainThread]: Command `dbt run` succeeded at 23:09:49.637715 after 14.86 seconds
[0m23:09:49.639149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac78e423c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac79ea6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7955d280>]}
[0m23:09:49.640557 [debug] [MainThread]: Flushing usage events
[0m23:09:50.408635 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:09:54.105797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7541cdcba750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7541ce7b30b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7541cffe2150>]}


============================== 23:09:54.114087 | a636116b-60e2-495b-8874-02698af24fd1 ==============================
[0m23:09:54.114087 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:09:54.115958 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'empty': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/dbt_profiles', 'introspect': 'True', 'printer_width': '80', 'static_parser': 'True', 'write_json': 'True', 'log_format': 'default', 'debug': 'False', 'use_colors': 'True', 'quiet': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'target_path': 'None', 'fail_fast': 'False'}
[0m23:09:54.792041 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:09:54.793720 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:09:54.795134 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:09:54.999122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a636116b-60e2-495b-8874-02698af24fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7541b0a223f0>]}
[0m23:09:55.069219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a636116b-60e2-495b-8874-02698af24fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7541b0b394c0>]}
[0m23:09:55.071220 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m23:09:55.223665 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:09:55.483287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:09:55.484830 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:09:55.534241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a636116b-60e2-495b-8874-02698af24fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7541b0b0ce90>]}
[0m23:09:55.658609 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:09:55.666197 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:09:55.709301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a636116b-60e2-495b-8874-02698af24fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7541b05cb7d0>]}
[0m23:09:55.710928 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m23:09:55.712298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a636116b-60e2-495b-8874-02698af24fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7541cdb25b80>]}
[0m23:09:55.716163 [info ] [MainThread]: 
[0m23:09:55.717465 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:09:55.718750 [info ] [MainThread]: 
[0m23:09:55.720308 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:09:55.726686 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m23:09:55.779319 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m23:09:55.780873 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m23:09:55.782369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:57.612619 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.830 seconds
[0m23:09:57.618713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a636116b-60e2-495b-8874-02698af24fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7541b0470980>]}
[0m23:09:57.625691 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m23:09:57.626378 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m23:09:57.626981 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m23:09:57.627632 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m23:09:57.628671 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m23:09:57.630451 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m23:09:57.632162 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m23:09:57.633995 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m23:09:57.635682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m23:09:57.637281 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m23:09:57.638569 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m23:09:57.640127 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m23:09:57.641336 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m23:09:57.642553 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m23:09:57.643687 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m23:09:57.645042 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m23:09:57.663312 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m23:09:57.668040 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m23:09:57.673454 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m23:09:57.678818 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m23:09:57.688818 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m23:09:57.690132 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m23:09:57.702412 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m23:09:57.702961 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m23:09:57.725610 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m23:09:57.727990 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m23:09:57.731276 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m23:09:57.735055 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m23:09:57.745012 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m23:09:57.747270 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m23:09:57.748253 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m23:09:57.749591 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m23:09:57.751223 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m23:09:57.752418 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m23:09:57.756687 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m23:09:57.758485 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m23:09:57.760046 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:09:57.761507 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:09:57.762882 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:09:58.057133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m23:09:58.089433 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.45s]
[0m23:09:58.092424 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m23:09:58.094749 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m23:09:58.097650 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m23:09:58.099884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m23:09:58.101635 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m23:09:58.109870 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m23:09:58.134460 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m23:09:58.142585 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m23:09:58.157264 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m23:09:58.158883 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m23:09:58.467933 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.305 seconds
[0m23:09:58.471965 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.37s]
[0m23:09:58.473866 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m23:09:58.476016 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m23:09:58.477742 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m23:09:58.479633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m23:09:58.481309 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m23:09:58.487366 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m23:09:58.501024 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m23:09:58.505123 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m23:09:58.517399 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m23:09:58.518963 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m23:09:58.912294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.392 seconds
[0m23:09:58.918810 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.44s]
[0m23:09:58.920605 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m23:09:58.922031 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m23:09:58.923437 [info ] [Thread-1 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m23:09:58.924925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m23:09:58.926563 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m23:09:58.932694 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m23:09:58.945812 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m23:09:58.951450 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m23:09:58.964485 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m23:09:58.965821 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m23:09:58.989032 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.229 seconds
[0m23:09:58.992724 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.36s]
[0m23:09:58.994573 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m23:09:58.996074 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m23:09:58.997602 [info ] [Thread-2 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m23:09:58.999341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m23:09:59.000823 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m23:09:59.006072 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m23:09:59.017067 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m23:09:59.021126 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m23:09:59.035621 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m23:09:59.036942 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m23:09:59.177057 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.414 seconds
[0m23:09:59.180198 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.54s]
[0m23:09:59.181884 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m23:09:59.183776 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m23:09:59.185709 [info ] [Thread-3 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m23:09:59.187786 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m23:09:59.189234 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m23:09:59.195280 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m23:09:59.197352 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.436 seconds
[0m23:09:59.206746 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.57s]
[0m23:09:59.209427 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m23:09:59.211664 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m23:09:59.213772 [info ] [Thread-4 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m23:09:59.217903 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m23:09:59.220776 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m23:09:59.227534 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m23:09:59.228023 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m23:09:59.233749 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m23:09:59.243024 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m23:09:59.252532 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m23:09:59.253276 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m23:09:59.255160 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m23:09:59.270609 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m23:09:59.272908 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m23:09:59.381722 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.414 seconds
[0m23:09:59.385772 [info ] [Thread-1 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 0.46s]
[0m23:09:59.388019 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m23:09:59.389749 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m23:09:59.391340 [info ] [Thread-1 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m23:09:59.393247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m23:09:59.395247 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m23:09:59.401666 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m23:09:59.415357 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m23:09:59.419493 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m23:09:59.423140 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.385 seconds
[0m23:09:59.427710 [info ] [Thread-2 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 0.43s]
[0m23:09:59.429753 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m23:09:59.431302 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m23:09:59.432896 [info ] [Thread-2 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m23:09:59.434568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m23:09:59.436251 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m23:09:59.442469 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m23:09:59.443431 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m23:09:59.445976 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m23:09:59.456467 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m23:09:59.462944 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m23:09:59.477560 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m23:09:59.478940 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m23:09:59.572394 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.314 seconds
[0m23:09:59.578461 [info ] [Thread-3 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.39s]
[0m23:09:59.580867 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m23:09:59.582876 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m23:09:59.585086 [info ] [Thread-3 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m23:09:59.587168 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m23:09:59.589164 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m23:09:59.595934 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m23:09:59.607260 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m23:09:59.611306 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m23:09:59.622683 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m23:09:59.624040 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m23:09:59.698335 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.423 seconds
[0m23:09:59.701858 [info ] [Thread-4 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.48s]
[0m23:09:59.703667 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m23:09:59.705203 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m23:09:59.706595 [info ] [Thread-4 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m23:09:59.708328 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m23:09:59.709841 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m23:09:59.719280 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m23:09:59.732796 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m23:09:59.736796 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m23:09:59.747996 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m23:09:59.749404 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m23:09:59.832731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.385 seconds
[0m23:09:59.836186 [info ] [Thread-1 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.44s]
[0m23:09:59.838026 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m23:09:59.839652 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m23:09:59.841235 [info ] [Thread-1 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m23:09:59.842720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m23:09:59.844202 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m23:09:59.851816 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m23:09:59.862770 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m23:09:59.867354 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m23:09:59.881023 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m23:09:59.882677 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m23:09:59.888467 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m23:09:59.891946 [info ] [Thread-2 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.46s]
[0m23:09:59.893674 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m23:09:59.895360 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m23:09:59.897331 [info ] [Thread-2 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m23:09:59.899163 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m23:09:59.900892 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m23:09:59.908419 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m23:09:59.923031 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m23:09:59.927803 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m23:09:59.944261 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m23:09:59.945975 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m23:10:00.028492 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m23:10:00.032078 [info ] [Thread-3 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.45s]
[0m23:10:00.034053 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m23:10:00.035599 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m23:10:00.037055 [info ] [Thread-3 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m23:10:00.038581 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m23:10:00.040122 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m23:10:00.047937 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m23:10:00.066187 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m23:10:00.074242 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m23:10:00.095108 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m23:10:00.097360 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m23:10:00.275216 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m23:10:00.278625 [info ] [Thread-4 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.57s]
[0m23:10:00.280415 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m23:10:00.282076 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m23:10:00.283776 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m23:10:00.287748 [info ] [Thread-1 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.44s]
[0m23:10:00.289768 [info ] [Thread-4 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m23:10:00.291812 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m23:10:00.293327 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m23:10:00.294872 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m23:10:00.296248 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m23:10:00.297711 [info ] [Thread-1 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m23:10:00.306939 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m23:10:00.308496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m23:10:00.311202 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m23:10:00.316975 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m23:10:00.324268 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m23:10:00.325726 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m23:10:00.329245 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m23:10:00.332999 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m23:10:00.342178 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m23:10:00.343574 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m23:10:00.344840 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m23:10:00.346296 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m23:10:00.391369 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.444 seconds
[0m23:10:00.395366 [info ] [Thread-2 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.50s]
[0m23:10:00.397490 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m23:10:00.399690 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m23:10:00.401220 [info ] [Thread-2 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m23:10:00.402933 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m23:10:00.404471 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m23:10:00.409752 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m23:10:00.424054 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m23:10:00.428161 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m23:10:00.441201 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m23:10:00.442448 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m23:10:00.598863 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m23:10:00.602381 [info ] [Thread-3 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.56s]
[0m23:10:00.604234 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m23:10:00.605746 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m23:10:00.607028 [info ] [Thread-3 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m23:10:00.608468 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m23:10:00.609867 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m23:10:00.615147 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m23:10:00.625226 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m23:10:00.631175 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m23:10:00.642414 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m23:10:00.643712 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m23:10:00.761761 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.412 seconds
[0m23:10:00.763107 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.415 seconds
[0m23:10:00.766214 [info ] [Thread-4 (]: 18 of 24 PASS unique_core_batches_batch_id ..................................... [[32mPASS[0m in 0.47s]
[0m23:10:00.769906 [info ] [Thread-1 (]: 19 of 24 PASS unique_core_materials_material_id ................................ [[32mPASS[0m in 0.46s]
[0m23:10:00.772114 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m23:10:00.774261 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m23:10:00.775931 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m23:10:00.777498 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m23:10:00.778916 [info ] [Thread-4 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m23:10:00.780284 [info ] [Thread-1 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m23:10:00.781865 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m23:10:00.783396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m23:10:00.784701 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m23:10:00.785988 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m23:10:00.791382 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m23:10:00.796377 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m23:10:00.805939 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m23:10:00.810742 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m23:10:00.811319 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m23:10:00.816429 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m23:10:00.824276 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m23:10:00.825617 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m23:10:00.826847 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m23:10:00.828394 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m23:10:00.863868 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.420 seconds
[0m23:10:00.867454 [info ] [Thread-2 (]: 20 of 24 PASS unique_fct_production_orders_order_id ............................ [[32mPASS[0m in 0.46s]
[0m23:10:00.869257 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m23:10:00.870718 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m23:10:00.872231 [info ] [Thread-2 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m23:10:00.873636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m23:10:00.875153 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m23:10:00.880303 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m23:10:00.890734 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m23:10:00.894809 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m23:10:00.907576 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m23:10:00.908968 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m23:10:01.032246 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.387 seconds
[0m23:10:01.035752 [info ] [Thread-3 (]: 21 of 24 PASS unique_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 0.43s]
[0m23:10:01.037546 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m23:10:01.142775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.311 seconds
[0m23:10:01.147207 [info ] [Thread-1 (]: 23 of 24 PASS unique_stg_materials_material_id ................................. [[32mPASS[0m in 0.36s]
[0m23:10:01.149633 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m23:10:01.209012 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.379 seconds
[0m23:10:01.212543 [info ] [Thread-4 (]: 22 of 24 PASS unique_stg_batches_batch_id ...................................... [[32mPASS[0m in 0.43s]
[0m23:10:01.214892 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m23:10:01.277088 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.367 seconds
[0m23:10:01.281226 [info ] [Thread-2 (]: 24 of 24 PASS unique_stg_production_orders_order_id ............................ [[32mPASS[0m in 0.41s]
[0m23:10:01.283175 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m23:10:01.286738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:01.288499 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m23:10:01.290042 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m23:10:01.744719 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m23:10:01.746266 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m23:10:02.217580 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m23:10:02.219184 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m23:10:02.694474 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m23:10:02.695917 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m23:10:03.163229 [info ] [MainThread]: 
[0m23:10:03.164861 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 7.44 seconds (7.44s).
[0m23:10:03.171547 [debug] [MainThread]: Command end result
[0m23:10:03.232228 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:10:03.240007 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:10:03.255896 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m23:10:03.257132 [info ] [MainThread]: 
[0m23:10:03.258314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:10:03.259501 [info ] [MainThread]: 
[0m23:10:03.260785 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m23:10:03.262655 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.239126, "process_in_blocks": "0", "process_kernel_time": 1.269671, "process_mem_max_rss": "224420", "process_out_blocks": "16", "process_user_time": 4.667329}
[0m23:10:03.263954 [debug] [MainThread]: Command `dbt test` succeeded at 23:10:03.263834 after 9.24 seconds
[0m23:10:03.265044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7541ce9ae750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7541b005c1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7541b05b5c70>]}
[0m23:10:03.265990 [debug] [MainThread]: Flushing usage events
[0m23:10:04.063375 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:16:22.016975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d621b9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d612e6fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d63389e80>]}


============================== 23:16:22.025617 | 0a5cd214-5ffc-4d79-899f-9b03f539a3f0 ==============================
[0m23:16:22.025617 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:16:22.027423 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'quiet': 'False', 'no_print': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run --select staging --profiles-dir /opt/airflow/dbt_profiles', 'indirect_selection': 'eager', 'partial_parse': 'True', 'introspect': 'True', 'target_path': 'None'}
[0m23:16:22.759555 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:16:22.761160 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:16:22.762601 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:16:22.995121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a5cd214-5ffc-4d79-899f-9b03f539a3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d3ff565a0>]}
[0m23:16:23.064584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a5cd214-5ffc-4d79-899f-9b03f539a3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d3ff1c6b0>]}
[0m23:16:23.066809 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m23:16:23.218490 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:16:23.470861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:16:23.472480 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:16:23.526606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a5cd214-5ffc-4d79-899f-9b03f539a3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d3fd0a150>]}
[0m23:16:23.684494 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:16:23.691980 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:16:23.727706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a5cd214-5ffc-4d79-899f-9b03f539a3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d3fac6ea0>]}
[0m23:16:23.729194 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m23:16:23.730448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a5cd214-5ffc-4d79-899f-9b03f539a3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d3fa8f2c0>]}
[0m23:16:23.733742 [info ] [MainThread]: 
[0m23:16:23.735370 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:16:23.736703 [info ] [MainThread]: 
[0m23:16:23.738223 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:16:23.745606 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m23:16:23.796714 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m23:16:23.798496 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m23:16:23.799986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:25.710863 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.911 seconds
[0m23:16:25.716448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m23:16:25.734450 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m23:16:25.736110 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m23:16:26.175094 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.437 seconds
[0m23:16:26.182133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a5cd214-5ffc-4d79-899f-9b03f539a3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d3fa8f470>]}
[0m23:16:26.190075 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m23:16:26.190863 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m23:16:26.191543 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m23:16:26.193461 [info ] [Thread-1 (]: 1 of 3 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m23:16:26.195948 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m23:16:26.198366 [info ] [Thread-3 (]: 3 of 3 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m23:16:26.200884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m23:16:26.203057 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m23:16:26.205175 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m23:16:26.207646 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m23:16:26.210192 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m23:16:26.212346 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m23:16:26.232561 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m23:16:26.326450 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m23:16:26.333718 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m23:16:26.345143 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m23:16:26.346248 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m23:16:26.355133 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m23:16:26.671922 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m23:16:26.707954 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m23:16:26.718861 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m23:16:26.744454 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m23:16:26.738291 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m23:16:26.747966 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m23:16:26.751005 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m23:16:26.752517 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m23:16:26.761606 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m23:16:26.764374 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:16:26.766218 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:16:27.287990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m23:16:27.339409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a5cd214-5ffc-4d79-899f-9b03f539a3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d63afe630>]}
[0m23:16:27.342031 [info ] [Thread-1 (]: 1 of 3 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 1.14s]
[0m23:16:27.344768 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m23:16:28.469477 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.705 seconds
[0m23:16:28.473184 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a5cd214-5ffc-4d79-899f-9b03f539a3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d610b40e0>]}
[0m23:16:28.474999 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 2.27s]
[0m23:16:28.476680 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m23:16:28.535206 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.769 seconds
[0m23:16:28.539710 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a5cd214-5ffc-4d79-899f-9b03f539a3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d3eb49760>]}
[0m23:16:28.542010 [info ] [Thread-3 (]: 3 of 3 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 2.33s]
[0m23:16:28.543864 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m23:16:28.547218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:16:28.548812 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_batches' was left open.
[0m23:16:28.550151 [debug] [MainThread]: On model.mfg_accelerator.stg_batches: Close
[0m23:16:29.036950 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_materials' was left open.
[0m23:16:29.038627 [debug] [MainThread]: On model.mfg_accelerator.stg_materials: Close
[0m23:16:29.514350 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_production_orders' was left open.
[0m23:16:29.516010 [debug] [MainThread]: On model.mfg_accelerator.stg_production_orders: Close
[0m23:16:29.997079 [info ] [MainThread]: 
[0m23:16:29.998974 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 6.26 seconds (6.26s).
[0m23:16:30.001204 [debug] [MainThread]: Command end result
[0m23:16:30.082329 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:16:30.094220 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:16:30.114067 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m23:16:30.116092 [info ] [MainThread]: 
[0m23:16:30.117900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:16:30.119823 [info ] [MainThread]: 
[0m23:16:30.121674 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:16:30.124921 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.19519, "process_in_blocks": "0", "process_kernel_time": 1.53151, "process_mem_max_rss": "219484", "process_out_blocks": "16", "process_user_time": 4.8889}
[0m23:16:30.127988 [debug] [MainThread]: Command `dbt run` succeeded at 23:16:30.127777 after 8.20 seconds
[0m23:16:30.129764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d44181280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d45d53590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d3ff84c20>]}
[0m23:16:30.131334 [debug] [MainThread]: Flushing usage events
[0m23:16:30.872017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:16:34.785845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acaad703d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acaac512db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acaac5105c0>]}


============================== 23:16:34.794435 | 8172f936-8287-4a67-9fef-b7438217ca44 ==============================
[0m23:16:34.794435 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:16:34.796078 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'warn_error': 'None', 'no_print': 'None', 'invocation_command': 'dbt run --select core --profiles-dir /opt/airflow/dbt_profiles', 'static_parser': 'True', 'version_check': 'True', 'target_path': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'indirect_selection': 'eager', 'write_json': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'introspect': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:16:35.601368 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:16:35.603511 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:16:35.605183 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:16:35.881100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8172f936-8287-4a67-9fef-b7438217ca44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca8b6450d0>]}
[0m23:16:35.956391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8172f936-8287-4a67-9fef-b7438217ca44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acaad5d9790>]}
[0m23:16:35.958912 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m23:16:36.129417 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:16:36.449088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:16:36.450767 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:16:36.501489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8172f936-8287-4a67-9fef-b7438217ca44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca8b034ef0>]}
[0m23:16:36.624349 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:16:36.630540 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:16:36.662156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8172f936-8287-4a67-9fef-b7438217ca44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca8adeef00>]}
[0m23:16:36.663517 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m23:16:36.664960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8172f936-8287-4a67-9fef-b7438217ca44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acaaee56d80>]}
[0m23:16:36.668515 [info ] [MainThread]: 
[0m23:16:36.669987 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:16:36.671313 [info ] [MainThread]: 
[0m23:16:36.672825 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:16:36.678640 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m23:16:36.724770 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m23:16:36.726537 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m23:16:36.727965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:38.624535 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.898 seconds
[0m23:16:38.629259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m23:16:38.644607 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m23:16:38.646235 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m23:16:38.961651 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.314 seconds
[0m23:16:38.966775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8172f936-8287-4a67-9fef-b7438217ca44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca8b057e00>]}
[0m23:16:38.973815 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.core_materials
[0m23:16:38.975718 [info ] [Thread-1 (]: 1 of 3 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m23:16:38.977156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.core_materials)
[0m23:16:38.978674 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.core_materials
[0m23:16:38.988548 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m23:16:39.000584 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.core_materials
[0m23:16:39.098759 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m23:16:39.111346 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m23:16:39.112646 [debug] [Thread-1 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m23:16:41.088654 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.975 seconds
[0m23:16:41.115287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8172f936-8287-4a67-9fef-b7438217ca44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acaaedbe7b0>]}
[0m23:16:41.117129 [info ] [Thread-1 (]: 1 of 3 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 2.14s]
[0m23:16:41.118826 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.core_materials
[0m23:16:41.120983 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.core_batches
[0m23:16:41.121725 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m23:16:41.123324 [info ] [Thread-3 (]: 2 of 3 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m23:16:41.124990 [info ] [Thread-4 (]: 3 of 3 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m23:16:41.126779 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_batches'
[0m23:16:41.128189 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.fct_production_orders'
[0m23:16:41.129654 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.core_batches
[0m23:16:41.130939 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m23:16:41.135422 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m23:16:41.140065 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m23:16:41.147537 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m23:16:41.152423 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m23:16:41.153905 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.core_batches
[0m23:16:41.158708 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m23:16:41.167757 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m23:16:41.169065 [debug] [Thread-4 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m23:16:41.170555 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:16:41.172632 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m23:16:41.179497 [debug] [Thread-3 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m23:16:41.181033 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:16:44.001939 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.821 seconds
[0m23:16:44.006306 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8172f936-8287-4a67-9fef-b7438217ca44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca89ec07a0>]}
[0m23:16:44.008010 [info ] [Thread-3 (]: 2 of 3 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 2.88s]
[0m23:16:44.009669 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.core_batches
[0m23:16:44.433820 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.263 seconds
[0m23:16:44.437639 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8172f936-8287-4a67-9fef-b7438217ca44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acaac382bd0>]}
[0m23:16:44.439511 [info ] [Thread-4 (]: 3 of 3 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 3.31s]
[0m23:16:44.441276 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m23:16:44.444547 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:16:44.446279 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_materials' was left open.
[0m23:16:44.447749 [debug] [MainThread]: On model.mfg_accelerator.core_materials: Close
[0m23:16:45.048130 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m23:16:45.049875 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m23:16:45.596344 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m23:16:45.599076 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m23:16:46.129436 [info ] [MainThread]: 
[0m23:16:46.131922 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 9.46 seconds (9.46s).
[0m23:16:46.135959 [debug] [MainThread]: Command end result
[0m23:16:46.241822 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:16:46.252117 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:16:46.265529 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m23:16:46.267133 [info ] [MainThread]: 
[0m23:16:46.268584 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:16:46.270236 [info ] [MainThread]: 
[0m23:16:46.271806 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:16:46.274369 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.574347, "process_in_blocks": "0", "process_kernel_time": 1.254663, "process_mem_max_rss": "219448", "process_out_blocks": "16", "process_user_time": 4.29883}
[0m23:16:46.275788 [debug] [MainThread]: Command `dbt run` succeeded at 23:16:46.275627 after 11.58 seconds
[0m23:16:46.276982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acaac5105c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acaacfc5df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acaacfada60>]}
[0m23:16:46.278131 [debug] [MainThread]: Flushing usage events
[0m23:16:46.964860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:16:51.733891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729e42836030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729e4125f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729e43a08830>]}


============================== 23:16:51.742618 | b1c24e70-277b-41ce-a474-a69614478690 ==============================
[0m23:16:51.742618 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:16:51.744410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select marts --profiles-dir /opt/airflow/dbt_profiles', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'quiet': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'target_path': 'None', 'static_parser': 'True'}
[0m23:16:52.458005 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:16:52.459705 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:16:52.461172 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:16:52.665095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1c24e70-277b-41ce-a474-a69614478690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729e24f69c40>]}
[0m23:16:52.736659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1c24e70-277b-41ce-a474-a69614478690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729e1f53b440>]}
[0m23:16:52.738714 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m23:16:52.904094 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:16:53.154538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:16:53.156176 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:16:53.206681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1c24e70-277b-41ce-a474-a69614478690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729e1f46a000>]}
[0m23:16:53.331082 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:16:53.339200 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:16:53.370211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1c24e70-277b-41ce-a474-a69614478690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729e1f016f30>]}
[0m23:16:53.371884 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m23:16:53.373283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c24e70-277b-41ce-a474-a69614478690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729e1f3fd880>]}
[0m23:16:53.376228 [info ] [MainThread]: 
[0m23:16:53.377233 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:16:53.378530 [info ] [MainThread]: 
[0m23:16:53.380083 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:16:53.385473 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m23:16:53.433673 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m23:16:53.435491 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m23:16:53.437019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:54.933908 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.497 seconds
[0m23:16:54.939930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m23:16:54.954704 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m23:16:54.956388 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m23:16:55.309028 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.350 seconds
[0m23:16:55.314609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c24e70-277b-41ce-a474-a69614478690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729e1f010c80>]}
[0m23:16:55.321764 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m23:16:55.322423 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m23:16:55.324158 [info ] [Thread-1 (]: 1 of 2 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m23:16:55.326083 [info ] [Thread-2 (]: 2 of 2 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m23:16:55.327955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.mfg_ml_features_orders)
[0m23:16:55.329636 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.mfg_plant_daily_kpis'
[0m23:16:55.331033 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m23:16:55.332505 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m23:16:55.343676 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m23:16:55.409948 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m23:16:55.417800 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m23:16:55.419098 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m23:16:55.476632 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m23:16:55.478624 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m23:16:55.491539 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m23:16:55.495013 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m23:16:55.496424 [debug] [Thread-2 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m23:16:55.498230 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m23:16:55.499939 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:16:56.860324 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.359 seconds
[0m23:16:56.893395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1c24e70-277b-41ce-a474-a69614478690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729e43046480>]}
[0m23:16:56.895559 [info ] [Thread-1 (]: 1 of 2 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 1.56s]
[0m23:16:56.897703 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m23:16:58.047399 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.547 seconds
[0m23:16:58.051266 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1c24e70-277b-41ce-a474-a69614478690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729e1f3ad910>]}
[0m23:16:58.053050 [info ] [Thread-2 (]: 2 of 2 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 2.72s]
[0m23:16:58.054748 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m23:16:58.058277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:16:58.060214 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m23:16:58.061936 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m23:16:58.534492 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m23:16:58.536334 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m23:16:59.002945 [info ] [MainThread]: 
[0m23:16:59.004638 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m23:16:59.006749 [debug] [MainThread]: Command end result
[0m23:16:59.073134 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:16:59.081395 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:16:59.096464 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m23:16:59.097976 [info ] [MainThread]: 
[0m23:16:59.099667 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:16:59.101552 [info ] [MainThread]: 
[0m23:16:59.103198 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:16:59.105526 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.456526, "process_in_blocks": "0", "process_kernel_time": 1.393329, "process_mem_max_rss": "216996", "process_out_blocks": "16", "process_user_time": 4.336138}
[0m23:16:59.107211 [debug] [MainThread]: Command `dbt run` succeeded at 23:16:59.107055 after 7.46 seconds
[0m23:16:59.108856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729e4084dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729e411fe3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729e1f026f00>]}
[0m23:16:59.110401 [debug] [MainThread]: Flushing usage events
[0m23:16:59.710860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:17:03.214341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fce6f40110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fce8f05880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fce6b52ed0>]}


============================== 23:17:03.222302 | afea8299-5d5d-40db-ac32-46376adf35e2 ==============================
[0m23:17:03.222302 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:17:03.224157 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'fail_fast': 'False', 'target_path': 'None', 'version_check': 'True', 'write_json': 'True', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt_profiles', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'log_cache_events': 'False', 'warn_error': 'None', 'quiet': 'False', 'debug': 'False', 'empty': 'None', 'printer_width': '80', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'indirect_selection': 'eager'}
[0m23:17:03.957364 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:17:03.959573 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:17:03.961341 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:17:04.172571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afea8299-5d5d-40db-ac32-46376adf35e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fce6a1f980>]}
[0m23:17:04.244343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afea8299-5d5d-40db-ac32-46376adf35e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fce5f06240>]}
[0m23:17:04.246841 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m23:17:04.414118 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:17:04.671360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:17:04.672946 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:17:04.722880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afea8299-5d5d-40db-ac32-46376adf35e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fccb754740>]}
[0m23:17:04.847844 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:17:04.855603 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:17:04.898654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afea8299-5d5d-40db-ac32-46376adf35e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcc881f8f0>]}
[0m23:17:04.900082 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m23:17:04.901779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afea8299-5d5d-40db-ac32-46376adf35e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcc95a1100>]}
[0m23:17:04.906025 [info ] [MainThread]: 
[0m23:17:04.907548 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:17:04.908973 [info ] [MainThread]: 
[0m23:17:04.910599 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:17:04.916694 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m23:17:04.969946 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m23:17:04.971518 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m23:17:04.972959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:17:06.626981 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.654 seconds
[0m23:17:06.632251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afea8299-5d5d-40db-ac32-46376adf35e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fce6dc9e80>]}
[0m23:17:06.639401 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m23:17:06.640009 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m23:17:06.640810 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m23:17:06.641555 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m23:17:06.642584 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m23:17:06.644324 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m23:17:06.645756 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m23:17:06.647512 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m23:17:06.649327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m23:17:06.651045 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m23:17:06.652378 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m23:17:06.653952 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m23:17:06.655466 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m23:17:06.656909 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m23:17:06.658431 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m23:17:06.659837 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m23:17:06.679307 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m23:17:06.683624 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m23:17:06.688506 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m23:17:06.695019 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m23:17:06.704390 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m23:17:06.705601 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m23:17:06.712343 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m23:17:06.712927 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m23:17:06.739914 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m23:17:06.742235 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m23:17:06.746124 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m23:17:06.750023 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m23:17:06.765004 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m23:17:06.766785 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m23:17:06.768444 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m23:17:06.773720 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m23:17:06.775481 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m23:17:06.777106 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m23:17:06.780246 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m23:17:06.787403 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m23:17:06.789852 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:17:06.793550 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:17:06.796240 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:17:07.346148 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.564 seconds
[0m23:17:07.361439 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.71s]
[0m23:17:07.363701 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m23:17:07.365489 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m23:17:07.367138 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m23:17:07.369032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m23:17:07.370689 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m23:17:07.379563 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m23:17:07.411883 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m23:17:07.427152 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m23:17:07.446046 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m23:17:07.447790 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m23:17:07.729776 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.280 seconds
[0m23:17:07.737743 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.37s]
[0m23:17:07.740668 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m23:17:07.743028 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m23:17:07.745006 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m23:17:07.747206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m23:17:07.749145 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m23:17:07.758313 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m23:17:07.772573 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m23:17:07.781119 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m23:17:07.795528 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m23:17:07.797142 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m23:17:08.146300 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.350 seconds
[0m23:17:08.150459 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.40s]
[0m23:17:08.152335 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m23:17:08.153863 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m23:17:08.155455 [info ] [Thread-1 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m23:17:08.157175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m23:17:08.158711 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m23:17:08.164705 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m23:17:08.176159 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m23:17:08.181539 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m23:17:08.194160 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m23:17:08.195504 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m23:17:08.306923 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.520 seconds
[0m23:17:08.311765 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.66s]
[0m23:17:08.313998 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m23:17:08.315878 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m23:17:08.317577 [info ] [Thread-3 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m23:17:08.319631 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m23:17:08.321186 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m23:17:08.327552 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m23:17:08.338559 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.547 seconds
[0m23:17:08.345008 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.69s]
[0m23:17:08.349090 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.555 seconds
[0m23:17:08.351511 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m23:17:08.353658 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m23:17:08.359611 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.71s]
[0m23:17:08.362604 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m23:17:08.371193 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m23:17:08.374028 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m23:17:08.376706 [info ] [Thread-2 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m23:17:08.381330 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m23:17:08.384612 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m23:17:08.387344 [info ] [Thread-4 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m23:17:08.390529 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m23:17:08.394100 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m23:17:08.407092 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m23:17:08.409551 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m23:17:08.414017 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m23:17:08.424938 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m23:17:08.427196 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m23:17:08.431219 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m23:17:08.442655 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m23:17:08.443804 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m23:17:08.461126 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m23:17:08.471889 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m23:17:08.475582 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m23:17:08.477378 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m23:17:08.478848 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m23:17:08.605756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m23:17:08.609407 [info ] [Thread-1 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 0.45s]
[0m23:17:08.611212 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m23:17:08.612751 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m23:17:08.614249 [info ] [Thread-1 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m23:17:08.615752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m23:17:08.617161 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m23:17:08.624462 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m23:17:08.636187 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m23:17:08.640612 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m23:17:08.653318 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m23:17:08.654715 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m23:17:08.783065 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.351 seconds
[0m23:17:08.786793 [info ] [Thread-3 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 0.47s]
[0m23:17:08.788893 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m23:17:08.790490 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m23:17:08.791980 [info ] [Thread-3 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m23:17:08.793552 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m23:17:08.795434 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.315 seconds
[0m23:17:08.796553 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m23:17:08.799935 [info ] [Thread-2 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.42s]
[0m23:17:08.806724 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m23:17:08.808370 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m23:17:08.810822 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m23:17:08.812169 [info ] [Thread-2 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m23:17:08.813671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m23:17:08.814986 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m23:17:08.822963 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m23:17:08.825305 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m23:17:08.830895 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m23:17:08.834709 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m23:17:08.838873 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m23:17:08.847142 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.364 seconds
[0m23:17:08.849081 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m23:17:08.850682 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m23:17:08.853350 [info ] [Thread-4 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.46s]
[0m23:17:08.855092 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m23:17:08.856989 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m23:17:08.858656 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m23:17:08.864297 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m23:17:08.865740 [info ] [Thread-4 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m23:17:08.867010 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m23:17:08.868272 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m23:17:08.879047 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m23:17:08.890708 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m23:17:08.894734 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m23:17:08.907091 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m23:17:08.908591 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m23:17:08.949694 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.294 seconds
[0m23:17:08.953741 [info ] [Thread-1 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.34s]
[0m23:17:08.956440 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m23:17:08.958639 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m23:17:08.960332 [info ] [Thread-1 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m23:17:08.962127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m23:17:08.963889 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m23:17:08.972351 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m23:17:08.985145 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m23:17:08.989815 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m23:17:09.004992 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m23:17:09.006571 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m23:17:09.174897 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.313 seconds
[0m23:17:09.178605 [info ] [Thread-2 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.36s]
[0m23:17:09.180406 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m23:17:09.181995 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m23:17:09.183521 [info ] [Thread-2 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m23:17:09.185346 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m23:17:09.186896 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m23:17:09.193307 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m23:17:09.203233 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m23:17:09.207414 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m23:17:09.218403 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m23:17:09.219648 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m23:17:09.236881 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.377 seconds
[0m23:17:09.241562 [info ] [Thread-3 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.45s]
[0m23:17:09.243797 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m23:17:09.245572 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m23:17:09.247317 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.337 seconds
[0m23:17:09.248681 [info ] [Thread-3 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m23:17:09.252235 [info ] [Thread-4 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.39s]
[0m23:17:09.254020 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m23:17:09.255794 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m23:17:09.257376 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m23:17:09.258793 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m23:17:09.266870 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m23:17:09.268248 [info ] [Thread-4 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m23:17:09.271097 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m23:17:09.273127 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m23:17:09.281262 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m23:17:09.289340 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m23:17:09.295129 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m23:17:09.295811 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m23:17:09.302167 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m23:17:09.312144 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m23:17:09.314137 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m23:17:09.317244 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m23:17:09.319509 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m23:17:09.390212 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.382 seconds
[0m23:17:09.394626 [info ] [Thread-1 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.43s]
[0m23:17:09.396882 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m23:17:09.398444 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m23:17:09.399888 [info ] [Thread-1 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m23:17:09.401413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m23:17:09.402844 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m23:17:09.408303 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m23:17:09.421588 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m23:17:09.425547 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m23:17:09.437893 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m23:17:09.439330 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m23:17:09.637769 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m23:17:09.639532 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.419 seconds
[0m23:17:09.642938 [info ] [Thread-4 (]: 18 of 24 PASS unique_core_batches_batch_id ..................................... [[32mPASS[0m in 0.37s]
[0m23:17:09.646022 [info ] [Thread-2 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.46s]
[0m23:17:09.647601 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m23:17:09.649330 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m23:17:09.650742 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m23:17:09.652215 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m23:17:09.653527 [info ] [Thread-4 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m23:17:09.654776 [info ] [Thread-2 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m23:17:09.656390 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m23:17:09.657743 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m23:17:09.658964 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m23:17:09.660198 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m23:17:09.665313 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m23:17:09.671488 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m23:17:09.681392 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m23:17:09.682140 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m23:17:09.686991 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m23:17:09.691195 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m23:17:09.702524 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m23:17:09.703819 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m23:17:09.704931 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m23:17:09.706444 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m23:17:09.721920 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m23:17:09.725578 [info ] [Thread-3 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.47s]
[0m23:17:09.727369 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m23:17:09.728881 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m23:17:09.730391 [info ] [Thread-3 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m23:17:09.731768 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m23:17:09.733237 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m23:17:09.740755 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m23:17:09.747310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.307 seconds
[0m23:17:09.751206 [info ] [Thread-1 (]: 19 of 24 PASS unique_core_materials_material_id ................................ [[32mPASS[0m in 0.35s]
[0m23:17:09.753334 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m23:17:09.755366 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m23:17:09.756818 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m23:17:09.757507 [info ] [Thread-1 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m23:17:09.761800 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m23:17:09.763367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m23:17:09.766040 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m23:17:09.771870 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m23:17:09.780443 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m23:17:09.782277 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m23:17:09.785921 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m23:17:09.790439 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m23:17:09.802371 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m23:17:09.804095 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m23:17:10.274385 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m23:17:10.277895 [info ] [Thread-4 (]: 20 of 24 PASS unique_fct_production_orders_order_id ............................ [[32mPASS[0m in 0.62s]
[0m23:17:10.279701 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m23:17:10.281086 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m23:17:10.282470 [info ] [Thread-4 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m23:17:10.283948 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m23:17:10.285390 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m23:17:10.290657 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m23:17:10.302432 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m23:17:10.308579 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m23:17:10.310946 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m23:17:10.316040 [info ] [Thread-2 (]: 21 of 24 PASS unique_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 0.66s]
[0m23:17:10.318273 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m23:17:10.326299 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m23:17:10.327903 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m23:17:10.353382 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.569 seconds
[0m23:17:10.357003 [info ] [Thread-3 (]: 22 of 24 PASS unique_stg_batches_batch_id ...................................... [[32mPASS[0m in 0.63s]
[0m23:17:10.358835 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m23:17:10.394837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m23:17:10.398363 [info ] [Thread-1 (]: 23 of 24 PASS unique_stg_materials_material_id ................................. [[32mPASS[0m in 0.63s]
[0m23:17:10.400324 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m23:17:10.647939 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.319 seconds
[0m23:17:10.651803 [info ] [Thread-4 (]: 24 of 24 PASS unique_stg_production_orders_order_id ............................ [[32mPASS[0m in 0.37s]
[0m23:17:10.653592 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m23:17:10.657366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:17:10.658964 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m23:17:10.660186 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m23:17:11.136083 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m23:17:11.137767 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m23:17:11.606757 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m23:17:11.608483 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m23:17:12.084685 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m23:17:12.086372 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m23:17:12.552782 [info ] [MainThread]: 
[0m23:17:12.554546 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 7.64 seconds (7.64s).
[0m23:17:12.560647 [debug] [MainThread]: Command end result
[0m23:17:12.619091 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:17:12.627510 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:17:12.643324 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m23:17:12.644694 [info ] [MainThread]: 
[0m23:17:12.646127 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:17:12.647634 [info ] [MainThread]: 
[0m23:17:12.649015 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m23:17:12.651414 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.525194, "process_in_blocks": "0", "process_kernel_time": 1.389604, "process_mem_max_rss": "224044", "process_out_blocks": "16", "process_user_time": 4.777016}
[0m23:17:12.652935 [debug] [MainThread]: Command `dbt test` succeeded at 23:17:12.652768 after 9.53 seconds
[0m23:17:12.654398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fce6bb7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fce6bb6b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fce6bb53d0>]}
[0m23:17:12.655740 [debug] [MainThread]: Flushing usage events
[0m23:17:13.265774 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:17:19.417944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9d7633890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9d6cf0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9d6208290>]}


============================== 23:17:19.428302 | 4b467417-89b0-4329-99c5-4f7fdbd9da66 ==============================
[0m23:17:19.428302 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:17:19.431284 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'invocation_command': 'dbt run --select staging --profiles-dir /opt/airflow/dbt_profiles', 'profiles_dir': '/opt/airflow/dbt_profiles', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'introspect': 'True', 'version_check': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_colors': 'True', 'write_json': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:17:20.308008 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:17:20.310268 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:17:20.329170 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:17:20.641665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b467417-89b0-4329-99c5-4f7fdbd9da66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9b94820f0>]}
[0m23:17:20.717586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b467417-89b0-4329-99c5-4f7fdbd9da66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9b92b7320>]}
[0m23:17:20.719551 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m23:17:20.900224 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:17:21.197153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:17:21.198794 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:17:21.259482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b467417-89b0-4329-99c5-4f7fdbd9da66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9d5ff6600>]}
[0m23:17:21.399607 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:17:21.406142 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:17:21.442953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b467417-89b0-4329-99c5-4f7fdbd9da66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9b8bc58b0>]}
[0m23:17:21.444778 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m23:17:21.446279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b467417-89b0-4329-99c5-4f7fdbd9da66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9b8b7f3b0>]}
[0m23:17:21.449433 [info ] [MainThread]: 
[0m23:17:21.450642 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:17:21.452034 [info ] [MainThread]: 
[0m23:17:21.453776 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:17:21.460667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m23:17:21.512458 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m23:17:21.514031 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m23:17:21.515415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:17:23.259827 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.744 seconds
[0m23:17:23.265214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m23:17:23.312127 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m23:17:23.314114 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m23:17:23.603306 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.287 seconds
[0m23:17:23.613204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b467417-89b0-4329-99c5-4f7fdbd9da66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9d86a59d0>]}
[0m23:17:23.626932 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m23:17:23.627924 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m23:17:23.628817 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m23:17:23.630790 [info ] [Thread-1 (]: 1 of 3 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m23:17:23.633277 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m23:17:23.636279 [info ] [Thread-3 (]: 3 of 3 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m23:17:23.638984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m23:17:23.641451 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m23:17:23.643204 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m23:17:23.644585 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m23:17:23.645854 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m23:17:23.647351 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m23:17:23.671633 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m23:17:23.761214 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m23:17:23.766637 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m23:17:23.776406 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m23:17:23.777476 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m23:17:23.784422 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m23:17:23.859327 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m23:17:23.860374 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m23:17:23.864668 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m23:17:23.875182 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m23:17:23.877509 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m23:17:23.879434 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m23:17:23.880522 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m23:17:23.882269 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m23:17:23.884274 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m23:17:23.888641 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:17:23.891034 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:17:24.372031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.486 seconds
[0m23:17:24.409733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b467417-89b0-4329-99c5-4f7fdbd9da66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9b3d9d730>]}
[0m23:17:24.413415 [info ] [Thread-1 (]: 1 of 3 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 0.77s]
[0m23:17:24.424098 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m23:17:25.641638 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.753 seconds
[0m23:17:25.646303 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b467417-89b0-4329-99c5-4f7fdbd9da66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9b3b554c0>]}
[0m23:17:25.648058 [info ] [Thread-3 (]: 3 of 3 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 2.00s]
[0m23:17:25.649906 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m23:17:25.659952 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.769 seconds
[0m23:17:25.664101 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b467417-89b0-4329-99c5-4f7fdbd9da66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9b3b76570>]}
[0m23:17:25.665830 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 2.02s]
[0m23:17:25.667726 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m23:17:25.671052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:17:25.672706 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_batches' was left open.
[0m23:17:25.675995 [debug] [MainThread]: On model.mfg_accelerator.stg_batches: Close
[0m23:17:26.148861 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_materials' was left open.
[0m23:17:26.159339 [debug] [MainThread]: On model.mfg_accelerator.stg_materials: Close
[0m23:17:26.617062 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_production_orders' was left open.
[0m23:17:26.619253 [debug] [MainThread]: On model.mfg_accelerator.stg_production_orders: Close
[0m23:17:27.074139 [info ] [MainThread]: 
[0m23:17:27.077133 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m23:17:27.080309 [debug] [MainThread]: Command end result
[0m23:17:27.152275 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:17:27.160924 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:17:27.172570 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m23:17:27.174618 [info ] [MainThread]: 
[0m23:17:27.176865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:17:27.178726 [info ] [MainThread]: 
[0m23:17:27.180399 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:17:27.182989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.8564844, "process_in_blocks": "0", "process_kernel_time": 1.344242, "process_mem_max_rss": "219172", "process_out_blocks": "16", "process_user_time": 4.82487}
[0m23:17:27.184765 [debug] [MainThread]: Command `dbt run` succeeded at 23:17:27.184640 after 7.86 seconds
[0m23:17:27.186265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9d6cf0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9d616e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de9d616ef30>]}
[0m23:17:27.187603 [debug] [MainThread]: Flushing usage events
[0m23:17:27.823542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:17:31.569958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729435653170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729437144a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729435797920>]}


============================== 23:17:31.582886 | 09186096-c28e-4db7-880b-7fa62a3a6d42 ==============================
[0m23:17:31.582886 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:17:31.584892 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt_project/logs', 'no_print': 'None', 'log_format': 'default', 'target_path': 'None', 'debug': 'False', 'quiet': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --select core --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'empty': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'printer_width': '80', 'profiles_dir': '/opt/airflow/dbt_profiles', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m23:17:32.388703 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:17:32.390300 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:17:32.392045 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:17:32.632609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09186096-c28e-4db7-880b-7fa62a3a6d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72941376fec0>]}
[0m23:17:32.720370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09186096-c28e-4db7-880b-7fa62a3a6d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7294138dbb60>]}
[0m23:17:32.722288 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m23:17:32.892818 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:17:33.280416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:17:33.281669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:17:33.340128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09186096-c28e-4db7-880b-7fa62a3a6d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72941325e480>]}
[0m23:17:33.464883 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:17:33.473051 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:17:33.507501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09186096-c28e-4db7-880b-7fa62a3a6d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729412db2bd0>]}
[0m23:17:33.509088 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m23:17:33.510132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09186096-c28e-4db7-880b-7fa62a3a6d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729412e02b40>]}
[0m23:17:33.513088 [info ] [MainThread]: 
[0m23:17:33.514416 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:17:33.515720 [info ] [MainThread]: 
[0m23:17:33.517432 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:17:33.523366 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m23:17:33.567141 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m23:17:33.568750 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m23:17:33.570208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:17:35.074306 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.504 seconds
[0m23:17:35.079209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m23:17:35.098125 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m23:17:35.100050 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m23:17:35.444448 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.343 seconds
[0m23:17:35.450980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09186096-c28e-4db7-880b-7fa62a3a6d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7294134d7410>]}
[0m23:17:35.458842 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.core_materials
[0m23:17:35.461193 [info ] [Thread-1 (]: 1 of 3 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m23:17:35.463047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.core_materials)
[0m23:17:35.464901 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.core_materials
[0m23:17:35.476111 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m23:17:35.488250 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.core_materials
[0m23:17:35.585724 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m23:17:35.600062 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m23:17:35.601559 [debug] [Thread-1 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m23:17:36.585071 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.982 seconds
[0m23:17:36.616244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09186096-c28e-4db7-880b-7fa62a3a6d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729436ee2f30>]}
[0m23:17:36.618335 [info ] [Thread-1 (]: 1 of 3 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 1.15s]
[0m23:17:36.620228 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.core_materials
[0m23:17:36.623201 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.core_batches
[0m23:17:36.623943 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m23:17:36.625689 [info ] [Thread-3 (]: 2 of 3 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m23:17:36.627616 [info ] [Thread-4 (]: 3 of 3 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m23:17:36.629569 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_batches'
[0m23:17:36.631158 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.fct_production_orders'
[0m23:17:36.632579 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.core_batches
[0m23:17:36.633988 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m23:17:36.638848 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m23:17:36.645017 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m23:17:36.653034 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.core_batches
[0m23:17:36.654114 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m23:17:36.659212 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m23:17:36.663703 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m23:17:36.673462 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m23:17:36.678131 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m23:17:36.680281 [debug] [Thread-3 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m23:17:36.682327 [debug] [Thread-4 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m23:17:36.683992 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:17:36.685367 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:17:39.129690 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.448 seconds
[0m23:17:39.135139 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09186096-c28e-4db7-880b-7fa62a3a6d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72941319ce30>]}
[0m23:17:39.136973 [info ] [Thread-3 (]: 2 of 3 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 2.51s]
[0m23:17:39.139107 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.core_batches
[0m23:17:39.566583 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.883 seconds
[0m23:17:39.574358 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09186096-c28e-4db7-880b-7fa62a3a6d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7294343f74d0>]}
[0m23:17:39.580589 [info ] [Thread-4 (]: 3 of 3 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 2.94s]
[0m23:17:39.583354 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m23:17:39.588357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:17:39.590735 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_materials' was left open.
[0m23:17:39.593054 [debug] [MainThread]: On model.mfg_accelerator.core_materials: Close
[0m23:17:40.045433 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m23:17:40.047160 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m23:17:40.509150 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m23:17:40.511159 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m23:17:40.988158 [info ] [MainThread]: 
[0m23:17:40.992242 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.47 seconds (7.47s).
[0m23:17:40.998494 [debug] [MainThread]: Command end result
[0m23:17:41.255494 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:17:41.265997 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:17:41.283429 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m23:17:41.285369 [info ] [MainThread]: 
[0m23:17:41.287079 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:17:41.288598 [info ] [MainThread]: 
[0m23:17:41.290960 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:17:41.293761 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.817152, "process_in_blocks": "0", "process_kernel_time": 1.245372, "process_mem_max_rss": "218940", "process_out_blocks": "16", "process_user_time": 4.519497}
[0m23:17:41.295547 [debug] [MainThread]: Command `dbt run` succeeded at 23:17:41.295316 after 9.82 seconds
[0m23:17:41.297142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72941354b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729413503440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729413453380>]}
[0m23:17:41.299139 [debug] [MainThread]: Flushing usage events
[0m23:17:41.963648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:17:46.270569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41f46da2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41f4607c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41f4144650>]}


============================== 23:17:46.279492 | 2f070163-12d0-47ef-bf5f-a2a12422d98a ==============================
[0m23:17:46.279492 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:17:46.281415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'target_path': 'None', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'quiet': 'False', 'introspect': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select marts --profiles-dir /opt/airflow/dbt_profiles', 'partial_parse': 'True', 'version_check': 'True', 'empty': 'False'}
[0m23:17:47.623166 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:17:47.625439 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:17:47.627406 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:17:47.924319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f070163-12d0-47ef-bf5f-a2a12422d98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41d8bf56a0>]}
[0m23:17:48.021871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f070163-12d0-47ef-bf5f-a2a12422d98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41f3dfb290>]}
[0m23:17:48.024469 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m23:17:48.209797 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:17:48.988703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:17:48.991379 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:17:49.095908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f070163-12d0-47ef-bf5f-a2a12422d98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41d1fcd310>]}
[0m23:17:49.395268 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:17:49.411909 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:17:49.480398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f070163-12d0-47ef-bf5f-a2a12422d98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41d1baed20>]}
[0m23:17:49.482390 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m23:17:49.484435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f070163-12d0-47ef-bf5f-a2a12422d98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41d1b820c0>]}
[0m23:17:49.493191 [info ] [MainThread]: 
[0m23:17:49.496272 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:17:49.499110 [info ] [MainThread]: 
[0m23:17:49.502141 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:17:49.518287 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m23:17:49.643731 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m23:17:49.646843 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m23:17:49.649631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:17:51.031255 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.382 seconds
[0m23:17:51.036589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m23:17:51.055153 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m23:17:51.058216 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m23:17:51.348485 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.288 seconds
[0m23:17:51.355594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f070163-12d0-47ef-bf5f-a2a12422d98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41f2fbcaa0>]}
[0m23:17:51.362844 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m23:17:51.363456 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m23:17:51.365284 [info ] [Thread-1 (]: 1 of 2 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m23:17:51.367346 [info ] [Thread-2 (]: 2 of 2 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m23:17:51.368969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.mfg_ml_features_orders)
[0m23:17:51.370642 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.mfg_plant_daily_kpis'
[0m23:17:51.372155 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m23:17:51.373758 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m23:17:51.385759 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m23:17:51.472177 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m23:17:51.482129 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m23:17:51.489058 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m23:17:51.566030 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m23:17:51.566722 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m23:17:51.580269 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m23:17:51.586434 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m23:17:51.587615 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m23:17:51.590856 [debug] [Thread-2 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m23:17:51.595745 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:17:52.826857 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.234 seconds
[0m23:17:52.869360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f070163-12d0-47ef-bf5f-a2a12422d98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41d0be3890>]}
[0m23:17:52.872649 [info ] [Thread-1 (]: 1 of 2 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 1.50s]
[0m23:17:52.876693 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m23:17:53.931477 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.336 seconds
[0m23:17:53.935509 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f070163-12d0-47ef-bf5f-a2a12422d98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41d1c3e1e0>]}
[0m23:17:53.937170 [info ] [Thread-2 (]: 2 of 2 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 2.56s]
[0m23:17:53.938981 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m23:17:53.942808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:17:53.944319 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m23:17:53.945665 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m23:17:54.435215 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m23:17:54.437232 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m23:17:54.930236 [info ] [MainThread]: 
[0m23:17:54.932135 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m23:17:54.934576 [debug] [MainThread]: Command end result
[0m23:17:54.995402 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:17:55.002062 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:17:55.015515 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m23:17:55.016773 [info ] [MainThread]: 
[0m23:17:55.018073 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:17:55.019513 [info ] [MainThread]: 
[0m23:17:55.020818 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:17:55.022929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.895028, "process_in_blocks": "0", "process_kernel_time": 1.346513, "process_mem_max_rss": "217420", "process_out_blocks": "16", "process_user_time": 5.545406}
[0m23:17:55.024777 [debug] [MainThread]: Command `dbt run` succeeded at 23:17:55.024563 after 8.90 seconds
[0m23:17:55.026481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41f76cb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41f4144650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c41d1bb7f50>]}
[0m23:17:55.027920 [debug] [MainThread]: Flushing usage events
[0m23:17:55.692158 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:17:59.975618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75268e262fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75268f88c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75268de19b50>]}


============================== 23:17:59.985012 | aee59f99-5713-4bea-bb6a-d2349133bb0e ==============================
[0m23:17:59.985012 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:17:59.986541 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'target_path': 'None', 'use_colors': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'introspect': 'True', 'version_check': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'debug': 'False', 'warn_error': 'None', 'printer_width': '80', 'write_json': 'True', 'log_format': 'default', 'partial_parse': 'True', 'fail_fast': 'False'}
[0m23:18:01.043860 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:18:01.045702 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:18:01.047602 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:18:01.324493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aee59f99-5713-4bea-bb6a-d2349133bb0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75266bd78c20>]}
[0m23:18:01.415231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aee59f99-5713-4bea-bb6a-d2349133bb0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75266bd0ff50>]}
[0m23:18:01.417167 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m23:18:01.611291 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m23:18:01.922544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:18:01.924221 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:18:01.989220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aee59f99-5713-4bea-bb6a-d2349133bb0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75266bce5490>]}
[0m23:18:02.143226 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:18:02.150559 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:18:02.200771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aee59f99-5713-4bea-bb6a-d2349133bb0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75266bb21cd0>]}
[0m23:18:02.202292 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m23:18:02.203611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aee59f99-5713-4bea-bb6a-d2349133bb0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7526726062d0>]}
[0m23:18:02.208370 [info ] [MainThread]: 
[0m23:18:02.210166 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:18:02.211604 [info ] [MainThread]: 
[0m23:18:02.213486 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:18:02.220873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m23:18:02.283763 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m23:18:02.285764 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m23:18:02.287387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:04.047357 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.760 seconds
[0m23:18:04.052640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aee59f99-5713-4bea-bb6a-d2349133bb0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75266bb54590>]}
[0m23:18:04.059824 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m23:18:04.060547 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m23:18:04.061226 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m23:18:04.061867 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m23:18:04.062783 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m23:18:04.064519 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m23:18:04.066260 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m23:18:04.067963 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m23:18:04.069634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m23:18:04.071444 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m23:18:04.072854 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m23:18:04.074583 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m23:18:04.076263 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m23:18:04.077840 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m23:18:04.079195 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m23:18:04.080627 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m23:18:04.100448 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m23:18:04.105264 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m23:18:04.113200 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m23:18:04.119093 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m23:18:04.128650 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m23:18:04.129450 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m23:18:04.136631 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m23:18:04.146970 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m23:18:04.166337 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m23:18:04.169813 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m23:18:04.177266 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m23:18:04.181791 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m23:18:04.193420 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m23:18:04.195042 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m23:18:04.197424 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m23:18:04.199000 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m23:18:04.200507 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m23:18:04.202014 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m23:18:04.203584 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:18:04.205104 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m23:18:04.206842 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m23:18:04.218252 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:18:04.220280 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:18:04.577574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.369 seconds
[0m23:18:04.588512 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.52s]
[0m23:18:04.590834 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m23:18:04.592791 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m23:18:04.594532 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m23:18:04.596185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m23:18:04.597675 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m23:18:04.603335 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m23:18:04.616459 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m23:18:04.623620 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m23:18:04.641229 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m23:18:04.643949 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m23:18:05.040168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m23:18:05.045693 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.45s]
[0m23:18:05.047788 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m23:18:05.049442 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m23:18:05.050953 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m23:18:05.052519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m23:18:05.054089 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m23:18:05.062061 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m23:18:05.073858 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m23:18:05.080372 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m23:18:05.094209 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m23:18:05.096334 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m23:18:05.481314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.383 seconds
[0m23:18:05.485420 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.43s]
[0m23:18:05.487294 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m23:18:05.488857 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m23:18:05.490462 [info ] [Thread-1 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m23:18:05.492511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m23:18:05.494345 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m23:18:05.499786 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m23:18:05.513621 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m23:18:05.519071 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m23:18:05.533908 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m23:18:05.535186 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m23:18:05.645117 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.427 seconds
[0m23:18:05.649339 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.58s]
[0m23:18:05.651757 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m23:18:05.654041 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m23:18:05.655674 [info ] [Thread-2 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m23:18:05.657347 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m23:18:05.659263 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m23:18:05.664595 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m23:18:05.678171 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m23:18:05.682043 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m23:18:05.693582 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m23:18:05.694924 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m23:18:05.702232 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.499 seconds
[0m23:18:05.705631 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.63s]
[0m23:18:05.707242 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m23:18:05.708986 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m23:18:05.710656 [info ] [Thread-4 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m23:18:05.712292 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m23:18:05.714002 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m23:18:05.720246 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m23:18:05.731481 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m23:18:05.735589 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m23:18:05.746052 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.526 seconds
[0m23:18:05.751355 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m23:18:05.750430 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.68s]
[0m23:18:05.752888 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m23:18:05.754710 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m23:18:05.759863 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m23:18:05.761854 [info ] [Thread-3 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m23:18:05.763720 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m23:18:05.765597 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m23:18:05.771684 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m23:18:05.785290 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m23:18:05.789187 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m23:18:05.802003 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m23:18:05.803306 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m23:18:05.898674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.362 seconds
[0m23:18:05.903060 [info ] [Thread-1 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 0.41s]
[0m23:18:05.905287 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m23:18:05.907074 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m23:18:05.909116 [info ] [Thread-1 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m23:18:05.911256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m23:18:05.912960 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m23:18:05.919672 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m23:18:05.935021 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m23:18:05.940323 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m23:18:05.962159 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m23:18:05.964265 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m23:18:05.974609 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.278 seconds
[0m23:18:05.979957 [info ] [Thread-2 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 0.32s]
[0m23:18:05.982398 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m23:18:05.984292 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m23:18:05.986040 [info ] [Thread-2 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m23:18:05.987916 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m23:18:05.989704 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m23:18:05.997561 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m23:18:06.011164 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m23:18:06.017344 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m23:18:06.031399 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m23:18:06.033432 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m23:18:06.054329 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m23:18:06.058232 [info ] [Thread-4 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.35s]
[0m23:18:06.060495 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m23:18:06.061958 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m23:18:06.063305 [info ] [Thread-4 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m23:18:06.064733 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m23:18:06.066101 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m23:18:06.071709 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m23:18:06.083468 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m23:18:06.087508 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m23:18:06.099461 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m23:18:06.100906 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m23:18:06.129717 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.325 seconds
[0m23:18:06.133357 [info ] [Thread-3 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.37s]
[0m23:18:06.135476 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m23:18:06.137115 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m23:18:06.138555 [info ] [Thread-3 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m23:18:06.140172 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m23:18:06.141864 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m23:18:06.152573 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m23:18:06.165920 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m23:18:06.169680 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m23:18:06.182725 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m23:18:06.184025 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m23:18:06.277775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.312 seconds
[0m23:18:06.281544 [info ] [Thread-1 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.37s]
[0m23:18:06.283445 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m23:18:06.285021 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m23:18:06.286529 [info ] [Thread-1 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m23:18:06.288172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m23:18:06.289841 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m23:18:06.298126 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m23:18:06.312238 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m23:18:06.316347 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m23:18:06.329876 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m23:18:06.331076 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m23:18:06.353880 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m23:18:06.357682 [info ] [Thread-2 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.37s]
[0m23:18:06.360164 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m23:18:06.361761 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m23:18:06.363204 [info ] [Thread-2 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m23:18:06.364699 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m23:18:06.366165 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m23:18:06.372530 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m23:18:06.384734 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m23:18:06.389182 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m23:18:06.403115 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m23:18:06.404456 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m23:18:06.429902 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.328 seconds
[0m23:18:06.433520 [info ] [Thread-4 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.37s]
[0m23:18:06.435269 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m23:18:06.436802 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m23:18:06.438307 [info ] [Thread-4 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m23:18:06.439771 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m23:18:06.441338 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m23:18:06.449354 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m23:18:06.464325 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m23:18:06.468168 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m23:18:06.482913 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m23:18:06.484389 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m23:18:06.513344 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.328 seconds
[0m23:18:06.517700 [info ] [Thread-3 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.38s]
[0m23:18:06.519849 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m23:18:06.521633 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m23:18:06.523268 [info ] [Thread-3 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m23:18:06.525337 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m23:18:06.527481 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m23:18:06.537148 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m23:18:06.551914 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m23:18:06.556432 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m23:18:06.572494 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m23:18:06.573921 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m23:18:06.674570 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.342 seconds
[0m23:18:06.679511 [info ] [Thread-1 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.39s]
[0m23:18:06.682037 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m23:18:06.684319 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m23:18:06.686321 [info ] [Thread-1 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m23:18:06.688444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m23:18:06.690339 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m23:18:06.701402 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m23:18:06.730835 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m23:18:06.735147 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m23:18:06.748930 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m23:18:06.750119 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m23:18:06.821750 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.416 seconds
[0m23:18:06.826557 [info ] [Thread-2 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.46s]
[0m23:18:06.829038 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m23:18:06.831181 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m23:18:06.833286 [info ] [Thread-2 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m23:18:06.836050 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m23:18:06.838385 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m23:18:06.846714 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m23:18:06.862733 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m23:18:06.869333 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m23:18:06.883674 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m23:18:06.885732 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.310 seconds
[0m23:18:06.886736 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m23:18:06.890148 [info ] [Thread-3 (]: 18 of 24 PASS unique_core_batches_batch_id ..................................... [[32mPASS[0m in 0.36s]
[0m23:18:06.894869 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m23:18:06.896838 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m23:18:06.898406 [info ] [Thread-3 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m23:18:06.900429 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m23:18:06.902135 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m23:18:06.903900 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.418 seconds
[0m23:18:06.909850 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m23:18:06.913167 [info ] [Thread-4 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.47s]
[0m23:18:06.915926 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m23:18:06.917365 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m23:18:06.918707 [info ] [Thread-4 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m23:18:06.920309 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m23:18:06.921657 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m23:18:06.928319 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m23:18:06.930619 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m23:18:06.937905 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m23:18:06.946359 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m23:18:06.950997 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m23:18:06.954228 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m23:18:06.956837 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m23:18:06.966995 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m23:18:06.968404 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m23:18:07.046219 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.295 seconds
[0m23:18:07.051094 [info ] [Thread-1 (]: 19 of 24 PASS unique_core_materials_material_id ................................ [[32mPASS[0m in 0.36s]
[0m23:18:07.053247 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m23:18:07.054909 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m23:18:07.056285 [info ] [Thread-1 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m23:18:07.057907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m23:18:07.060047 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m23:18:07.066043 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m23:18:07.079265 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m23:18:07.083105 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m23:18:07.096836 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m23:18:07.098278 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m23:18:07.189852 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m23:18:07.193908 [info ] [Thread-2 (]: 20 of 24 PASS unique_fct_production_orders_order_id ............................ [[32mPASS[0m in 0.36s]
[0m23:18:07.195938 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m23:18:07.197501 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m23:18:07.198982 [info ] [Thread-2 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m23:18:07.201318 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m23:18:07.203080 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m23:18:07.208714 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m23:18:07.222367 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m23:18:07.227501 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m23:18:07.239450 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m23:18:07.241244 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m23:18:07.284764 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.315 seconds
[0m23:18:07.288065 [info ] [Thread-4 (]: 22 of 24 PASS unique_stg_batches_batch_id ...................................... [[32mPASS[0m in 0.37s]
[0m23:18:07.289678 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m23:18:07.313002 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.354 seconds
[0m23:18:07.317179 [info ] [Thread-3 (]: 21 of 24 PASS unique_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 0.42s]
[0m23:18:07.319007 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m23:18:07.414946 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.315 seconds
[0m23:18:07.418860 [info ] [Thread-1 (]: 23 of 24 PASS unique_stg_materials_material_id ................................. [[32mPASS[0m in 0.36s]
[0m23:18:07.420889 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m23:18:07.556784 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.314 seconds
[0m23:18:07.562439 [info ] [Thread-2 (]: 24 of 24 PASS unique_stg_production_orders_order_id ............................ [[32mPASS[0m in 0.36s]
[0m23:18:07.564601 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m23:18:07.569442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:07.571276 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m23:18:07.573023 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m23:18:08.014080 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m23:18:08.015853 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m23:18:08.476320 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m23:18:08.478210 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m23:18:08.939087 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m23:18:08.941103 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m23:18:09.407414 [info ] [MainThread]: 
[0m23:18:09.409372 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 7.19 seconds (7.19s).
[0m23:18:09.415065 [debug] [MainThread]: Command end result
[0m23:18:09.476614 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m23:18:09.488583 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m23:18:09.505202 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m23:18:09.506665 [info ] [MainThread]: 
[0m23:18:09.508679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:18:09.510226 [info ] [MainThread]: 
[0m23:18:09.511568 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m23:18:09.513573 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.692646, "process_in_blocks": "0", "process_kernel_time": 1.347968, "process_mem_max_rss": "223888", "process_out_blocks": "16", "process_user_time": 5.675866}
[0m23:18:09.515107 [debug] [MainThread]: Command `dbt test` succeeded at 23:18:09.514978 after 9.69 seconds
[0m23:18:09.516429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75268ce8eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75266bb00b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75268cd49820>]}
[0m23:18:09.517648 [debug] [MainThread]: Flushing usage events
[0m23:18:10.111975 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:32.182779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dcfd07a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dcfed83e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dcfe38e0f0>]}


============================== 12:42:32.197361 | 448acfdd-31d3-4827-9be6-ea68a71a5e77 ==============================
[0m12:42:32.197361 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:42:32.200532 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt_profiles', 'cache_selected_only': 'False', 'use_colors': 'True', 'empty': 'False', 'target_path': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'no_print': 'None', 'write_json': 'True', 'debug': 'False', 'invocation_command': 'dbt run --select staging --profiles-dir /opt/airflow/dbt_profiles', 'fail_fast': 'False'}
[0m12:42:34.050785 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:42:34.062265 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:42:34.065114 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:42:34.728101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '448acfdd-31d3-4827-9be6-ea68a71a5e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dcfcd4ac00>]}
[0m12:42:35.076328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '448acfdd-31d3-4827-9be6-ea68a71a5e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dcdb1d03b0>]}
[0m12:42:35.082015 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m12:42:35.481979 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:42:36.242308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:42:36.245750 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:42:36.417695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '448acfdd-31d3-4827-9be6-ea68a71a5e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dcdb7f8740>]}
[0m12:42:36.781526 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:42:36.795755 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:42:36.868024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '448acfdd-31d3-4827-9be6-ea68a71a5e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dcdaa92780>]}
[0m12:42:36.871552 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m12:42:36.873873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '448acfdd-31d3-4827-9be6-ea68a71a5e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dcdacc9340>]}
[0m12:42:36.878937 [info ] [MainThread]: 
[0m12:42:36.880998 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:42:36.882917 [info ] [MainThread]: 
[0m12:42:36.887312 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:42:36.899194 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m12:42:37.046160 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m12:42:37.049330 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m12:42:37.053083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:39.000515 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.947 seconds
[0m12:42:39.013161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m12:42:39.052919 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m12:42:39.055739 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m12:42:39.370921 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.312 seconds
[0m12:42:39.388833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '448acfdd-31d3-4827-9be6-ea68a71a5e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dcdae07c80>]}
[0m12:42:39.404485 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m12:42:39.406238 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m12:42:39.407729 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m12:42:39.410955 [info ] [Thread-1 (]: 1 of 3 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m12:42:39.414095 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m12:42:39.417606 [info ] [Thread-3 (]: 3 of 3 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m12:42:39.421474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m12:42:39.425179 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m12:42:39.427992 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m12:42:39.430147 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m12:42:39.432534 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m12:42:39.436429 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m12:42:39.458497 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m12:42:39.585920 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m12:42:39.595960 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m12:42:39.612735 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m12:42:39.614234 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m12:42:39.627773 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m12:42:39.883809 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m12:42:39.886426 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m12:42:39.887454 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m12:42:39.961966 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m12:42:39.967180 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m12:42:39.976876 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m12:42:39.981468 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m12:42:39.987437 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m12:42:39.999663 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:42:40.003136 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m12:42:40.006743 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:42:40.572193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m12:42:40.697588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448acfdd-31d3-4827-9be6-ea68a71a5e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dcfea76570>]}
[0m12:42:40.709821 [info ] [Thread-1 (]: 1 of 3 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 1.27s]
[0m12:42:40.721707 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m12:42:42.004995 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.005 seconds
[0m12:42:42.011540 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448acfdd-31d3-4827-9be6-ea68a71a5e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dcd9acc5f0>]}
[0m12:42:42.014101 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 2.59s]
[0m12:42:42.016722 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m12:42:42.139748 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.133 seconds
[0m12:42:42.149333 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448acfdd-31d3-4827-9be6-ea68a71a5e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dcfc05abd0>]}
[0m12:42:42.153187 [info ] [Thread-3 (]: 3 of 3 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 2.72s]
[0m12:42:42.156367 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m12:42:42.162327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:42.164853 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_batches' was left open.
[0m12:42:42.169427 [debug] [MainThread]: On model.mfg_accelerator.stg_batches: Close
[0m12:42:42.757258 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_materials' was left open.
[0m12:42:42.760340 [debug] [MainThread]: On model.mfg_accelerator.stg_materials: Close
[0m12:42:43.224656 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_production_orders' was left open.
[0m12:42:43.226685 [debug] [MainThread]: On model.mfg_accelerator.stg_production_orders: Close
[0m12:42:43.693040 [info ] [MainThread]: 
[0m12:42:43.695190 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 6.81 seconds (6.81s).
[0m12:42:43.698506 [debug] [MainThread]: Command end result
[0m12:42:43.802018 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:42:43.811587 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:42:43.833398 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m12:42:43.835852 [info ] [MainThread]: 
[0m12:42:43.838145 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:43.840044 [info ] [MainThread]: 
[0m12:42:43.841868 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:42:43.844924 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.948707, "process_in_blocks": "0", "process_kernel_time": 3.651635, "process_mem_max_rss": "219400", "process_out_blocks": "16", "process_user_time": 22.089746}
[0m12:42:43.846709 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:43.846499 after 11.95 seconds
[0m12:42:43.848453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dcfc1cd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dcfc0affe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dcfd26a5a0>]}
[0m12:42:43.850151 [debug] [MainThread]: Flushing usage events
[0m12:42:44.721416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:52.197598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509ca6f9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509ca88f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509cb38a8a0>]}


============================== 12:42:52.212286 | 8ef423b9-d658-4ebb-abed-1367ab3bb134 ==============================
[0m12:42:52.212286 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:42:52.215160 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error': 'None', 'quiet': 'False', 'target_path': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --select core --profiles-dir /opt/airflow/dbt_profiles', 'no_print': 'None', 'write_json': 'True', 'partial_parse': 'True', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'cache_selected_only': 'False'}
[0m12:42:53.485089 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:42:53.487975 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:42:53.490061 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:42:53.890517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ef423b9-d658-4ebb-abed-1367ab3bb134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509ae9e4c20>]}
[0m12:42:54.022601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ef423b9-d658-4ebb-abed-1367ab3bb134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509c90eec00>]}
[0m12:42:54.025425 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m12:42:54.299675 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:42:54.739420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:42:54.741471 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:42:54.836561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ef423b9-d658-4ebb-abed-1367ab3bb134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509a7d2dcd0>]}
[0m12:42:55.072312 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:42:55.081517 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:42:55.135430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ef423b9-d658-4ebb-abed-1367ab3bb134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509a7b103e0>]}
[0m12:42:55.138298 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m12:42:55.140347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ef423b9-d658-4ebb-abed-1367ab3bb134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509a7b50350>]}
[0m12:42:55.144665 [info ] [MainThread]: 
[0m12:42:55.146453 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:42:55.148083 [info ] [MainThread]: 
[0m12:42:55.150026 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:42:55.159821 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m12:42:55.241682 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m12:42:55.244547 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m12:42:55.246976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:55.879262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea5b625520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea5d2a8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea5b698b30>]}


============================== 12:42:55.891486 | deccf477-16bb-4f09-a145-2dbef2c7c9f3 ==============================
[0m12:42:55.891486 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:42:55.893638 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'partial_parse': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'empty': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_experimental_parser': 'False', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80'}
[0m12:42:56.999207 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:42:57.001673 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:42:57.003736 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:42:57.395856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'deccf477-16bb-4f09-a145-2dbef2c7c9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea3bd504a0>]}
[0m12:42:57.444529 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.198 seconds
[0m12:42:57.452117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m12:42:57.483066 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m12:42:57.484932 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m12:42:57.535896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'deccf477-16bb-4f09-a145-2dbef2c7c9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea39709700>]}
[0m12:42:57.539727 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m12:42:57.785939 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:42:58.101549 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.615 seconds
[0m12:42:58.113758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ef423b9-d658-4ebb-abed-1367ab3bb134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509a7f23200>]}
[0m12:42:58.127007 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.core_materials
[0m12:42:58.129971 [info ] [Thread-1 (]: 1 of 3 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m12:42:58.132657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.core_materials)
[0m12:42:58.134788 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.core_materials
[0m12:42:58.158677 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m12:42:58.175146 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.core_materials
[0m12:42:58.248124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:42:58.250284 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:42:58.374402 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m12:42:58.375845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'deccf477-16bb-4f09-a145-2dbef2c7c9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea399a3bf0>]}
[0m12:42:58.390974 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m12:42:58.393139 [debug] [Thread-1 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m12:42:58.593646 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:42:58.604432 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:42:58.652306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'deccf477-16bb-4f09-a145-2dbef2c7c9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea392dec00>]}
[0m12:42:58.654669 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m12:42:58.656702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deccf477-16bb-4f09-a145-2dbef2c7c9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea39726f00>]}
[0m12:42:58.661653 [info ] [MainThread]: 
[0m12:42:58.663937 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:42:58.665880 [info ] [MainThread]: 
[0m12:42:58.667816 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:42:58.677881 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m12:42:58.745430 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m12:42:58.747092 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m12:42:58.748847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:59.298583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.903 seconds
[0m12:42:59.366266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ef423b9-d658-4ebb-abed-1367ab3bb134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509cba76630>]}
[0m12:42:59.368582 [info ] [Thread-1 (]: 1 of 3 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 1.23s]
[0m12:42:59.372411 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.core_materials
[0m12:42:59.377036 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.core_batches
[0m12:42:59.378617 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m12:42:59.380628 [info ] [Thread-3 (]: 2 of 3 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m12:42:59.382755 [info ] [Thread-4 (]: 3 of 3 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m12:42:59.385353 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_batches'
[0m12:42:59.389146 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.fct_production_orders'
[0m12:42:59.392099 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.core_batches
[0m12:42:59.394545 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m12:42:59.402184 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m12:42:59.414385 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m12:42:59.427537 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.core_batches
[0m12:42:59.429257 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m12:42:59.437162 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m12:42:59.447362 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m12:42:59.460767 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m12:42:59.462980 [debug] [Thread-3 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m12:42:59.468142 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m12:42:59.470111 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:42:59.473315 [debug] [Thread-4 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m12:42:59.484389 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:43:00.460855 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.712 seconds
[0m12:43:00.466653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m12:43:00.488177 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m12:43:00.490256 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m12:43:00.792221 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.300 seconds
[0m12:43:00.801119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deccf477-16bb-4f09-a145-2dbef2c7c9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea5ce85970>]}
[0m12:43:00.811366 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m12:43:00.812195 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m12:43:00.813028 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m12:43:00.814917 [info ] [Thread-1 (]: 1 of 8 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m12:43:00.817149 [info ] [Thread-2 (]: 2 of 8 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m12:43:00.819434 [info ] [Thread-3 (]: 3 of 8 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m12:43:00.822290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m12:43:00.824482 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m12:43:00.826643 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m12:43:00.828686 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m12:43:00.830495 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m12:43:00.832523 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m12:43:00.847210 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m12:43:00.933120 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m12:43:00.939151 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m12:43:00.949860 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m12:43:00.951123 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m12:43:00.963401 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m12:43:01.025536 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m12:43:01.040853 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m12:43:01.041504 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m12:43:01.051067 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m12:43:01.054864 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m12:43:01.055770 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m12:43:01.057909 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m12:43:01.060049 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m12:43:01.061843 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:43:01.063852 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m12:43:01.075817 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:43:01.493572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m12:43:01.539087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deccf477-16bb-4f09-a145-2dbef2c7c9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea384601a0>]}
[0m12:43:01.542011 [info ] [Thread-1 (]: 1 of 8 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 0.71s]
[0m12:43:01.544692 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m12:43:01.693307 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.223 seconds
[0m12:43:01.767573 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ef423b9-d658-4ebb-abed-1367ab3bb134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509c90f3c50>]}
[0m12:43:01.844084 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.360 seconds
[0m12:43:01.883976 [info ] [Thread-3 (]: 2 of 3 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 2.38s]
[0m12:43:01.904063 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ef423b9-d658-4ebb-abed-1367ab3bb134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509ca84eb10>]}
[0m12:43:01.907523 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.core_batches
[0m12:43:01.910679 [info ] [Thread-4 (]: 3 of 3 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 2.52s]
[0m12:43:01.914975 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m12:43:01.921068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:01.923955 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_materials' was left open.
[0m12:43:01.926111 [debug] [MainThread]: On model.mfg_accelerator.core_materials: Close
[0m12:43:02.411526 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m12:43:02.413186 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m12:43:02.878031 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m12:43:02.880084 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m12:43:03.005707 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.930 seconds
[0m12:43:03.011278 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deccf477-16bb-4f09-a145-2dbef2c7c9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea383563c0>]}
[0m12:43:03.013495 [info ] [Thread-3 (]: 3 of 8 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 2.18s]
[0m12:43:03.016004 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m12:43:03.054832 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.993 seconds
[0m12:43:03.059828 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deccf477-16bb-4f09-a145-2dbef2c7c9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea396ed820>]}
[0m12:43:03.061964 [info ] [Thread-2 (]: 2 of 8 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 2.24s]
[0m12:43:03.064809 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m12:43:03.067733 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.core_materials
[0m12:43:03.070058 [info ] [Thread-4 (]: 4 of 8 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m12:43:03.072982 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_materials'
[0m12:43:03.075055 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.core_materials
[0m12:43:03.084003 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m12:43:03.097836 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.core_materials
[0m12:43:03.140489 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m12:43:03.158318 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m12:43:03.160517 [debug] [Thread-4 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m12:43:03.162374 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:43:03.338820 [info ] [MainThread]: 
[0m12:43:03.340957 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 8.19 seconds (8.19s).
[0m12:43:03.343859 [debug] [MainThread]: Command end result
[0m12:43:03.432138 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:43:03.442132 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:43:03.458858 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m12:43:03.460444 [info ] [MainThread]: 
[0m12:43:03.462157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:03.463654 [info ] [MainThread]: 
[0m12:43:03.465329 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:43:03.467896 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.454006, "process_in_blocks": "0", "process_kernel_time": 1.432283, "process_mem_max_rss": "219108", "process_out_blocks": "16", "process_user_time": 8.109549}
[0m12:43:03.470025 [debug] [MainThread]: Command `dbt run` succeeded at 12:43:03.469732 after 11.46 seconds
[0m12:43:03.472587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509cbd881d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509c8594ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509c92edfa0>]}
[0m12:43:03.474239 [debug] [MainThread]: Flushing usage events
[0m12:43:04.143708 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:05.144936 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.983 seconds
[0m12:43:05.150256 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deccf477-16bb-4f09-a145-2dbef2c7c9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea38903680>]}
[0m12:43:05.152878 [info ] [Thread-4 (]: 4 of 8 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 2.08s]
[0m12:43:05.155612 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.core_materials
[0m12:43:05.158789 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.core_batches
[0m12:43:05.159699 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m12:43:05.161610 [info ] [Thread-3 (]: 5 of 8 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m12:43:05.164058 [info ] [Thread-2 (]: 6 of 8 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m12:43:05.166404 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_production_orders, now model.mfg_accelerator.core_batches)
[0m12:43:05.168554 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_materials, now model.mfg_accelerator.fct_production_orders)
[0m12:43:05.170824 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.core_batches
[0m12:43:05.173302 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m12:43:05.179379 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m12:43:05.186026 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m12:43:05.197072 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.core_batches
[0m12:43:05.199141 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m12:43:05.204240 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m12:43:05.210956 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m12:43:05.226577 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m12:43:05.233852 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m12:43:05.235512 [debug] [Thread-3 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m12:43:05.238624 [debug] [Thread-2 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m12:43:06.354629 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.115 seconds
[0m12:43:06.362632 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deccf477-16bb-4f09-a145-2dbef2c7c9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea392fedb0>]}
[0m12:43:06.365717 [info ] [Thread-3 (]: 5 of 8 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 1.20s]
[0m12:43:06.369017 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.core_batches
[0m12:43:06.977640 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.735 seconds
[0m12:43:06.983633 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deccf477-16bb-4f09-a145-2dbef2c7c9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea3839ad50>]}
[0m12:43:06.986416 [info ] [Thread-2 (]: 6 of 8 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 1.82s]
[0m12:43:06.989187 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m12:43:06.992383 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m12:43:06.993555 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m12:43:06.995519 [info ] [Thread-4 (]: 7 of 8 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m12:43:06.997764 [info ] [Thread-1 (]: 8 of 8 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m12:43:07.000120 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.core_materials, now model.mfg_accelerator.mfg_ml_features_orders)
[0m12:43:07.002227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_batches, now model.mfg_accelerator.mfg_plant_daily_kpis)
[0m12:43:07.004287 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m12:43:07.006051 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m12:43:07.013787 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m12:43:07.024863 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m12:43:07.034985 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m12:43:07.042772 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m12:43:07.048947 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m12:43:07.057802 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m12:43:07.082243 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m12:43:07.084692 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m12:43:07.086870 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m12:43:07.089381 [debug] [Thread-4 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m12:43:08.481415 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.387 seconds
[0m12:43:08.487463 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deccf477-16bb-4f09-a145-2dbef2c7c9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea392fdb20>]}
[0m12:43:08.489962 [info ] [Thread-4 (]: 7 of 8 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 1.49s]
[0m12:43:08.492362 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m12:43:08.709429 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.618 seconds
[0m12:43:08.715876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deccf477-16bb-4f09-a145-2dbef2c7c9f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea392fffb0>]}
[0m12:43:08.718236 [info ] [Thread-1 (]: 8 of 8 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 1.71s]
[0m12:43:08.721067 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m12:43:08.726738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:08.729194 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m12:43:08.731162 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m12:43:09.185723 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m12:43:09.188997 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m12:43:09.685015 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m12:43:09.688236 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m12:43:10.148985 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m12:43:10.150733 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m12:43:10.329558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abfbf6373b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abfc253f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abfc081c5c0>]}


============================== 12:43:10.343157 | 9642ef92-a9d9-4d02-af87-6fefd29b3515 ==============================
[0m12:43:10.343157 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:43:10.356654 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'introspect': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'write_json': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'static_parser': 'True', 'empty': 'False', 'debug': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select marts --profiles-dir /opt/airflow/dbt_profiles', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'printer_width': '80'}
[0m12:43:10.656868 [info ] [MainThread]: 
[0m12:43:10.659162 [info ] [MainThread]: Finished running 5 table models, 3 view models in 0 hours 0 minutes and 11.99 seconds (11.99s).
[0m12:43:10.664068 [debug] [MainThread]: Command end result
[0m12:43:10.758164 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:43:10.767628 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:43:10.791203 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m12:43:10.793270 [info ] [MainThread]: 
[0m12:43:10.795267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:10.797127 [info ] [MainThread]: 
[0m12:43:10.799167 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m12:43:10.804420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.064095, "process_in_blocks": "0", "process_kernel_time": 1.533889, "process_mem_max_rss": "221676", "process_out_blocks": "16", "process_user_time": 8.275678}
[0m12:43:10.807282 [debug] [MainThread]: Command `dbt run` succeeded at 12:43:10.807024 after 15.07 seconds
[0m12:43:10.808948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea39b03500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea5bc80a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ea5bc80110>]}
[0m12:43:10.810858 [debug] [MainThread]: Flushing usage events
[0m12:43:11.515669 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:43:11.517837 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:43:11.519966 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:43:11.572080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:11.908843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9642ef92-a9d9-4d02-af87-6fefd29b3515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf9fdda810>]}
[0m12:43:12.045189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9642ef92-a9d9-4d02-af87-6fefd29b3515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abfbf32ccb0>]}
[0m12:43:12.047811 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m12:43:12.357619 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:43:12.847693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:12.849878 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:12.949464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9642ef92-a9d9-4d02-af87-6fefd29b3515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf9e0f9490>]}
[0m12:43:13.184863 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:43:13.196582 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:43:13.252734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9642ef92-a9d9-4d02-af87-6fefd29b3515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf9dedaf60>]}
[0m12:43:13.255106 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m12:43:13.257192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9642ef92-a9d9-4d02-af87-6fefd29b3515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf9fdd9370>]}
[0m12:43:13.261590 [info ] [MainThread]: 
[0m12:43:13.263902 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:43:13.266219 [info ] [MainThread]: 
[0m12:43:13.270021 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:43:13.281020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m12:43:13.377791 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m12:43:13.380175 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m12:43:13.382187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:15.189172 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.807 seconds
[0m12:43:15.200291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m12:43:15.227319 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m12:43:15.229346 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m12:43:15.553942 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.322 seconds
[0m12:43:15.567853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9642ef92-a9d9-4d02-af87-6fefd29b3515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf9e16c050>]}
[0m12:43:15.586847 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m12:43:15.588554 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m12:43:15.592644 [info ] [Thread-1 (]: 1 of 2 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m12:43:15.595946 [info ] [Thread-2 (]: 2 of 2 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m12:43:15.608825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.mfg_ml_features_orders)
[0m12:43:15.614995 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.mfg_plant_daily_kpis'
[0m12:43:15.617863 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m12:43:15.624829 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m12:43:15.661738 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m12:43:15.880866 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m12:43:15.927341 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m12:43:15.939808 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m12:43:16.148426 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m12:43:16.149342 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m12:43:16.177234 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m12:43:16.181426 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m12:43:16.183835 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m12:43:16.187270 [debug] [Thread-2 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m12:43:16.194057 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:43:17.401331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.211 seconds
[0m12:43:17.470932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9642ef92-a9d9-4d02-af87-6fefd29b3515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf9d0545f0>]}
[0m12:43:17.474572 [info ] [Thread-1 (]: 1 of 2 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 1.86s]
[0m12:43:17.478026 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m12:43:18.401642 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.208 seconds
[0m12:43:18.408460 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9642ef92-a9d9-4d02-af87-6fefd29b3515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf9e255250>]}
[0m12:43:18.410749 [info ] [Thread-2 (]: 2 of 2 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 2.79s]
[0m12:43:18.413264 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m12:43:18.418760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:18.421235 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m12:43:18.423506 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m12:43:18.425747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716ec3376120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716ec2e97740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716ec2e4af30>]}


============================== 12:43:18.438346 | 1cb58f7c-c52e-4762-ada8-6c21305482f0 ==============================
[0m12:43:18.438346 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:43:18.440620 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'partial_parse': 'True', 'printer_width': '80', 'no_print': 'None', 'empty': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/opt/airflow/dbt_profiles', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'quiet': 'False', 'warn_error': 'None', 'use_colors': 'True', 'debug': 'False', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'introspect': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:43:18.882246 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m12:43:18.884108 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m12:43:19.388205 [info ] [MainThread]: 
[0m12:43:19.390269 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.12 seconds (6.12s).
[0m12:43:19.393884 [debug] [MainThread]: Command end result
[0m12:43:19.512346 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:43:19.526396 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:43:19.549006 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m12:43:19.550966 [info ] [MainThread]: 
[0m12:43:19.553392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:19.555664 [info ] [MainThread]: 
[0m12:43:19.558270 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:43:19.561429 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.369645, "process_in_blocks": "0", "process_kernel_time": 1.415927, "process_mem_max_rss": "217436", "process_out_blocks": "16", "process_user_time": 7.526139}
[0m12:43:19.563958 [debug] [MainThread]: Command `dbt run` succeeded at 12:43:19.563602 after 9.37 seconds
[0m12:43:19.566331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abfc083fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abfc0878b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abf9debec00>]}
[0m12:43:19.568548 [debug] [MainThread]: Flushing usage events
[0m12:43:19.775874 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:43:19.779474 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:43:19.782155 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:43:20.193933 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:20.239379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cb58f7c-c52e-4762-ada8-6c21305482f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716ea57d0440>]}
[0m12:43:20.474714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cb58f7c-c52e-4762-ada8-6c21305482f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716ea5295be0>]}
[0m12:43:20.478743 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m12:43:20.975374 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:43:21.622966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:21.625475 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:21.746798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cb58f7c-c52e-4762-ada8-6c21305482f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716ea4a91670>]}
[0m12:43:22.309314 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:43:22.322574 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:43:22.426399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cb58f7c-c52e-4762-ada8-6c21305482f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716ea4717560>]}
[0m12:43:22.428871 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m12:43:22.431179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cb58f7c-c52e-4762-ada8-6c21305482f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716ea4833b90>]}
[0m12:43:22.440900 [info ] [MainThread]: 
[0m12:43:22.443773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:43:22.446333 [info ] [MainThread]: 
[0m12:43:22.449363 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:43:22.466723 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m12:43:22.594886 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m12:43:22.599106 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m12:43:22.601672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:24.387560 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.786 seconds
[0m12:43:24.395522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cb58f7c-c52e-4762-ada8-6c21305482f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716ea46f8740>]}
[0m12:43:24.405250 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m12:43:24.406233 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m12:43:24.407040 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m12:43:24.407876 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m12:43:24.409185 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m12:43:24.411267 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m12:43:24.413323 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m12:43:24.415447 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m12:43:24.417622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m12:43:24.420063 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m12:43:24.422342 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m12:43:24.424440 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m12:43:24.426538 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m12:43:24.428575 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m12:43:24.430577 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m12:43:24.432677 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m12:43:24.466885 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m12:43:24.470728 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m12:43:24.478763 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m12:43:24.486637 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m12:43:24.497046 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m12:43:24.498886 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m12:43:24.506637 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m12:43:24.520871 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m12:43:24.571892 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m12:43:24.576549 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m12:43:24.578273 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m12:43:24.584718 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m12:43:24.597595 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m12:43:24.599499 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m12:43:24.601499 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m12:43:24.603553 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m12:43:24.604975 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m12:43:24.606601 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m12:43:24.608559 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:43:24.610509 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m12:43:24.612438 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m12:43:24.614439 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:43:24.624635 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:43:24.987459 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.360 seconds
[0m12:43:25.013792 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.60s]
[0m12:43:25.017116 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m12:43:25.019845 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m12:43:25.022455 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m12:43:25.024503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m12:43:25.026443 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m12:43:25.036946 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m12:43:25.053578 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m12:43:25.059399 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m12:43:25.076478 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m12:43:25.078184 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m12:43:25.385105 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.305 seconds
[0m12:43:25.390627 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.37s]
[0m12:43:25.393076 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m12:43:25.394869 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m12:43:25.396554 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m12:43:25.398467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m12:43:25.400250 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m12:43:25.408171 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m12:43:25.424661 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m12:43:25.431459 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m12:43:25.449349 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m12:43:25.451154 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m12:43:25.825339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.372 seconds
[0m12:43:25.832921 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.43s]
[0m12:43:25.836346 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m12:43:25.838544 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m12:43:25.840546 [info ] [Thread-1 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m12:43:25.842825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m12:43:25.845197 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m12:43:25.863450 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m12:43:25.876894 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.252 seconds
[0m12:43:25.879742 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.271 seconds
[0m12:43:25.891603 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.47s]
[0m12:43:25.901010 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.48s]
[0m12:43:25.905052 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m12:43:25.909162 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m12:43:25.911057 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m12:43:25.913237 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m12:43:25.916084 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m12:43:25.931777 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m12:43:25.933986 [info ] [Thread-3 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m12:43:25.937722 [info ] [Thread-4 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m12:43:25.941881 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.327 seconds
[0m12:43:25.946224 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m12:43:25.949592 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m12:43:25.960242 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.54s]
[0m12:43:25.963588 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m12:43:25.967468 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m12:43:25.968917 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m12:43:25.974832 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m12:43:25.994123 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m12:43:25.996183 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m12:43:26.007346 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m12:43:26.009528 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m12:43:26.019670 [info ] [Thread-2 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m12:43:26.023204 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m12:43:26.025959 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m12:43:26.028688 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m12:43:26.036569 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m12:43:26.043101 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m12:43:26.050018 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m12:43:26.059281 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m12:43:26.083052 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m12:43:26.085197 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m12:43:26.089041 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m12:43:26.090886 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m12:43:26.092736 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m12:43:26.104099 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m12:43:26.126549 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m12:43:26.128519 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m12:43:26.365379 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.351 seconds
[0m12:43:26.371540 [info ] [Thread-1 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 0.53s]
[0m12:43:26.374517 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m12:43:26.376525 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m12:43:26.378512 [info ] [Thread-1 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m12:43:26.380893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m12:43:26.383382 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.289 seconds
[0m12:43:26.385204 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m12:43:26.390845 [info ] [Thread-3 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 0.44s]
[0m12:43:26.400230 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m12:43:26.402042 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m12:43:26.405930 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m12:43:26.408144 [info ] [Thread-3 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m12:43:26.410494 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m12:43:26.412571 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m12:43:26.422196 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m12:43:26.425086 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m12:43:26.434422 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m12:43:26.439034 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m12:43:26.445633 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m12:43:26.456705 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m12:43:26.458831 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m12:43:26.460178 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m12:43:26.462365 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m12:43:26.489127 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.383 seconds
[0m12:43:26.494551 [info ] [Thread-4 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.55s]
[0m12:43:26.496774 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m12:43:26.498569 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m12:43:26.500181 [info ] [Thread-4 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m12:43:26.502409 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m12:43:26.504951 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m12:43:26.513524 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m12:43:26.530400 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m12:43:26.539607 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m12:43:26.556308 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m12:43:26.558059 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m12:43:26.643374 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m12:43:26.648510 [info ] [Thread-2 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.63s]
[0m12:43:26.650951 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m12:43:26.653058 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m12:43:26.655455 [info ] [Thread-2 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m12:43:26.657835 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m12:43:26.659872 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m12:43:26.676276 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m12:43:26.696046 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m12:43:26.702799 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m12:43:26.721454 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m12:43:26.723913 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m12:43:26.795123 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.328 seconds
[0m12:43:26.800454 [info ] [Thread-3 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.39s]
[0m12:43:26.803601 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m12:43:26.805745 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m12:43:26.807753 [info ] [Thread-3 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m12:43:26.809795 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m12:43:26.811746 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m12:43:26.824162 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m12:43:26.842279 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m12:43:26.848339 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m12:43:26.873793 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m12:43:26.875846 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m12:43:26.901338 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.341 seconds
[0m12:43:26.906885 [info ] [Thread-4 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.40s]
[0m12:43:26.909557 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m12:43:26.911485 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m12:43:26.913380 [info ] [Thread-4 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m12:43:26.915615 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m12:43:26.917649 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m12:43:26.928352 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m12:43:26.944943 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m12:43:26.955117 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m12:43:26.972599 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m12:43:26.974686 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m12:43:26.998386 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m12:43:27.006576 [info ] [Thread-1 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.63s]
[0m12:43:27.010552 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m12:43:27.013031 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m12:43:27.015752 [info ] [Thread-1 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m12:43:27.018853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m12:43:27.021937 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m12:43:27.037078 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m12:43:27.059060 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m12:43:27.069814 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m12:43:27.072326 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.346 seconds
[0m12:43:27.080694 [info ] [Thread-2 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.42s]
[0m12:43:27.084200 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m12:43:27.087030 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m12:43:27.089428 [info ] [Thread-2 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m12:43:27.092503 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m12:43:27.094833 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m12:43:27.096476 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m12:43:27.098419 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m12:43:27.113114 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m12:43:27.131048 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m12:43:27.137716 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m12:43:27.152877 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m12:43:27.155290 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m12:43:27.199036 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.321 seconds
[0m12:43:27.205206 [info ] [Thread-3 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.40s]
[0m12:43:27.208191 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m12:43:27.210353 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m12:43:27.212154 [info ] [Thread-3 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m12:43:27.214256 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m12:43:27.216008 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m12:43:27.224753 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m12:43:27.239978 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m12:43:27.245998 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m12:43:27.264590 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m12:43:27.266995 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m12:43:27.342711 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.366 seconds
[0m12:43:27.348451 [info ] [Thread-4 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.43s]
[0m12:43:27.351336 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m12:43:27.353815 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m12:43:27.356344 [info ] [Thread-4 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m12:43:27.358909 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m12:43:27.361421 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m12:43:27.370897 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m12:43:27.389689 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m12:43:27.396893 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m12:43:27.417110 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m12:43:27.419332 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m12:43:27.483567 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.326 seconds
[0m12:43:27.489070 [info ] [Thread-2 (]: 18 of 24 PASS unique_core_batches_batch_id ..................................... [[32mPASS[0m in 0.40s]
[0m12:43:27.491642 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m12:43:27.493975 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m12:43:27.496260 [info ] [Thread-2 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m12:43:27.498553 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m12:43:27.500592 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m12:43:27.510863 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m12:43:27.528608 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m12:43:27.540903 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m12:43:27.560179 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m12:43:27.562245 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m12:43:27.606045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.491 seconds
[0m12:43:27.611721 [info ] [Thread-1 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.59s]
[0m12:43:27.614551 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m12:43:27.616870 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m12:43:27.620222 [info ] [Thread-1 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m12:43:27.622840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m12:43:27.626368 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.357 seconds
[0m12:43:27.627652 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m12:43:27.633378 [info ] [Thread-3 (]: 19 of 24 PASS unique_core_materials_material_id ................................ [[32mPASS[0m in 0.42s]
[0m12:43:27.643743 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m12:43:27.646256 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m12:43:27.649623 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m12:43:27.651678 [info ] [Thread-3 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m12:43:27.654827 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m12:43:27.656942 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m12:43:27.648734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd51a67a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd519eda540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd519e20bf0>]}


============================== 12:43:27.664617 | 60862b63-0a1e-4f84-8fe3-d2ce9daa9d58 ==============================
[0m12:43:27.664617 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:43:27.667310 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'cache_selected_only': 'False', 'partial_parse': 'True', 'write_json': 'True', 'no_print': 'None', 'quiet': 'False', 'version_check': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'fail_fast': 'False', 'log_format': 'default', 'empty': 'None', 'printer_width': '80', 'use_colors': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles'}
[0m12:43:27.667930 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m12:43:27.671612 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m12:43:27.680869 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m12:43:27.691612 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m12:43:27.698420 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m12:43:27.702608 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m12:43:27.705329 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m12:43:27.714231 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m12:43:27.716426 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m12:43:27.719328 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.297 seconds
[0m12:43:27.728157 [info ] [Thread-4 (]: 20 of 24 PASS unique_fct_production_orders_order_id ............................ [[32mPASS[0m in 0.37s]
[0m12:43:27.730850 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m12:43:27.732537 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m12:43:27.734384 [info ] [Thread-4 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m12:43:27.736695 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m12:43:27.738853 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m12:43:27.746887 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m12:43:27.762404 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m12:43:27.768450 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m12:43:27.794954 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m12:43:27.807062 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m12:43:27.955054 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.391 seconds
[0m12:43:27.977713 [info ] [Thread-2 (]: 21 of 24 PASS unique_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 0.47s]
[0m12:43:27.984065 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m12:43:28.019850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.312 seconds
[0m12:43:28.028069 [info ] [Thread-1 (]: 22 of 24 PASS unique_stg_batches_batch_id ...................................... [[32mPASS[0m in 0.40s]
[0m12:43:28.031814 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m12:43:28.040941 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.320 seconds
[0m12:43:28.053240 [info ] [Thread-3 (]: 23 of 24 PASS unique_stg_materials_material_id ................................. [[32mPASS[0m in 0.40s]
[0m12:43:28.057633 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m12:43:28.144249 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.328 seconds
[0m12:43:28.155693 [info ] [Thread-4 (]: 24 of 24 PASS unique_stg_production_orders_order_id ............................ [[32mPASS[0m in 0.42s]
[0m12:43:28.159304 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m12:43:28.166696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:28.169127 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m12:43:28.172674 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m12:43:28.667231 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m12:43:28.669601 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m12:43:28.994131 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:43:28.996341 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:43:28.998320 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:43:29.122695 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m12:43:29.124997 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m12:43:29.467381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60862b63-0a1e-4f84-8fe3-d2ce9daa9d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd4fd038080>]}
[0m12:43:29.624881 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m12:43:29.627517 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m12:43:29.773676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60862b63-0a1e-4f84-8fe3-d2ce9daa9d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd4fc8d5e20>]}
[0m12:43:29.776910 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m12:43:30.143104 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:43:30.163451 [info ] [MainThread]: 
[0m12:43:30.166909 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 7.71 seconds (7.71s).
[0m12:43:30.178933 [debug] [MainThread]: Command end result
[0m12:43:30.277321 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:43:30.286768 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:43:30.312270 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m12:43:30.315650 [info ] [MainThread]: 
[0m12:43:30.320850 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:30.325858 [info ] [MainThread]: 
[0m12:43:30.328711 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m12:43:30.332296 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.046442, "process_in_blocks": "0", "process_kernel_time": 1.862968, "process_mem_max_rss": "224192", "process_out_blocks": "16", "process_user_time": 10.232059}
[0m12:43:30.334507 [debug] [MainThread]: Command `dbt test` succeeded at 12:43:30.334279 after 12.05 seconds
[0m12:43:30.336355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716ec1fba570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716ea4833fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716ec1f4d100>]}
[0m12:43:30.338644 [debug] [MainThread]: Flushing usage events
[0m12:43:30.615653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:30.617637 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:30.721804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60862b63-0a1e-4f84-8fe3-d2ce9daa9d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd4fe9e40b0>]}
[0m12:43:30.965963 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:43:30.969244 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:30.976741 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:43:31.062995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60862b63-0a1e-4f84-8fe3-d2ce9daa9d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd4f79b2ea0>]}
[0m12:43:31.065385 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m12:43:31.067535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60862b63-0a1e-4f84-8fe3-d2ce9daa9d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd4f7d31280>]}
[0m12:43:31.076884 [info ] [MainThread]: 
[0m12:43:31.079098 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:43:31.081112 [info ] [MainThread]: 
[0m12:43:31.083286 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:43:31.093481 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m12:43:31.191744 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m12:43:31.193532 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m12:43:31.195159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:32.581522 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.386 seconds
[0m12:43:32.587511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60862b63-0a1e-4f84-8fe3-d2ce9daa9d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd4fc465ac0>]}
[0m12:43:32.595374 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m12:43:32.596027 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m12:43:32.596619 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m12:43:32.597259 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m12:43:32.598318 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m12:43:32.600530 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m12:43:32.602793 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m12:43:32.604732 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m12:43:32.607047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m12:43:32.609548 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m12:43:32.611735 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m12:43:32.613516 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m12:43:32.615111 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m12:43:32.616867 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m12:43:32.618393 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m12:43:32.619995 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m12:43:32.650124 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m12:43:32.652212 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m12:43:32.659268 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m12:43:32.665008 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m12:43:32.676890 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m12:43:32.678231 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m12:43:32.685224 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m12:43:32.695679 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m12:43:32.717386 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m12:43:32.722037 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m12:43:32.727109 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m12:43:32.732046 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m12:43:32.745149 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m12:43:32.746840 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m12:43:32.748721 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m12:43:32.750382 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m12:43:32.752818 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m12:43:32.753755 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m12:43:32.756165 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m12:43:32.760224 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m12:43:32.761885 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:43:32.763369 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:43:32.764784 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:43:33.078155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.320 seconds
[0m12:43:33.113871 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.51s]
[0m12:43:33.117331 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m12:43:33.119726 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m12:43:33.123424 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m12:43:33.125889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m12:43:33.128081 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m12:43:33.140975 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m12:43:33.159303 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m12:43:33.167680 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m12:43:33.184881 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m12:43:33.186385 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m12:43:33.457292 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.268 seconds
[0m12:43:33.461671 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.34s]
[0m12:43:33.463855 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m12:43:33.465638 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m12:43:33.467355 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m12:43:33.469225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m12:43:33.471013 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m12:43:33.477839 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m12:43:33.491276 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m12:43:33.496094 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m12:43:33.510907 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m12:43:33.512541 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m12:43:33.791123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.277 seconds
[0m12:43:33.797446 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.33s]
[0m12:43:33.800505 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m12:43:33.802794 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m12:43:33.805380 [info ] [Thread-1 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m12:43:33.807979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m12:43:33.809821 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m12:43:33.817837 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m12:43:33.835628 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m12:43:33.846001 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m12:43:33.863295 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m12:43:33.865211 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m12:43:33.994343 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.232 seconds
[0m12:43:33.998831 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.39s]
[0m12:43:34.000921 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m12:43:34.002783 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m12:43:34.005219 [info ] [Thread-3 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m12:43:34.007567 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m12:43:34.009745 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m12:43:34.018159 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m12:43:34.034781 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m12:43:34.043023 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m12:43:34.060033 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m12:43:34.074072 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m12:43:34.159952 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.293 seconds
[0m12:43:34.164477 [info ] [Thread-1 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 0.36s]
[0m12:43:34.166974 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m12:43:34.168758 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m12:43:34.170954 [info ] [Thread-1 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m12:43:34.173208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m12:43:34.174927 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m12:43:34.182600 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m12:43:34.200660 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m12:43:34.207117 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m12:43:34.209282 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.446 seconds
[0m12:43:34.214955 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.60s]
[0m12:43:34.218219 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.453 seconds
[0m12:43:34.220325 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m12:43:34.225275 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.62s]
[0m12:43:34.227815 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m12:43:34.230047 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m12:43:34.231639 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m12:43:34.233699 [info ] [Thread-4 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m12:43:34.235575 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m12:43:34.237589 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m12:43:34.239790 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m12:43:34.241697 [info ] [Thread-2 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m12:43:34.246404 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m12:43:34.248295 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m12:43:34.256655 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m12:43:34.258439 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m12:43:34.267558 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m12:43:34.275650 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m12:43:34.276833 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m12:43:34.282055 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m12:43:34.302123 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m12:43:34.314407 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m12:43:34.316203 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m12:43:34.318147 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m12:43:34.320759 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m12:43:34.331528 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.255 seconds
[0m12:43:34.336160 [info ] [Thread-3 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 0.33s]
[0m12:43:34.339415 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m12:43:34.341384 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m12:43:34.343355 [info ] [Thread-3 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m12:43:34.345994 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m12:43:34.348339 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m12:43:34.358817 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m12:43:34.376342 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m12:43:34.386582 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m12:43:34.406408 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m12:43:34.408674 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m12:43:34.598418 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.272 seconds
[0m12:43:34.599851 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.277 seconds
[0m12:43:34.604762 [info ] [Thread-2 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.36s]
[0m12:43:34.609861 [info ] [Thread-4 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.37s]
[0m12:43:34.612300 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m12:43:34.614593 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m12:43:34.616762 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m12:43:34.618965 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m12:43:34.621283 [info ] [Thread-2 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m12:43:34.623724 [info ] [Thread-4 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m12:43:34.625899 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m12:43:34.628050 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m12:43:34.630393 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m12:43:34.632495 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m12:43:34.641678 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m12:43:34.657524 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m12:43:34.671474 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m12:43:34.672503 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m12:43:34.678141 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m12:43:34.683671 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m12:43:34.697900 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m12:43:34.699739 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m12:43:34.701631 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m12:43:34.703993 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m12:43:34.775468 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.365 seconds
[0m12:43:34.776843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m12:43:34.781500 [info ] [Thread-3 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.44s]
[0m12:43:34.786649 [info ] [Thread-1 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.61s]
[0m12:43:34.789513 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m12:43:34.792126 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m12:43:34.794368 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m12:43:34.796376 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m12:43:34.798480 [info ] [Thread-3 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m12:43:34.800616 [info ] [Thread-1 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m12:43:34.802725 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m12:43:34.806053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m12:43:34.808817 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m12:43:34.810957 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m12:43:34.822588 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m12:43:34.831503 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m12:43:34.845878 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m12:43:34.846649 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m12:43:34.852107 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m12:43:34.859084 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m12:43:34.873391 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m12:43:34.875812 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m12:43:34.877508 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m12:43:34.879558 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m12:43:34.982722 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.274 seconds
[0m12:43:34.989451 [info ] [Thread-4 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.36s]
[0m12:43:34.992594 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m12:43:34.994845 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m12:43:34.996909 [info ] [Thread-4 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m12:43:34.999102 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m12:43:35.001368 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m12:43:35.019713 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m12:43:35.041478 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m12:43:35.049496 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m12:43:35.053058 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.346 seconds
[0m12:43:35.060377 [info ] [Thread-2 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.43s]
[0m12:43:35.063307 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m12:43:35.066269 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m12:43:35.068832 [info ] [Thread-2 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m12:43:35.073675 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m12:43:35.076218 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m12:43:35.078179 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m12:43:35.080689 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m12:43:35.097744 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m12:43:35.120111 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m12:43:35.128531 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m12:43:35.131548 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m12:43:35.140268 [info ] [Thread-3 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.34s]
[0m12:43:35.142832 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m12:43:35.145029 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m12:43:35.146797 [info ] [Thread-3 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m12:43:35.148662 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m12:43:35.150628 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m12:43:35.160328 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m12:43:35.162795 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m12:43:35.164440 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m12:43:35.179701 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m12:43:35.185618 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m12:43:35.201869 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m12:43:35.204290 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m12:43:35.285079 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m12:43:35.295609 [info ] [Thread-1 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.49s]
[0m12:43:35.306454 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m12:43:35.310150 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m12:43:35.312766 [info ] [Thread-1 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m12:43:35.315652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m12:43:35.318253 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m12:43:35.329293 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m12:43:35.346879 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m12:43:35.353871 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m12:43:35.373850 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m12:43:35.376474 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m12:43:35.416185 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.315 seconds
[0m12:43:35.423568 [info ] [Thread-4 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.42s]
[0m12:43:35.426678 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m12:43:35.429909 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m12:43:35.432432 [info ] [Thread-4 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m12:43:35.436416 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.269 seconds
[0m12:43:35.438925 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m12:43:35.447670 [info ] [Thread-2 (]: 18 of 24 PASS unique_core_batches_batch_id ..................................... [[32mPASS[0m in 0.37s]
[0m12:43:35.449781 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m12:43:35.454904 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.249 seconds
[0m12:43:35.456721 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m12:43:35.471268 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m12:43:35.477697 [info ] [Thread-3 (]: 19 of 24 PASS unique_core_materials_material_id ................................ [[32mPASS[0m in 0.33s]
[0m12:43:35.480798 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m12:43:35.485634 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m12:43:35.488147 [info ] [Thread-2 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m12:43:35.492332 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m12:43:35.495220 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m12:43:35.498431 [info ] [Thread-3 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m12:43:35.501014 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m12:43:35.504307 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m12:43:35.505555 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m12:43:35.514038 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m12:43:35.515803 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m12:43:35.528367 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m12:43:35.541773 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m12:43:35.545802 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m12:43:35.554321 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m12:43:35.559392 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m12:43:35.569965 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m12:43:35.572362 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m12:43:35.576252 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m12:43:35.578002 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m12:43:35.580629 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m12:43:35.595343 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m12:43:35.597349 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m12:43:35.627056 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.249 seconds
[0m12:43:35.632882 [info ] [Thread-1 (]: 20 of 24 PASS unique_fct_production_orders_order_id ............................ [[32mPASS[0m in 0.32s]
[0m12:43:35.635727 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m12:43:35.637700 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m12:43:35.639707 [info ] [Thread-1 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m12:43:35.642001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m12:43:35.643744 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m12:43:35.653726 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m12:43:35.668892 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m12:43:35.675506 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m12:43:35.691543 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m12:43:35.693727 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m12:43:35.819364 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.236 seconds
[0m12:43:35.825142 [info ] [Thread-4 (]: 21 of 24 PASS unique_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 0.39s]
[0m12:43:35.827783 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m12:43:35.851036 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.263 seconds
[0m12:43:35.856760 [info ] [Thread-2 (]: 22 of 24 PASS unique_stg_batches_batch_id ...................................... [[32mPASS[0m in 0.36s]
[0m12:43:35.859648 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m12:43:35.902372 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m12:43:35.908104 [info ] [Thread-3 (]: 23 of 24 PASS unique_stg_materials_material_id ................................. [[32mPASS[0m in 0.40s]
[0m12:43:35.910681 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m12:43:35.953723 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.258 seconds
[0m12:43:35.959082 [info ] [Thread-1 (]: 24 of 24 PASS unique_stg_production_orders_order_id ............................ [[32mPASS[0m in 0.32s]
[0m12:43:35.962119 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m12:43:35.967585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:35.969300 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m12:43:35.971299 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m12:43:36.437388 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m12:43:36.441625 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m12:43:36.909620 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m12:43:36.911572 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m12:43:37.396981 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m12:43:37.467216 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m12:43:37.963562 [info ] [MainThread]: 
[0m12:43:37.965800 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 6.88 seconds (6.88s).
[0m12:43:37.974363 [debug] [MainThread]: Command end result
[0m12:43:38.067073 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m12:43:38.078660 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m12:43:38.100569 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m12:43:38.102425 [info ] [MainThread]: 
[0m12:43:38.104619 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:38.106454 [info ] [MainThread]: 
[0m12:43:38.108245 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m12:43:38.110945 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.629646, "process_in_blocks": "0", "process_kernel_time": 1.747277, "process_mem_max_rss": "223836", "process_out_blocks": "16", "process_user_time": 8.643147}
[0m12:43:38.113342 [debug] [MainThread]: Command `dbt test` succeeded at 12:43:38.113111 after 10.63 seconds
[0m12:43:38.115360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd5190e6930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd4f7ed4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd4f41745c0>]}
[0m12:43:38.117289 [debug] [MainThread]: Flushing usage events
[0m12:43:38.917111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:02.813386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8783beeb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a87827f3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a87849de060>]}


============================== 14:20:02.823703 | 64ed4c3d-b1a7-4b9e-ac77-4ff1ece71266 ==============================
[0m14:20:02.823703 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:20:02.825599 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select staging --profiles-dir /opt/airflow/dbt_profiles', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'write_json': 'True', 'target_path': 'None', 'fail_fast': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'debug': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'introspect': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt_profiles', 'partial_parse': 'True'}
[0m14:20:03.616293 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:20:03.618032 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:20:03.619478 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:20:03.862805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64ed4c3d-b1a7-4b9e-ac77-4ff1ece71266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8783a52270>]}
[0m14:20:03.940233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64ed4c3d-b1a7-4b9e-ac77-4ff1ece71266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a87652e84a0>]}
[0m14:20:03.942413 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:20:04.114381 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:20:04.421742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:04.423462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:04.485428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64ed4c3d-b1a7-4b9e-ac77-4ff1ece71266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8765313e30>]}
[0m14:20:04.644284 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:20:04.652339 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:20:04.692503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64ed4c3d-b1a7-4b9e-ac77-4ff1ece71266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a87650abe90>]}
[0m14:20:04.694104 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:20:04.695608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64ed4c3d-b1a7-4b9e-ac77-4ff1ece71266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8765080e90>]}
[0m14:20:04.699202 [info ] [MainThread]: 
[0m14:20:04.700776 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:20:04.702154 [info ] [MainThread]: 
[0m14:20:04.704456 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:20:04.711532 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m14:20:04.784229 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m14:20:04.786221 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m14:20:04.787927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:06.185930 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.398 seconds
[0m14:20:06.191893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m14:20:06.212131 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:20:06.214523 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:20:06.525551 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.309 seconds
[0m14:20:06.531917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64ed4c3d-b1a7-4b9e-ac77-4ff1ece71266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8784c21820>]}
[0m14:20:06.540822 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m14:20:06.541631 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m14:20:06.542428 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m14:20:06.544172 [info ] [Thread-1 (]: 1 of 3 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m14:20:06.545911 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m14:20:06.547872 [info ] [Thread-3 (]: 3 of 3 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m14:20:06.550230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m14:20:06.552147 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m14:20:06.554265 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m14:20:06.556150 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m14:20:06.557735 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m14:20:06.559355 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m14:20:06.569745 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m14:20:06.635619 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m14:20:06.639366 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m14:20:06.647122 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m14:20:06.648805 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m14:20:06.674618 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m14:20:06.705341 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m14:20:06.706265 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m14:20:06.709922 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m14:20:06.721367 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m14:20:06.723401 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m14:20:06.725148 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m14:20:06.726205 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m14:20:06.727728 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m14:20:06.729198 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m14:20:06.733288 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:20:06.735099 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:20:07.227343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.496 seconds
[0m14:20:07.255202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64ed4c3d-b1a7-4b9e-ac77-4ff1ece71266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a87850a2780>]}
[0m14:20:07.257131 [info ] [Thread-1 (]: 1 of 3 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 0.70s]
[0m14:20:07.258882 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m14:20:08.610866 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.878 seconds
[0m14:20:08.611908 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.877 seconds
[0m14:20:08.616019 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64ed4c3d-b1a7-4b9e-ac77-4ff1ece71266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8764124d70>]}
[0m14:20:08.620364 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64ed4c3d-b1a7-4b9e-ac77-4ff1ece71266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a87652e9dc0>]}
[0m14:20:08.622243 [info ] [Thread-3 (]: 3 of 3 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 2.06s]
[0m14:20:08.623978 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 2.07s]
[0m14:20:08.625697 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m14:20:08.627377 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m14:20:08.631977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:08.633471 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_batches' was left open.
[0m14:20:08.634708 [debug] [MainThread]: On model.mfg_accelerator.stg_batches: Close
[0m14:20:09.088704 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_materials' was left open.
[0m14:20:09.090161 [debug] [MainThread]: On model.mfg_accelerator.stg_materials: Close
[0m14:20:09.557890 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_production_orders' was left open.
[0m14:20:09.559383 [debug] [MainThread]: On model.mfg_accelerator.stg_production_orders: Close
[0m14:20:10.020448 [info ] [MainThread]: 
[0m14:20:10.022033 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m14:20:10.024349 [debug] [MainThread]: Command end result
[0m14:20:10.082948 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:20:10.089822 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:20:10.102219 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:20:10.103608 [info ] [MainThread]: 
[0m14:20:10.104715 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:10.106070 [info ] [MainThread]: 
[0m14:20:10.107601 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:20:10.109618 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3922157, "process_in_blocks": "0", "process_kernel_time": 1.689986, "process_mem_max_rss": "219356", "process_out_blocks": "1272", "process_user_time": 6.254153}
[0m14:20:10.110906 [debug] [MainThread]: Command `dbt run` succeeded at 14:20:10.110776 after 7.39 seconds
[0m14:20:10.112130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8783a27a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a87827f3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a87826a6e40>]}
[0m14:20:10.113301 [debug] [MainThread]: Flushing usage events
[0m14:20:10.834161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:14.447556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7b8ecf2cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7b8f4084a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7b8f017e00>]}


============================== 14:20:14.457187 | 0126189a-6b75-495b-91b9-230de98d89da ==============================
[0m14:20:14.457187 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:20:14.458845 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'version_check': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run --select core --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_profiles', 'warn_error': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'static_parser': 'True', 'printer_width': '80', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'quiet': 'False'}
[0m14:20:15.236208 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:20:15.237907 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:20:15.239361 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:20:15.459112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0126189a-6b75-495b-91b9-230de98d89da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7b749884a0>]}
[0m14:20:15.536621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0126189a-6b75-495b-91b9-230de98d89da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7b70d194f0>]}
[0m14:20:15.538734 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:20:15.732567 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:20:15.999223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:16.000841 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:16.050836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0126189a-6b75-495b-91b9-230de98d89da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7b70881c40>]}
[0m14:20:16.176438 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:20:16.183575 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:20:16.215465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0126189a-6b75-495b-91b9-230de98d89da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7b708d7020>]}
[0m14:20:16.217032 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:20:16.218312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0126189a-6b75-495b-91b9-230de98d89da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7b708ac9e0>]}
[0m14:20:16.221792 [info ] [MainThread]: 
[0m14:20:16.223403 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:20:16.224856 [info ] [MainThread]: 
[0m14:20:16.226562 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:20:16.232236 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m14:20:16.273948 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m14:20:16.275813 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m14:20:16.277324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:17.724081 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.447 seconds
[0m14:20:17.729040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m14:20:17.744524 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:20:17.746196 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:20:18.142701 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.395 seconds
[0m14:20:18.153411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0126189a-6b75-495b-91b9-230de98d89da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7b70c1a7b0>]}
[0m14:20:18.164610 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.core_materials
[0m14:20:18.166651 [info ] [Thread-1 (]: 1 of 3 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m14:20:18.169862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.core_materials)
[0m14:20:18.172302 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.core_materials
[0m14:20:18.190862 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m14:20:18.206202 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.core_materials
[0m14:20:18.346530 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m14:20:18.363359 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m14:20:18.365080 [debug] [Thread-1 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m14:20:19.357856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.991 seconds
[0m14:20:19.419890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0126189a-6b75-495b-91b9-230de98d89da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7b9080e5d0>]}
[0m14:20:19.421684 [info ] [Thread-1 (]: 1 of 3 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 1.25s]
[0m14:20:19.423363 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.core_materials
[0m14:20:19.427402 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.core_batches
[0m14:20:19.428726 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m14:20:19.430826 [info ] [Thread-3 (]: 2 of 3 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m14:20:19.432558 [info ] [Thread-4 (]: 3 of 3 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m14:20:19.434205 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_batches'
[0m14:20:19.435803 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.fct_production_orders'
[0m14:20:19.437121 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.core_batches
[0m14:20:19.438404 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m14:20:19.444137 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m14:20:19.449946 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m14:20:19.457917 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.core_batches
[0m14:20:19.459372 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m14:20:19.463891 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m14:20:19.469040 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m14:20:19.480310 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m14:20:19.484132 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m14:20:19.485972 [debug] [Thread-3 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m14:20:19.488182 [debug] [Thread-4 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m14:20:19.489587 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:20:19.490912 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:20:21.299214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa251d423f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa254a4f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa251903170>]}


============================== 14:20:21.309082 | 63ce3e94-fb60-4df4-8e11-64ec46c79c92 ==============================
[0m14:20:21.309082 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:20:21.310665 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'partial_parse': 'True', 'quiet': 'False', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'version_check': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/dbt_profiles', 'no_print': 'None', 'introspect': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'target_path': 'None', 'static_parser': 'True', 'log_format': 'default', 'printer_width': '80', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:20:21.566350 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.077 seconds
[0m14:20:21.572318 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0126189a-6b75-495b-91b9-230de98d89da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7b70883fe0>]}
[0m14:20:21.574363 [info ] [Thread-3 (]: 2 of 3 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 2.14s]
[0m14:20:21.576473 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.core_batches
[0m14:20:21.737882 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.247 seconds
[0m14:20:21.743193 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0126189a-6b75-495b-91b9-230de98d89da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7b8dcec920>]}
[0m14:20:21.745259 [info ] [Thread-4 (]: 3 of 3 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 2.31s]
[0m14:20:21.747247 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m14:20:21.751250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:21.753057 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_materials' was left open.
[0m14:20:21.754729 [debug] [MainThread]: On model.mfg_accelerator.core_materials: Close
[0m14:20:22.249808 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:20:22.251900 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:20:22.254362 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:20:22.263682 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m14:20:22.265391 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m14:20:22.551295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63ce3e94-fb60-4df4-8e11-64ec46c79c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa251bad5b0>]}
[0m14:20:22.642783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63ce3e94-fb60-4df4-8e11-64ec46c79c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa251461430>]}
[0m14:20:22.645121 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:20:22.740395 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m14:20:22.743201 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m14:20:22.832114 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:20:23.139607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:23.141536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:23.204947 [info ] [MainThread]: 
[0m14:20:23.207038 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 6.98 seconds (6.98s).
[0m14:20:23.209665 [debug] [MainThread]: Command end result
[0m14:20:23.212533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63ce3e94-fb60-4df4-8e11-64ec46c79c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa250626840>]}
[0m14:20:23.287398 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:20:23.296506 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:20:23.317302 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:20:23.318935 [info ] [MainThread]: 
[0m14:20:23.320738 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:23.322392 [info ] [MainThread]: 
[0m14:20:23.324256 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:20:23.327005 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.965278, "process_in_blocks": "0", "process_kernel_time": 1.258265, "process_mem_max_rss": "219264", "process_out_blocks": "16", "process_user_time": 4.642839}
[0m14:20:23.329154 [debug] [MainThread]: Command `dbt run` succeeded at 14:20:23.328946 after 8.97 seconds
[0m14:20:23.330937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7b90b23950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7b71ff2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7b70fe9a00>]}
[0m14:20:23.332614 [debug] [MainThread]: Flushing usage events
[0m14:20:23.384036 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:20:23.392104 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:20:23.432848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63ce3e94-fb60-4df4-8e11-64ec46c79c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22f15e930>]}
[0m14:20:23.434510 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:20:23.436210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63ce3e94-fb60-4df4-8e11-64ec46c79c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22f150b00>]}
[0m14:20:23.440824 [info ] [MainThread]: 
[0m14:20:23.442640 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:20:23.444198 [info ] [MainThread]: 
[0m14:20:23.446032 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:20:23.453796 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m14:20:23.514050 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m14:20:23.515830 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m14:20:23.517373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:24.044901 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:25.074002 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.557 seconds
[0m14:20:25.078570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m14:20:25.093477 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:20:25.095001 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:20:25.366966 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.271 seconds
[0m14:20:25.371703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63ce3e94-fb60-4df4-8e11-64ec46c79c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22f59f4a0>]}
[0m14:20:25.378917 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m14:20:25.379636 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m14:20:25.380275 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m14:20:25.381717 [info ] [Thread-1 (]: 1 of 8 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m14:20:25.383562 [info ] [Thread-2 (]: 2 of 8 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m14:20:25.385174 [info ] [Thread-3 (]: 3 of 8 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m14:20:25.386930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m14:20:25.388620 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m14:20:25.390150 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m14:20:25.391470 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m14:20:25.392793 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m14:20:25.394080 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m14:20:25.404181 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m14:20:25.470875 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m14:20:25.475110 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m14:20:25.484444 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m14:20:25.486458 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m14:20:25.499198 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m14:20:25.555937 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m14:20:25.566858 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m14:20:25.571053 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m14:20:25.584109 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m14:20:25.587600 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m14:20:25.589711 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m14:20:25.591065 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m14:20:25.593033 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m14:20:25.594793 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m14:20:25.596682 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:20:25.598666 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:20:26.044682 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.444 seconds
[0m14:20:26.080773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63ce3e94-fb60-4df4-8e11-64ec46c79c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22e18d820>]}
[0m14:20:26.082592 [info ] [Thread-1 (]: 1 of 8 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 0.69s]
[0m14:20:26.084636 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m14:20:26.911906 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.313 seconds
[0m14:20:26.919351 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63ce3e94-fb60-4df4-8e11-64ec46c79c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22f4f3380>]}
[0m14:20:26.921196 [info ] [Thread-3 (]: 3 of 8 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 1.53s]
[0m14:20:26.922972 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m14:20:27.019350 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.423 seconds
[0m14:20:27.024105 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63ce3e94-fb60-4df4-8e11-64ec46c79c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22f4c8f50>]}
[0m14:20:27.026089 [info ] [Thread-2 (]: 2 of 8 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 1.64s]
[0m14:20:27.027998 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m14:20:27.030604 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.core_materials
[0m14:20:27.032359 [info ] [Thread-4 (]: 4 of 8 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m14:20:27.034046 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_materials'
[0m14:20:27.035948 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.core_materials
[0m14:20:27.040785 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m14:20:27.057486 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.core_materials
[0m14:20:27.093456 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m14:20:27.107730 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m14:20:27.112711 [debug] [Thread-4 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m14:20:27.114181 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:20:28.783372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d25e247a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d25e1df3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d25e1f64e30>]}


============================== 14:20:28.791596 | 120c4314-10a2-4af8-8559-e8461a0e28d1 ==============================
[0m14:20:28.791596 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:20:28.793097 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select marts --profiles-dir /opt/airflow/dbt_profiles', 'use_experimental_parser': 'False', 'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'static_parser': 'True', 'partial_parse': 'True', 'target_path': 'None', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_cache_events': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs'}
[0m14:20:29.022592 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.908 seconds
[0m14:20:29.027708 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63ce3e94-fb60-4df4-8e11-64ec46c79c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22e1dc920>]}
[0m14:20:29.029828 [info ] [Thread-4 (]: 4 of 8 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 1.99s]
[0m14:20:29.031950 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.core_materials
[0m14:20:29.034820 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.core_batches
[0m14:20:29.036072 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m14:20:29.038288 [info ] [Thread-3 (]: 5 of 8 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m14:20:29.041169 [info ] [Thread-2 (]: 6 of 8 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m14:20:29.043261 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_production_orders, now model.mfg_accelerator.core_batches)
[0m14:20:29.045099 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_materials, now model.mfg_accelerator.fct_production_orders)
[0m14:20:29.046762 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.core_batches
[0m14:20:29.048481 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m14:20:29.054197 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m14:20:29.061786 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m14:20:29.070786 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.core_batches
[0m14:20:29.072372 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m14:20:29.080001 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m14:20:29.085186 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m14:20:29.099457 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m14:20:29.105136 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m14:20:29.107326 [debug] [Thread-3 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m14:20:29.109635 [debug] [Thread-2 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m14:20:29.756033 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:20:29.757931 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:20:29.759580 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:20:30.035421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '120c4314-10a2-4af8-8559-e8461a0e28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d25e3232ff0>]}
[0m14:20:30.153001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '120c4314-10a2-4af8-8559-e8461a0e28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d25c4276360>]}
[0m14:20:30.155200 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:20:30.239312 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.128 seconds
[0m14:20:30.243847 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63ce3e94-fb60-4df4-8e11-64ec46c79c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22f570830>]}
[0m14:20:30.245655 [info ] [Thread-3 (]: 5 of 8 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 1.20s]
[0m14:20:30.247664 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.core_batches
[0m14:20:30.318686 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:20:30.472834 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.359 seconds
[0m14:20:30.477857 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63ce3e94-fb60-4df4-8e11-64ec46c79c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22e1b0da0>]}
[0m14:20:30.480083 [info ] [Thread-2 (]: 6 of 8 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 1.43s]
[0m14:20:30.482489 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m14:20:30.485374 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:20:30.486596 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:20:30.488618 [info ] [Thread-4 (]: 7 of 8 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m14:20:30.491117 [info ] [Thread-1 (]: 8 of 8 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m14:20:30.493078 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.core_materials, now model.mfg_accelerator.mfg_ml_features_orders)
[0m14:20:30.494838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_batches, now model.mfg_accelerator.mfg_plant_daily_kpis)
[0m14:20:30.496534 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m14:20:30.498310 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:20:30.505802 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:20:30.513696 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:20:30.522780 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m14:20:30.524232 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:20:30.529774 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:20:30.537917 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:20:30.550955 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:20:30.556914 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:20:30.558482 [debug] [Thread-4 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m14:20:30.560981 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m14:20:30.697729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:30.699605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:30.778417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '120c4314-10a2-4af8-8559-e8461a0e28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d25bfb0dd90>]}
[0m14:20:30.955378 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:20:30.965835 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:20:31.009563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '120c4314-10a2-4af8-8559-e8461a0e28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d25bf8da480>]}
[0m14:20:31.011309 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:20:31.013007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '120c4314-10a2-4af8-8559-e8461a0e28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d25bf89b560>]}
[0m14:20:31.016749 [info ] [MainThread]: 
[0m14:20:31.018450 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:20:31.020380 [info ] [MainThread]: 
[0m14:20:31.022586 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:20:31.029765 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m14:20:31.090438 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m14:20:31.092368 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m14:20:31.094040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:31.685597 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.122 seconds
[0m14:20:31.692928 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63ce3e94-fb60-4df4-8e11-64ec46c79c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22e258e00>]}
[0m14:20:31.697081 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.131 seconds
[0m14:20:31.699250 [info ] [Thread-4 (]: 7 of 8 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 1.20s]
[0m14:20:31.708751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63ce3e94-fb60-4df4-8e11-64ec46c79c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22e174740>]}
[0m14:20:31.713085 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:20:31.717730 [info ] [Thread-1 (]: 8 of 8 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 1.21s]
[0m14:20:31.724780 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:20:31.729807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:31.733421 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m14:20:31.737908 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m14:20:32.193119 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m14:20:32.194869 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m14:20:32.421970 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.328 seconds
[0m14:20:32.429408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m14:20:32.449605 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:20:32.451409 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:20:32.641617 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m14:20:32.643309 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m14:20:32.726371 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.276 seconds
[0m14:20:32.731761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '120c4314-10a2-4af8-8559-e8461a0e28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d25bf974950>]}
[0m14:20:32.739987 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:20:32.740650 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:20:32.742169 [info ] [Thread-1 (]: 1 of 2 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m14:20:32.744036 [info ] [Thread-2 (]: 2 of 2 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m14:20:32.745796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.mfg_ml_features_orders)
[0m14:20:32.747531 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.mfg_plant_daily_kpis'
[0m14:20:32.748857 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m14:20:32.750768 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:20:32.763504 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:20:32.837901 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:20:32.846443 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m14:20:32.847999 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:20:32.913028 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:20:32.915356 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:20:32.928748 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:20:32.932564 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:20:32.934836 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m14:20:32.937559 [debug] [Thread-2 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m14:20:32.941811 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:20:33.104386 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m14:20:33.106240 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m14:20:33.558323 [info ] [MainThread]: 
[0m14:20:33.560041 [info ] [MainThread]: Finished running 5 table models, 3 view models in 0 hours 0 minutes and 10.11 seconds (10.11s).
[0m14:20:33.563208 [debug] [MainThread]: Command end result
[0m14:20:33.622125 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:20:33.627905 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:20:33.641999 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:20:33.643274 [info ] [MainThread]: 
[0m14:20:33.644665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:33.646041 [info ] [MainThread]: 
[0m14:20:33.647361 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m14:20:33.649901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.459326, "process_in_blocks": "0", "process_kernel_time": 1.398863, "process_mem_max_rss": "221404", "process_out_blocks": "16", "process_user_time": 5.342938}
[0m14:20:33.651861 [debug] [MainThread]: Command `dbt run` succeeded at 14:20:33.651632 after 12.46 seconds
[0m14:20:33.653391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa251677800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22ff50f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa251b84ad0>]}
[0m14:20:33.654603 [debug] [MainThread]: Flushing usage events
[0m14:20:34.187670 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.248 seconds
[0m14:20:34.215005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '120c4314-10a2-4af8-8559-e8461a0e28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d25e3926780>]}
[0m14:20:34.216883 [info ] [Thread-1 (]: 1 of 2 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 1.47s]
[0m14:20:34.218733 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:20:34.427385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:34.788976 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.847 seconds
[0m14:20:34.793930 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '120c4314-10a2-4af8-8559-e8461a0e28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d25bfda4d70>]}
[0m14:20:34.796336 [info ] [Thread-2 (]: 2 of 2 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 2.05s]
[0m14:20:34.799559 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:20:34.803360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:34.805092 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m14:20:34.807751 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m14:20:35.265563 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m14:20:35.267530 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m14:20:35.727715 [info ] [MainThread]: 
[0m14:20:35.729704 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.71 seconds (4.71s).
[0m14:20:35.732317 [debug] [MainThread]: Command end result
[0m14:20:35.812682 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:20:35.822803 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:20:35.840997 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:20:35.842877 [info ] [MainThread]: 
[0m14:20:35.844574 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:35.846258 [info ] [MainThread]: 
[0m14:20:35.848377 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:20:35.851762 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.162927, "process_in_blocks": "0", "process_kernel_time": 1.32461, "process_mem_max_rss": "217156", "process_out_blocks": "16", "process_user_time": 4.930944}
[0m14:20:35.853933 [debug] [MainThread]: Command `dbt run` succeeded at 14:20:35.853716 after 7.17 seconds
[0m14:20:35.855896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d25e1dab0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d25bfb298e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d25bf8f25d0>]}
[0m14:20:35.857797 [debug] [MainThread]: Flushing usage events
[0m14:20:36.429207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:41.824260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a940507fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9404db1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a940703eb10>]}


============================== 14:20:41.835831 | 60691521-ee07-4c26-8442-4dd1b744d7c3 ==============================
[0m14:20:41.835831 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:20:41.838120 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'quiet': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'target_path': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'profiles_dir': '/opt/airflow/dbt_profiles', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'use_experimental_parser': 'False', 'empty': 'None', 'partial_parse': 'True', 'debug': 'False'}
[0m14:20:42.853175 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:20:42.855152 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:20:42.856796 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:20:43.156772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60691521-ee07-4c26-8442-4dd1b744d7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a93e9a710d0>]}
[0m14:20:43.261028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60691521-ee07-4c26-8442-4dd1b744d7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a93e30acfb0>]}
[0m14:20:43.263487 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:20:43.450320 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:20:43.830529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:43.832383 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:43.912673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60691521-ee07-4c26-8442-4dd1b744d7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a93e30ac740>]}
[0m14:20:44.095458 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:20:44.104587 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:20:44.161935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60691521-ee07-4c26-8442-4dd1b744d7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a93e2b13530>]}
[0m14:20:44.163745 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:20:44.165290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60691521-ee07-4c26-8442-4dd1b744d7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a93e2c379b0>]}
[0m14:20:44.170812 [info ] [MainThread]: 
[0m14:20:44.172776 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:20:44.174642 [info ] [MainThread]: 
[0m14:20:44.176659 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:20:44.185377 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m14:20:44.193978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8db93b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8dcd44bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8dc805910>]}


============================== 14:20:44.204503 | c9da1d44-cab4-44b8-8992-7e8d7944bc9d ==============================
[0m14:20:44.204503 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:20:44.207160 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'printer_width': '80', 'quiet': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'target_path': 'None', 'introspect': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'cache_selected_only': 'False', 'no_print': 'None', 'log_format': 'default', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'empty': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True'}
[0m14:20:44.273975 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:20:44.275658 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:20:44.277220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:45.130801 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:20:45.132877 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:20:45.134795 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:20:45.404738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9da1d44-cab4-44b8-8992-7e8d7944bc9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8bd26c3b0>]}
[0m14:20:45.529911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9da1d44-cab4-44b8-8992-7e8d7944bc9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8dafe3d70>]}
[0m14:20:45.532704 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:20:45.756126 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:20:46.037123 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.760 seconds
[0m14:20:46.044379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60691521-ee07-4c26-8442-4dd1b744d7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a93e2fc4200>]}
[0m14:20:46.055327 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:20:46.056295 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:20:46.057317 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:20:46.058292 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:20:46.059402 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m14:20:46.061187 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m14:20:46.063203 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m14:20:46.065484 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m14:20:46.067609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m14:20:46.070131 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m14:20:46.072339 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m14:20:46.074485 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m14:20:46.076220 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:20:46.078406 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:20:46.080338 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:20:46.082173 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:20:46.124796 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:20:46.122004 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:20:46.133382 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:20:46.142211 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:20:46.152463 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:20:46.173259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:46.175371 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:46.153372 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:20:46.154224 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:20:46.166331 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:20:46.206072 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:20:46.208382 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:20:46.213183 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:20:46.218614 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:20:46.231097 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:20:46.232997 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:20:46.235537 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:20:46.236626 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m14:20:46.238031 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:20:46.239553 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m14:20:46.241365 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m14:20:46.243166 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:20:46.244885 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m14:20:46.257282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9da1d44-cab4-44b8-8992-7e8d7944bc9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8bd068470>]}
[0m14:20:46.246880 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:20:46.248804 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:20:46.445339 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:20:46.454739 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:20:46.509189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9da1d44-cab4-44b8-8992-7e8d7944bc9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8bcd0f980>]}
[0m14:20:46.511110 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:20:46.512916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9da1d44-cab4-44b8-8992-7e8d7944bc9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8bcebcd10>]}
[0m14:20:46.518437 [info ] [MainThread]: 
[0m14:20:46.520433 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:20:46.522103 [info ] [MainThread]: 
[0m14:20:46.524237 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:20:46.532929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m14:20:46.541969 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.283 seconds
[0m14:20:46.556930 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.49s]
[0m14:20:46.559461 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:20:46.561459 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:20:46.563562 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m14:20:46.565467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m14:20:46.567098 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:20:46.575007 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:20:46.594808 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:20:46.600752 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:20:46.615069 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:20:46.616708 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m14:20:46.618704 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:20:46.620971 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:20:46.622854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:46.920379 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.302 seconds
[0m14:20:46.924398 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.36s]
[0m14:20:46.926606 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:20:46.928421 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:20:46.930062 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m14:20:46.931753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m14:20:46.933406 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:20:46.940072 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:20:46.954258 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:20:46.958982 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:20:46.973843 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:20:46.975118 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m14:20:47.353307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.377 seconds
[0m14:20:47.356972 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.43s]
[0m14:20:47.358796 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:20:47.360322 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:20:47.361761 [info ] [Thread-1 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m14:20:47.363422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m14:20:47.364855 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:20:47.371539 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:20:47.382401 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:20:47.388620 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:20:47.403111 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:20:47.404474 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m14:20:47.725861 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.483 seconds
[0m14:20:47.729462 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.66s]
[0m14:20:47.731292 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:20:47.732774 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:20:47.735102 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.486 seconds
[0m14:20:47.736519 [info ] [Thread-2 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m14:20:47.740223 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.67s]
[0m14:20:47.741922 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m14:20:47.743816 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.497 seconds
[0m14:20:47.745219 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:20:47.746779 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:20:47.750121 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.68s]
[0m14:20:47.752664 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:20:47.759245 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:20:47.761152 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:20:47.762652 [info ] [Thread-3 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m14:20:47.765341 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:20:47.766986 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m14:20:47.769915 [info ] [Thread-4 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m14:20:47.771803 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.366 seconds
[0m14:20:47.773281 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:20:47.775030 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m14:20:47.778970 [info ] [Thread-1 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 0.42s]
[0m14:20:47.786614 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:20:47.787203 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:20:47.788443 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:20:47.790116 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:20:47.795263 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:20:47.803410 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:20:47.805385 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:20:47.806813 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:20:47.810114 [info ] [Thread-1 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m14:20:47.815017 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:20:47.816415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m14:20:47.820711 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:20:47.829809 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:20:47.832476 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:20:47.834495 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:20:47.836216 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:20:47.840822 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:20:47.842736 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m14:20:47.844648 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m14:20:47.846173 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:20:47.859295 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:20:47.862670 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:20:47.864363 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m14:20:47.869150 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:20:47.871582 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m14:20:47.897939 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.275 seconds
[0m14:20:47.904977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9da1d44-cab4-44b8-8992-7e8d7944bc9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8dc915970>]}
[0m14:20:47.913281 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:20:47.914012 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:20:47.914697 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:20:47.915416 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:20:47.916584 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m14:20:47.918819 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m14:20:47.921273 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m14:20:47.923299 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m14:20:47.925226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m14:20:47.926960 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m14:20:47.928699 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m14:20:47.930231 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m14:20:47.931738 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:20:47.933061 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:20:47.934523 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:20:47.936011 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:20:47.956446 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:20:47.961360 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:20:47.967135 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:20:47.973491 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:20:47.982771 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:20:47.983581 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:20:47.985286 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:20:47.996982 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:20:48.032679 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:20:48.036405 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:20:48.043768 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:20:48.050439 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:20:48.065830 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:20:48.068384 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:20:48.071673 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m14:20:48.073966 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:20:48.076413 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:20:48.078485 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m14:20:48.080748 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:20:48.082928 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m14:20:48.085447 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m14:20:48.087936 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:20:48.098421 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:20:48.148202 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.297 seconds
[0m14:20:48.153405 [info ] [Thread-3 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.39s]
[0m14:20:48.155528 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:20:48.161019 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.294 seconds
[0m14:20:48.174679 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.301 seconds
[0m14:20:48.176808 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:20:48.183136 [info ] [Thread-4 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.41s]
[0m14:20:48.188594 [info ] [Thread-1 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.37s]
[0m14:20:48.190939 [info ] [Thread-3 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m14:20:48.194037 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:20:48.197213 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:20:48.199566 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m14:20:48.202693 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:20:48.206034 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:20:48.208246 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:20:48.210211 [info ] [Thread-4 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m14:20:48.213806 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.365 seconds
[0m14:20:48.214841 [info ] [Thread-1 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m14:20:48.222043 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:20:48.223328 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m14:20:48.226917 [info ] [Thread-2 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 0.48s]
[0m14:20:48.228469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m14:20:48.230765 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:20:48.232328 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:20:48.233686 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:20:48.242418 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:20:48.243933 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:20:48.245229 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:20:48.258364 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:20:48.260391 [info ] [Thread-2 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m14:20:48.264621 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:20:48.266966 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m14:20:48.269924 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:20:48.277477 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:20:48.280187 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:20:48.284945 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:20:48.286080 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:20:48.289016 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:20:48.293575 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:20:48.294940 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m14:20:48.303023 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:20:48.303921 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:20:48.305490 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m14:20:48.308114 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:20:48.312151 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:20:48.315394 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m14:20:48.329622 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:20:48.331267 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m14:20:48.353400 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.252 seconds
[0m14:20:48.365367 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.44s]
[0m14:20:48.367288 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:20:48.369507 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:20:48.371027 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m14:20:48.372739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m14:20:48.374273 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:20:48.380350 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:20:48.395235 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:20:48.400596 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:20:48.420149 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:20:48.422263 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m14:20:48.631299 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.334 seconds
[0m14:20:48.635841 [info ] [Thread-3 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.44s]
[0m14:20:48.637964 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:20:48.639517 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:20:48.641238 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.328 seconds
[0m14:20:48.642654 [info ] [Thread-3 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m14:20:48.646290 [info ] [Thread-4 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.42s]
[0m14:20:48.647962 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m14:20:48.649643 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:20:48.651138 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:20:48.653069 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:20:48.660598 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:20:48.662128 [info ] [Thread-4 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m14:20:48.665222 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m14:20:48.666954 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:20:48.678137 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:20:48.681951 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:20:48.691336 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:20:48.692652 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.268 seconds
[0m14:20:48.692286 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:20:48.699099 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:20:48.711900 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:20:48.713845 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:20:48.715739 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m14:20:48.718555 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m14:20:48.701751 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.33s]
[0m14:20:48.727257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m14:20:48.733258 [info ] [Thread-1 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.50s]
[0m14:20:48.735919 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:20:48.737941 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:20:48.739719 [info ] [Thread-1 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m14:20:48.726168 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:20:48.741565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m14:20:48.743382 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:20:48.744495 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:20:48.747577 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m14:20:48.750484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m14:20:48.754085 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:20:48.767989 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:20:48.771063 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:20:48.787161 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:20:48.789669 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:20:48.799992 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:20:48.800097 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:20:48.816231 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:20:48.818429 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:20:48.819875 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m14:20:48.823379 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m14:20:48.827265 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m14:20:48.837506 [info ] [Thread-2 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.57s]
[0m14:20:48.840275 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:20:48.842522 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:20:48.844794 [info ] [Thread-2 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m14:20:48.847531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m14:20:48.849897 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:20:48.860205 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:20:48.875949 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:20:48.880935 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:20:48.897654 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:20:48.899866 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m14:20:49.095376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.272 seconds
[0m14:20:49.099560 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.35s]
[0m14:20:49.101494 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:20:49.103155 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:20:49.104719 [info ] [Thread-1 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m14:20:49.105373 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.384 seconds
[0m14:20:49.106378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m14:20:49.107825 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:20:49.106545 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.382 seconds
[0m14:20:49.114346 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:20:49.110299 [info ] [Thread-4 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.45s]
[0m14:20:49.114416 [info ] [Thread-3 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.47s]
[0m14:20:49.116506 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:20:49.118226 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:20:49.119662 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:20:49.121341 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:20:49.122862 [info ] [Thread-4 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m14:20:49.124361 [info ] [Thread-3 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m14:20:49.128156 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:20:49.126084 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m14:20:49.128690 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.300 seconds
[0m14:20:49.135263 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:20:49.130004 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m14:20:49.131935 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:20:49.136196 [info ] [Thread-1 (]: 18 of 24 PASS unique_core_batches_batch_id ..................................... [[32mPASS[0m in 0.39s]
[0m14:20:49.138100 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:20:49.149082 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:20:49.150622 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m14:20:49.145313 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:20:49.146952 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:20:49.154112 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:20:49.156794 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:20:49.159510 [info ] [Thread-1 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m14:20:49.161399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m14:20:49.162914 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:20:49.169235 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:20:49.171545 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:20:49.172457 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:20:49.177502 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:20:49.184792 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:20:49.186181 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:20:49.187485 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.285 seconds
[0m14:20:49.194462 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:20:49.198837 [info ] [Thread-2 (]: 19 of 24 PASS unique_core_materials_material_id ................................ [[32mPASS[0m in 0.35s]
[0m14:20:49.202434 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:20:49.203877 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:20:49.205311 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:20:49.206872 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m14:20:49.208447 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m14:20:49.210377 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:20:49.214513 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:20:49.218192 [info ] [Thread-2 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m14:20:49.219868 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m14:20:49.221676 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m14:20:49.225550 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:20:49.232397 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:20:49.245333 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:20:49.247161 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.166 seconds
[0m14:20:49.251126 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.32s]
[0m14:20:49.250953 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:20:49.253878 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:20:49.256070 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:20:49.258192 [info ] [Thread-4 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m14:20:49.260169 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m14:20:49.262731 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:20:49.271954 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:20:49.273941 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m14:20:49.266295 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.168 seconds
[0m14:20:49.276126 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:20:49.280420 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.35s]
[0m14:20:49.284112 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:20:49.286162 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:20:49.288133 [info ] [Thread-3 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m14:20:49.290228 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m14:20:49.292176 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:20:49.294790 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.207 seconds
[0m14:20:49.303633 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:20:49.309192 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.38s]
[0m14:20:49.310067 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:20:49.313820 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:20:49.319105 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:20:49.320886 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:20:49.323744 [info ] [Thread-2 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m14:20:49.326600 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m14:20:49.329289 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:20:49.331735 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:20:49.342626 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:20:49.349654 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:20:49.353936 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:20:49.356918 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m14:20:49.373701 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:20:49.382775 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:20:49.384415 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:20:49.387866 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m14:20:49.403693 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:20:49.405500 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m14:20:49.409741 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.258 seconds
[0m14:20:49.416283 [info ] [Thread-1 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 0.31s]
[0m14:20:49.419214 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:20:49.421545 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:20:49.423633 [info ] [Thread-1 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m14:20:49.425827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m14:20:49.427779 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:20:49.439244 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:20:49.451989 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:20:49.457478 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:20:49.470596 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:20:49.471980 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m14:20:49.501881 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.290 seconds
[0m14:20:49.503043 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m14:20:49.506778 [info ] [Thread-3 (]: 21 of 24 PASS unique_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 0.38s]
[0m14:20:49.510416 [info ] [Thread-4 (]: 20 of 24 PASS unique_fct_production_orders_order_id ............................ [[32mPASS[0m in 0.38s]
[0m14:20:49.512928 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:20:49.515150 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:20:49.517605 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:20:49.521063 [info ] [Thread-3 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m14:20:49.523297 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m14:20:49.525921 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.302 seconds
[0m14:20:49.527482 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:20:49.532174 [info ] [Thread-1 (]: 22 of 24 PASS unique_stg_batches_batch_id ...................................... [[32mPASS[0m in 0.37s]
[0m14:20:49.539615 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:20:49.541572 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:20:49.558012 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:20:49.563049 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:20:49.580415 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:20:49.582535 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.307 seconds
[0m14:20:49.583714 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m14:20:49.587876 [info ] [Thread-2 (]: 23 of 24 PASS unique_stg_materials_material_id ................................. [[32mPASS[0m in 0.37s]
[0m14:20:49.592459 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:20:49.602257 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.243 seconds
[0m14:20:49.606680 [info ] [Thread-4 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 0.35s]
[0m14:20:49.608973 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:20:49.611020 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:20:49.612964 [info ] [Thread-4 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m14:20:49.614986 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m14:20:49.616934 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:20:49.624074 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:20:49.640366 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:20:49.653897 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:20:49.671923 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.282 seconds
[0m14:20:49.678178 [info ] [Thread-3 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.39s]
[0m14:20:49.680982 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:20:49.684931 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.274 seconds
[0m14:20:49.687548 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:20:49.688769 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:20:49.693176 [info ] [Thread-2 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.37s]
[0m14:20:49.695184 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m14:20:49.697162 [info ] [Thread-3 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m14:20:49.699227 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:20:49.704637 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m14:20:49.706680 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:20:49.708368 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:20:49.710097 [info ] [Thread-2 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m14:20:49.718187 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:20:49.719723 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m14:20:49.722586 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:20:49.737814 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.264 seconds
[0m14:20:49.739714 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:20:49.744675 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:20:49.743877 [info ] [Thread-1 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.32s]
[0m14:20:49.751135 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:20:49.753189 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:20:49.755784 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:20:49.757762 [info ] [Thread-1 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m14:20:49.759752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m14:20:49.760590 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:20:49.762402 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:20:49.768423 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:20:49.777586 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:20:49.785491 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:20:49.787958 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m14:20:49.801962 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:20:49.802742 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:20:49.804161 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m14:20:49.809229 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:20:49.824515 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:20:49.826083 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m14:20:49.919206 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.329 seconds
[0m14:20:49.924670 [info ] [Thread-3 (]: 24 of 24 PASS unique_stg_production_orders_order_id ............................ [[32mPASS[0m in 0.40s]
[0m14:20:49.927171 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:20:49.931687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:49.933432 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m14:20:49.935036 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m14:20:49.970902 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.270 seconds
[0m14:20:49.975387 [info ] [Thread-4 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.36s]
[0m14:20:49.977705 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:20:49.979513 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:20:49.981409 [info ] [Thread-4 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m14:20:49.983305 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m14:20:49.985173 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:20:49.993594 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:20:50.010115 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:20:50.015017 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:20:50.029933 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:20:50.031401 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m14:20:50.055286 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.264 seconds
[0m14:20:50.059773 [info ] [Thread-3 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.36s]
[0m14:20:50.061766 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.251 seconds
[0m14:20:50.063115 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:20:50.067162 [info ] [Thread-2 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.35s]
[0m14:20:50.069399 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:20:50.071547 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:20:50.073376 [info ] [Thread-3 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m14:20:50.075307 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:20:50.077359 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m14:20:50.079189 [info ] [Thread-2 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m14:20:50.081241 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:20:50.083095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m14:20:50.093602 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:20:50.095269 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:20:50.106698 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:20:50.113415 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.286 seconds
[0m14:20:50.118676 [info ] [Thread-1 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.36s]
[0m14:20:50.119655 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:20:50.121581 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:20:50.122556 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:20:50.127093 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:20:50.128850 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:20:50.133466 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:20:50.136646 [info ] [Thread-1 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m14:20:50.139464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m14:20:50.141178 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:20:50.147695 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:20:50.151151 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:20:50.153783 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:20:50.154509 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m14:20:50.156387 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m14:20:50.167032 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:20:50.171755 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:20:50.187129 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:20:50.188764 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m14:20:50.329404 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.296 seconds
[0m14:20:50.333295 [info ] [Thread-4 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.35s]
[0m14:20:50.335302 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:20:50.336910 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:20:50.338614 [info ] [Thread-4 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m14:20:50.340344 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m14:20:50.342019 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:20:50.348193 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:20:50.362212 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:20:50.366718 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:20:50.381147 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:20:50.383656 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m14:20:50.385560 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m14:20:50.385482 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m14:20:50.411803 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.253 seconds
[0m14:20:50.415492 [info ] [Thread-2 (]: 18 of 24 PASS unique_core_batches_batch_id ..................................... [[32mPASS[0m in 0.33s]
[0m14:20:50.417512 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:20:50.419058 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:20:50.420641 [info ] [Thread-2 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m14:20:50.422353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m14:20:50.423831 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:20:50.430138 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:20:50.431752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.242 seconds
[0m14:20:50.436159 [info ] [Thread-1 (]: 19 of 24 PASS unique_core_materials_material_id ................................ [[32mPASS[0m in 0.30s]
[0m14:20:50.438242 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:20:50.440130 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:20:50.442572 [info ] [Thread-1 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m14:20:50.445300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m14:20:50.451549 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:20:50.452982 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:20:50.456277 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.295 seconds
[0m14:20:50.461296 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:20:50.469027 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:20:50.472697 [info ] [Thread-3 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.40s]
[0m14:20:50.477954 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:20:50.479512 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:20:50.480914 [info ] [Thread-3 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m14:20:50.482547 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m14:20:50.483926 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:20:50.491450 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:20:50.492637 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:20:50.493290 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:20:50.496066 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m14:20:50.500642 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:20:50.509458 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:20:50.514357 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:20:50.517240 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:20:50.519151 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m14:20:50.523384 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:20:50.525210 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m14:20:50.647530 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.260 seconds
[0m14:20:50.651905 [info ] [Thread-4 (]: 20 of 24 PASS unique_fct_production_orders_order_id ............................ [[32mPASS[0m in 0.31s]
[0m14:20:50.654096 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:20:50.655764 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:20:50.657354 [info ] [Thread-4 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m14:20:50.659006 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m14:20:50.660512 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:20:50.668303 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:20:50.684207 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:20:50.693827 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:20:50.716466 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:20:50.719567 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m14:20:50.769115 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.266 seconds
[0m14:20:50.775188 [info ] [Thread-2 (]: 21 of 24 PASS unique_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 0.35s]
[0m14:20:50.777448 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:20:50.787420 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.260 seconds
[0m14:20:50.791567 [info ] [Thread-3 (]: 23 of 24 PASS unique_stg_materials_material_id ................................. [[32mPASS[0m in 0.31s]
[0m14:20:50.793733 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:20:50.842643 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m14:20:50.843876 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m14:20:51.004147 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.282 seconds
[0m14:20:51.007961 [info ] [Thread-4 (]: 24 of 24 PASS unique_stg_production_orders_order_id ............................ [[32mPASS[0m in 0.35s]
[0m14:20:51.009837 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:20:51.230130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.709 seconds
[0m14:20:51.233771 [info ] [Thread-1 (]: 22 of 24 PASS unique_stg_batches_batch_id ...................................... [[32mPASS[0m in 0.79s]
[0m14:20:51.235586 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:20:51.239168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:51.240736 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m14:20:51.242013 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m14:20:51.286638 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442' was left open.
[0m14:20:51.288140 [debug] [MainThread]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: Close
[0m14:20:51.693886 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m14:20:51.696051 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m14:20:51.751011 [info ] [MainThread]: 
[0m14:20:51.752755 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 7.57 seconds (7.57s).
[0m14:20:51.760603 [debug] [MainThread]: Command end result
[0m14:20:51.825451 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:20:51.832532 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:20:51.848164 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:20:51.849475 [info ] [MainThread]: 
[0m14:20:51.850998 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:51.852267 [info ] [MainThread]: 
[0m14:20:51.853528 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m14:20:51.855603 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.175243, "process_in_blocks": "0", "process_kernel_time": 1.604136, "process_mem_max_rss": "223468", "process_out_blocks": "16", "process_user_time": 8.544562}
[0m14:20:51.857004 [debug] [MainThread]: Command `dbt test` succeeded at 14:20:51.856881 after 10.18 seconds
[0m14:20:51.858302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9405251b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a93e1c840b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a93e2e717f0>]}
[0m14:20:51.859647 [debug] [MainThread]: Flushing usage events
[0m14:20:52.174463 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m14:20:52.176224 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m14:20:52.472248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:52.642896 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m14:20:52.644744 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m14:20:53.090129 [info ] [MainThread]: 
[0m14:20:53.091900 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 6.57 seconds (6.57s).
[0m14:20:53.097629 [debug] [MainThread]: Command end result
[0m14:20:53.161357 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:20:53.168181 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:20:53.183427 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:20:53.184918 [info ] [MainThread]: 
[0m14:20:53.186605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:53.188202 [info ] [MainThread]: 
[0m14:20:53.189396 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m14:20:53.192121 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.117103, "process_in_blocks": "0", "process_kernel_time": 1.647683, "process_mem_max_rss": "224184", "process_out_blocks": "16", "process_user_time": 7.812432}
[0m14:20:53.193425 [debug] [MainThread]: Command `dbt test` succeeded at 14:20:53.193309 after 9.12 seconds
[0m14:20:53.194564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8dce38470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8db043590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8dbc0f920>]}
[0m14:20:53.195684 [debug] [MainThread]: Flushing usage events
[0m14:20:53.770575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:00.651015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7548d8e6d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7548d91712e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7548d8e6d2b0>]}


============================== 14:21:00.659628 | bc823370-fae8-4a91-a199-504ec3822b0a ==============================
[0m14:21:00.659628 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:21:00.661326 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'introspect': 'True', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'invocation_command': 'dbt run --select staging --profiles-dir /opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt_project/logs', 'log_cache_events': 'False', 'fail_fast': 'False', 'write_json': 'True', 'use_colors': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'empty': 'False'}
[0m14:21:01.554955 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:21:01.556653 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:21:01.558392 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:21:01.810999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc823370-fae8-4a91-a199-504ec3822b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7548bd978590>]}
[0m14:21:01.898717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc823370-fae8-4a91-a199-504ec3822b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7548b71c7560>]}
[0m14:21:01.900747 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:21:02.077177 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:21:02.380045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:21:02.381914 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:21:02.443271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc823370-fae8-4a91-a199-504ec3822b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7548b6e29d90>]}
[0m14:21:02.586025 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:21:02.593167 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:21:02.628710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc823370-fae8-4a91-a199-504ec3822b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7548b6bbeb40>]}
[0m14:21:02.630383 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:21:02.631947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc823370-fae8-4a91-a199-504ec3822b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7548b6b6cbc0>]}
[0m14:21:02.635941 [info ] [MainThread]: 
[0m14:21:02.638154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:21:02.640887 [info ] [MainThread]: 
[0m14:21:02.640148 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:21:02.647280 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m14:21:02.703997 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m14:21:02.705815 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m14:21:02.707636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:03.972183 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.264 seconds
[0m14:21:03.976495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m14:21:03.991958 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:21:03.993492 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:21:04.274963 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.280 seconds
[0m14:21:04.280567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc823370-fae8-4a91-a199-504ec3822b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7548b5c13740>]}
[0m14:21:04.287802 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m14:21:04.288663 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m14:21:04.289504 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m14:21:04.291277 [info ] [Thread-1 (]: 1 of 3 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m14:21:04.293279 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m14:21:04.295159 [info ] [Thread-3 (]: 3 of 3 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m14:21:04.296888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m14:21:04.298485 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m14:21:04.300115 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m14:21:04.301549 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m14:21:04.303169 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m14:21:04.304279 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m14:21:04.315016 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m14:21:04.380066 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m14:21:04.384240 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m14:21:04.394130 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m14:21:04.396297 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m14:21:04.403443 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m14:21:04.453246 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m14:21:04.459380 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m14:21:04.462750 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m14:21:04.473534 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m14:21:04.475559 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m14:21:04.477798 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m14:21:04.478801 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m14:21:04.480383 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m14:21:04.481933 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m14:21:04.483589 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:21:04.486980 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:21:04.949747 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m14:21:04.978461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc823370-fae8-4a91-a199-504ec3822b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7548b6e29ca0>]}
[0m14:21:04.980301 [info ] [Thread-1 (]: 1 of 3 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 0.68s]
[0m14:21:04.982127 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m14:21:05.948163 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.464 seconds
[0m14:21:05.949354 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.462 seconds
[0m14:21:05.954595 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc823370-fae8-4a91-a199-504ec3822b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7548b6f48b30>]}
[0m14:21:05.958530 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc823370-fae8-4a91-a199-504ec3822b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7548b5c136e0>]}
[0m14:21:05.960345 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 1.66s]
[0m14:21:05.962181 [info ] [Thread-3 (]: 3 of 3 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 1.66s]
[0m14:21:05.964105 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m14:21:05.965881 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m14:21:05.971239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:05.972788 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_batches' was left open.
[0m14:21:05.974054 [debug] [MainThread]: On model.mfg_accelerator.stg_batches: Close
[0m14:21:06.416668 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_materials' was left open.
[0m14:21:06.418781 [debug] [MainThread]: On model.mfg_accelerator.stg_materials: Close
[0m14:21:06.878526 [debug] [MainThread]: Connection 'model.mfg_accelerator.stg_production_orders' was left open.
[0m14:21:06.880144 [debug] [MainThread]: On model.mfg_accelerator.stg_production_orders: Close
[0m14:21:07.381064 [info ] [MainThread]: 
[0m14:21:07.383337 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m14:21:07.386704 [debug] [MainThread]: Command end result
[0m14:21:07.469947 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:21:07.478758 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:21:07.495819 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:21:07.497548 [info ] [MainThread]: 
[0m14:21:07.499454 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:07.501366 [info ] [MainThread]: 
[0m14:21:07.503261 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:21:07.506062 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.951343, "process_in_blocks": "0", "process_kernel_time": 1.2815, "process_mem_max_rss": "219056", "process_out_blocks": "16", "process_user_time": 4.841222}
[0m14:21:07.508089 [debug] [MainThread]: Command `dbt run` succeeded at 14:21:07.507903 after 6.95 seconds
[0m14:21:07.509941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7548d97153a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7548d95949e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7548d9594050>]}
[0m14:21:07.512063 [debug] [MainThread]: Flushing usage events
[0m14:21:08.118482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:12.851502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c04f8aa0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c04f2ce5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c05171d910>]}


============================== 14:21:12.860039 | d3616d2d-0b50-4ee6-98d3-48aef18484f9 ==============================
[0m14:21:12.860039 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:21:12.861851 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'empty': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_format': 'default', 'no_print': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --select core --profiles-dir /opt/airflow/dbt_profiles', 'indirect_selection': 'eager', 'printer_width': '80', 'fail_fast': 'False', 'partial_parse': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'version_check': 'True', 'use_colors': 'True', 'debug': 'False'}
[0m14:21:14.037261 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:21:14.044526 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:21:14.047102 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:21:14.712678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3616d2d-0b50-4ee6-98d3-48aef18484f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c03143aff0>]}
[0m14:21:14.914962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3616d2d-0b50-4ee6-98d3-48aef18484f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c030fb0170>]}
[0m14:21:14.920695 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:21:15.217330 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:21:15.636826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:21:15.638656 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:21:15.712174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3616d2d-0b50-4ee6-98d3-48aef18484f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c030f95490>]}
[0m14:21:15.906642 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:21:15.917877 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:21:15.966795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3616d2d-0b50-4ee6-98d3-48aef18484f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c030f5d4c0>]}
[0m14:21:15.969239 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:21:15.971279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3616d2d-0b50-4ee6-98d3-48aef18484f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c038d1c350>]}
[0m14:21:15.975695 [info ] [MainThread]: 
[0m14:21:15.977746 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:21:15.979508 [info ] [MainThread]: 
[0m14:21:15.981664 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:21:15.990323 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m14:21:16.068972 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m14:21:16.070950 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m14:21:16.072751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:17.957525 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.885 seconds
[0m14:21:17.966201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m14:21:17.996257 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:21:17.998181 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:21:18.275273 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.275 seconds
[0m14:21:18.285672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3616d2d-0b50-4ee6-98d3-48aef18484f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c0508ddbe0>]}
[0m14:21:18.299205 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.core_materials
[0m14:21:18.302387 [info ] [Thread-1 (]: 1 of 3 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m14:21:18.305512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.core_materials)
[0m14:21:18.307492 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.core_materials
[0m14:21:18.328789 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m14:21:18.344494 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.core_materials
[0m14:21:18.555758 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m14:21:18.576090 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m14:21:18.578494 [debug] [Thread-1 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m14:21:19.762206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.173 seconds
[0m14:21:19.929678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3616d2d-0b50-4ee6-98d3-48aef18484f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c033c493d0>]}
[0m14:21:19.932635 [info ] [Thread-1 (]: 1 of 3 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 1.62s]
[0m14:21:19.936648 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.core_materials
[0m14:21:19.941916 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.core_batches
[0m14:21:19.943630 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m14:21:19.946370 [info ] [Thread-3 (]: 2 of 3 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m14:21:19.950075 [info ] [Thread-4 (]: 3 of 3 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m14:21:19.954364 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_batches'
[0m14:21:19.957295 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.fct_production_orders'
[0m14:21:19.959626 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.core_batches
[0m14:21:19.962356 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m14:21:19.972872 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m14:21:19.982949 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m14:21:19.998097 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.core_batches
[0m14:21:20.015342 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m14:21:20.016835 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m14:21:20.028124 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m14:21:20.047520 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m14:21:20.055168 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m14:21:20.057400 [debug] [Thread-3 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m14:21:20.060671 [debug] [Thread-4 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m14:21:20.063488 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:21:20.066273 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:21:20.340087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b346b811910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b346b5799d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b346b86b440>]}


============================== 14:21:20.354830 | f3f95b44-8ff3-4d8b-b6a5-1a3bb29c7151 ==============================
[0m14:21:20.354830 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:21:20.357298 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'fail_fast': 'False', 'quiet': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'version_check': 'True', 'warn_error': 'None', 'write_json': 'True', 'debug': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'empty': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_colors': 'True', 'cache_selected_only': 'False'}
[0m14:21:21.512877 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:21:21.514817 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:21:21.516600 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:21:21.799779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3f95b44-8ff3-4d8b-b6a5-1a3bb29c7151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b344d62eba0>]}
[0m14:21:21.907111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3f95b44-8ff3-4d8b-b6a5-1a3bb29c7151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b344d53f380>]}
[0m14:21:21.910011 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:21:22.090525 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:21:22.302985 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.239 seconds
[0m14:21:22.310589 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3616d2d-0b50-4ee6-98d3-48aef18484f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c04f4d4500>]}
[0m14:21:22.313152 [info ] [Thread-3 (]: 2 of 3 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 2.36s]
[0m14:21:22.315822 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.core_batches
[0m14:21:22.401177 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.335 seconds
[0m14:21:22.407933 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3616d2d-0b50-4ee6-98d3-48aef18484f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c04efc49b0>]}
[0m14:21:22.410024 [info ] [Thread-4 (]: 3 of 3 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 2.45s]
[0m14:21:22.412408 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m14:21:22.417061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:22.419263 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_materials' was left open.
[0m14:21:22.421095 [debug] [MainThread]: On model.mfg_accelerator.core_materials: Close
[0m14:21:22.445083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:21:22.447060 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:21:22.524391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3f95b44-8ff3-4d8b-b6a5-1a3bb29c7151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b344d146f60>]}
[0m14:21:22.698633 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:21:22.706928 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:21:22.747895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3f95b44-8ff3-4d8b-b6a5-1a3bb29c7151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b344cef1a90>]}
[0m14:21:22.749720 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:21:22.751473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3f95b44-8ff3-4d8b-b6a5-1a3bb29c7151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b344d281580>]}
[0m14:21:22.756585 [info ] [MainThread]: 
[0m14:21:22.758440 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:21:22.760058 [info ] [MainThread]: 
[0m14:21:22.761994 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:21:22.770161 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m14:21:22.832103 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m14:21:22.833800 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m14:21:22.835595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:22.890494 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m14:21:22.891939 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m14:21:23.332184 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m14:21:23.333889 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m14:21:23.783045 [info ] [MainThread]: 
[0m14:21:23.784545 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.80 seconds (7.80s).
[0m14:21:23.787580 [debug] [MainThread]: Command end result
[0m14:21:23.853265 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:21:23.860867 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:21:23.876324 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:21:23.877787 [info ] [MainThread]: 
[0m14:21:23.879744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:23.881297 [info ] [MainThread]: 
[0m14:21:23.883233 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:21:23.886440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.138236, "process_in_blocks": "0", "process_kernel_time": 1.491554, "process_mem_max_rss": "219348", "process_out_blocks": "16", "process_user_time": 6.740213}
[0m14:21:23.888447 [debug] [MainThread]: Command `dbt run` succeeded at 14:21:23.888273 after 11.14 seconds
[0m14:21:23.890089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c031aef6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c051063b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c04f6eca70>]}
[0m14:21:23.891733 [debug] [MainThread]: Flushing usage events
[0m14:21:24.322028 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.486 seconds
[0m14:21:24.326195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m14:21:24.341458 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:21:24.343011 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:21:24.572139 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:24.619009 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.274 seconds
[0m14:21:24.628377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3f95b44-8ff3-4d8b-b6a5-1a3bb29c7151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b344c1e6450>]}
[0m14:21:24.637865 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.stg_batches
[0m14:21:24.639209 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.stg_materials
[0m14:21:24.640146 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.stg_production_orders
[0m14:21:24.642524 [info ] [Thread-1 (]: 1 of 8 START sql view model ANALYTICS_analytics.stg_batches .................... [RUN]
[0m14:21:24.644540 [info ] [Thread-2 (]: 2 of 8 START sql view model ANALYTICS_analytics.stg_materials .................. [RUN]
[0m14:21:24.646884 [info ] [Thread-3 (]: 3 of 8 START sql view model ANALYTICS_analytics.stg_production_orders .......... [RUN]
[0m14:21:24.649126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.stg_batches)
[0m14:21:24.651579 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_materials'
[0m14:21:24.654035 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.mfg_accelerator.stg_production_orders'
[0m14:21:24.656901 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.stg_batches
[0m14:21:24.659867 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.stg_materials
[0m14:21:24.662709 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.stg_production_orders
[0m14:21:24.687620 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.stg_batches"
[0m14:21:24.820500 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.stg_materials"
[0m14:21:24.828051 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.stg_production_orders"
[0m14:21:24.847090 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.stg_batches
[0m14:21:24.848315 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.stg_materials
[0m14:21:24.850389 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.stg_production_orders
[0m14:21:25.003654 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.stg_batches"
[0m14:21:25.033809 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.stg_materials"
[0m14:21:25.036149 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.stg_production_orders"
[0m14:21:25.050848 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.stg_batches"
[0m14:21:25.054087 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.stg_materials"
[0m14:21:25.063563 [debug] [Thread-2 (]: On model.mfg_accelerator.stg_materials: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
  
  
  
  
  as (
    -- stg_materials.sql
-- Purpose:
--  - Create a clean, standardized view of materials
--  - Apply basic typing and naming conventions
--  - This is the first "T" step after RAW

with source as (

    -- Pull data from the RAW.MATERIALS table registered as a source
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        status,
        created_at
    from MFG_ACCELERATOR.RAW.materials

),

renamed as (

    -- Apply any renaming / typing here
    select
        material_id                as material_id,        -- keep same, but explicitly select
        material_name              as material_name,
        material_type              as material_type,
        unit_of_measure            as unit_of_measure,
        status                     as material_status,    -- rename to avoid generic 'status'
        cast(created_at as date)   as created_at
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_materials"} */;
[0m14:21:25.060064 [debug] [Thread-1 (]: On model.mfg_accelerator.stg_batches: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
  
  
  
  
  as (
    -- stg_batches.sql
-- Purpose:
--  - Clean and standardize batch data
--  - Ensure dates and numeric types are correct

with source as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.RAW.batches

),

renamed as (

    select
        batch_id                         as batch_id,
        material_id                      as material_id,
        manufacturing_site               as manufacturing_site,
        cast(manufacture_date as date)   as manufacture_date,
        cast(expiry_date as date)        as expiry_date,
        cast(quantity as number)         as quantity,
        batch_status                     as batch_status
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_batches"} */;
[0m14:21:25.057801 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.stg_production_orders"
[0m14:21:25.066390 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:21:25.075118 [debug] [Thread-3 (]: On model.mfg_accelerator.stg_production_orders: create or replace   view MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
  
  
  
  
  as (
    -- stg_production_orders.sql
-- Purpose:
--  - Clean and standardize production order data
--  - Ensure date fields and statuses are typed and named consistently

with source as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.RAW.production_orders

),

renamed as (

    select
        order_id                               as order_id,
        batch_id                               as batch_id,
        order_type                             as order_type,
        cast(planned_start_date as date)       as planned_start_date,
        cast(planned_end_date as date)         as planned_end_date,
        cast(actual_start_date as date)        as actual_start_date,
        cast(actual_end_date as date)          as actual_end_date,
        order_status                           as order_status,
        line_id                                as line_id
    from source

)

select * from renamed
  )
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.stg_production_orders"} */;
[0m14:21:25.085827 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:21:25.450776 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.381 seconds
[0m14:21:25.494560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3f95b44-8ff3-4d8b-b6a5-1a3bb29c7151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b346cede5d0>]}
[0m14:21:25.497005 [info ] [Thread-1 (]: 1 of 8 OK created sql view model ANALYTICS_analytics.stg_batches ............... [[32mSUCCESS 1[0m in 0.84s]
[0m14:21:25.499474 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.stg_batches
[0m14:21:26.400560 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.315 seconds
[0m14:21:26.407173 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3f95b44-8ff3-4d8b-b6a5-1a3bb29c7151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3447f50200>]}
[0m14:21:26.410844 [info ] [Thread-3 (]: 3 of 8 OK created sql view model ANALYTICS_analytics.stg_production_orders ..... [[32mSUCCESS 1[0m in 1.75s]
[0m14:21:26.412767 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.stg_production_orders
[0m14:21:26.441314 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.375 seconds
[0m14:21:26.446568 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3f95b44-8ff3-4d8b-b6a5-1a3bb29c7151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3447f08110>]}
[0m14:21:26.454902 [info ] [Thread-2 (]: 2 of 8 OK created sql view model ANALYTICS_analytics.stg_materials ............. [[32mSUCCESS 1[0m in 1.80s]
[0m14:21:26.457022 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.stg_materials
[0m14:21:26.459786 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.core_materials
[0m14:21:26.461955 [info ] [Thread-4 (]: 4 of 8 START sql table model ANALYTICS_analytics.core_materials ................ [RUN]
[0m14:21:26.463962 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.mfg_accelerator.core_materials'
[0m14:21:26.465855 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.core_materials
[0m14:21:26.472083 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.core_materials"
[0m14:21:26.486546 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.core_materials
[0m14:21:26.526537 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.core_materials"
[0m14:21:26.544487 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.core_materials"
[0m14:21:26.546407 [debug] [Thread-4 (]: On model.mfg_accelerator.core_materials: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
    
    
    
    as (-- core_materials.sql
-- Purpose:
--  - Create a cleaned, enriched material dimension
--  - Add simple derived attributes (e.g. is_active flag, age)

with base as (

    -- Use the staging view as the single source of truth for materials
    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,
        created_at
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials

),

enriched as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        material_status,

        created_at,

        -- Age of the material definition in days
        datediff('day', created_at, current_date()) as material_age_days,

        -- Simple flag to say if the material is considered active
        case
            when upper(material_status) = 'ACTIVE' then 1
            else 0
        end as is_active_material
    from base

)

select * from enriched
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_materials"} */;
[0m14:21:26.548174 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:21:28.464915 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.917 seconds
[0m14:21:28.470326 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3f95b44-8ff3-4d8b-b6a5-1a3bb29c7151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3447f52060>]}
[0m14:21:28.472307 [info ] [Thread-4 (]: 4 of 8 OK created sql table model ANALYTICS_analytics.core_materials ........... [[32mSUCCESS 1[0m in 2.01s]
[0m14:21:28.474314 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.core_materials
[0m14:21:28.476756 [debug] [Thread-3 (]: Began running node model.mfg_accelerator.core_batches
[0m14:21:28.477438 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.fct_production_orders
[0m14:21:28.479218 [info ] [Thread-3 (]: 5 of 8 START sql table model ANALYTICS_analytics.core_batches .................. [RUN]
[0m14:21:28.481082 [info ] [Thread-2 (]: 6 of 8 START sql table model ANALYTICS_analytics.fct_production_orders ......... [RUN]
[0m14:21:28.483170 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_production_orders, now model.mfg_accelerator.core_batches)
[0m14:21:28.484974 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_materials, now model.mfg_accelerator.fct_production_orders)
[0m14:21:28.486676 [debug] [Thread-3 (]: Began compiling node model.mfg_accelerator.core_batches
[0m14:21:28.488458 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.fct_production_orders
[0m14:21:28.493696 [debug] [Thread-3 (]: Writing injected SQL for node "model.mfg_accelerator.core_batches"
[0m14:21:28.499612 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.fct_production_orders"
[0m14:21:28.509383 [debug] [Thread-3 (]: Began executing node model.mfg_accelerator.core_batches
[0m14:21:28.510779 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.fct_production_orders
[0m14:21:28.515466 [debug] [Thread-3 (]: Writing runtime sql for node "model.mfg_accelerator.core_batches"
[0m14:21:28.520595 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.fct_production_orders"
[0m14:21:28.534620 [debug] [Thread-3 (]: Using snowflake connection "model.mfg_accelerator.core_batches"
[0m14:21:28.538373 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.fct_production_orders"
[0m14:21:28.540061 [debug] [Thread-3 (]: On model.mfg_accelerator.core_batches: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    
    
    
    as (-- core_batches.sql
-- Purpose:
--  - Combine batch info with material attributes
--  - Add shelf-life and expiry-related metrics

with batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        b.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        -- Shelf life in days = expiry - manufacture
        datediff('day', manufacture_date, expiry_date) as shelf_life_days,

        -- Batch age in days from manufacture date until today
        datediff('day', manufacture_date, current_date()) as batch_age_days,

        -- Days until expiry (can be negative if already expired)
        datediff('day', current_date(), expiry_date) as days_to_expiry,

        case
            when current_date() > expiry_date then 1
            else 0
        end as is_expired
    from batches b
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.core_batches"} */;
[0m14:21:28.541981 [debug] [Thread-2 (]: On model.mfg_accelerator.fct_production_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    
    
    
    as (-- fct_production_orders.sql
-- Purpose:
--  - Fact-like table combining production orders with batch and material context
--  - Compute planned vs actual durations and simple on-time indicators

with orders as (

    select
        order_id,
        batch_id,
        order_type,
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        order_status,
        line_id
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders

),

batches as (

    select
        batch_id,
        material_id,
        manufacturing_site,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches

),

materials as (

    select
        material_id,
        material_name,
        material_type,
        unit_of_measure
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

joined as (

    select
        o.order_id,
        o.batch_id,
        b.material_id,

        m.material_name,
        m.material_type,
        m.unit_of_measure,

        b.manufacturing_site,
        b.manufacture_date,
        b.expiry_date,
        b.quantity,
        b.batch_status,

        o.order_type,
        o.line_id,
        o.order_status,

        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        -- Planned duration in days
        datediff('day', planned_start_date, planned_end_date) as planned_duration_days,

        -- Actual duration in days (null if no end date)
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', actual_start_date, actual_end_date)
            else null
        end as actual_duration_days,

        -- Delay vs plan: how many days longer the actual duration was
        case
            when actual_start_date is not null
             and actual_end_date is not null
            then datediff('day', planned_end_date, actual_end_date)
            else null
        end as delay_vs_plan_days,

        -- Simple late flag: 1 if order completed after planned_end_date
        case
            when actual_end_date is not null
             and actual_end_date > planned_end_date
            then 1
            else 0
        end as is_late,

        -- Is the order completed?
        case
            when upper(order_status) = 'COMPLETED' then 1
            else 0
        end as is_completed
    from orders o
    left join batches b
        on o.batch_id = b.batch_id
    left join materials m
        on b.material_id = m.material_id

)

select * from joined
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.fct_production_orders"} */;
[0m14:21:29.464312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da2868a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da1e352e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da2d36ea0>]}


============================== 14:21:29.476221 | fd5441e4-5b54-4613-a19e-38f49806c661 ==============================
[0m14:21:29.476221 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:21:29.478126 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'invocation_command': 'dbt run --select marts --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'empty': 'False', 'quiet': 'False', 'warn_error': 'None', 'write_json': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'no_print': 'None', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'static_parser': 'True', 'log_cache_events': 'False'}
[0m14:21:30.109498 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.565 seconds
[0m14:21:30.114487 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3f95b44-8ff3-4d8b-b6a5-1a3bb29c7151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3447fcfc80>]}
[0m14:21:30.116632 [info ] [Thread-3 (]: 5 of 8 OK created sql table model ANALYTICS_analytics.core_batches ............. [[32mSUCCESS 1[0m in 1.63s]
[0m14:21:30.119121 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.573 seconds
[0m14:21:30.121034 [debug] [Thread-3 (]: Finished running node model.mfg_accelerator.core_batches
[0m14:21:30.128254 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3f95b44-8ff3-4d8b-b6a5-1a3bb29c7151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b344d260b30>]}
[0m14:21:30.132208 [info ] [Thread-2 (]: 6 of 8 OK created sql table model ANALYTICS_analytics.fct_production_orders .... [[32mSUCCESS 1[0m in 1.64s]
[0m14:21:30.134362 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.fct_production_orders
[0m14:21:30.137169 [debug] [Thread-4 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:21:30.138118 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:21:30.139912 [info ] [Thread-4 (]: 7 of 8 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m14:21:30.142023 [info ] [Thread-1 (]: 8 of 8 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m14:21:30.144232 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.core_materials, now model.mfg_accelerator.mfg_ml_features_orders)
[0m14:21:30.146177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mfg_accelerator.stg_batches, now model.mfg_accelerator.mfg_plant_daily_kpis)
[0m14:21:30.148082 [debug] [Thread-4 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m14:21:30.149952 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:21:30.158377 [debug] [Thread-4 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:21:30.167710 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:21:30.178343 [debug] [Thread-4 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m14:21:30.180181 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:21:30.184876 [debug] [Thread-4 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:21:30.190768 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:21:30.204848 [debug] [Thread-4 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:21:30.206860 [debug] [Thread-4 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m14:21:30.212179 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:21:30.217076 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m14:21:30.365553 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:21:30.367841 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:21:30.369794 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:21:30.666177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd5441e4-5b54-4613-a19e-38f49806c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d84ff22d0>]}
[0m14:21:30.762920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd5441e4-5b54-4613-a19e-38f49806c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da25c7230>]}
[0m14:21:30.765273 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:21:30.980703 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:21:31.370955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:21:31.372935 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:21:31.454891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd5441e4-5b54-4613-a19e-38f49806c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d845f5a30>]}
[0m14:21:31.669434 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:21:31.679717 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:21:31.727497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd5441e4-5b54-4613-a19e-38f49806c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d8442c890>]}
[0m14:21:31.729550 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:21:31.731540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd5441e4-5b54-4613-a19e-38f49806c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da359d580>]}
[0m14:21:31.740040 [info ] [MainThread]: 
[0m14:21:31.742224 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:21:31.744068 [info ] [MainThread]: 
[0m14:21:31.746043 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:21:31.755180 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR'
[0m14:21:31.819705 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.606 seconds
[0m14:21:31.824472 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR"
[0m14:21:31.821227 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.602 seconds
[0m14:21:31.826194 [debug] [ThreadPool]: On list_MFG_ACCELERATOR: show terse schemas in database MFG_ACCELERATOR
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR"} */
[0m14:21:31.827728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:31.826071 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3f95b44-8ff3-4d8b-b6a5-1a3bb29c7151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3447fc1bb0>]}
[0m14:21:31.831233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3f95b44-8ff3-4d8b-b6a5-1a3bb29c7151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3447f44b60>]}
[0m14:21:31.833802 [info ] [Thread-4 (]: 7 of 8 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 1.68s]
[0m14:21:31.835895 [info ] [Thread-1 (]: 8 of 8 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 1.69s]
[0m14:21:31.837997 [debug] [Thread-4 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:21:31.840076 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:21:31.846158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:31.850513 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m14:21:31.852478 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m14:21:32.316813 [debug] [MainThread]: Connection 'model.mfg_accelerator.fct_production_orders' was left open.
[0m14:21:32.318503 [debug] [MainThread]: On model.mfg_accelerator.fct_production_orders: Close
[0m14:21:32.791323 [debug] [MainThread]: Connection 'model.mfg_accelerator.core_batches' was left open.
[0m14:21:32.793451 [debug] [MainThread]: On model.mfg_accelerator.core_batches: Close
[0m14:21:33.101308 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.276 seconds
[0m14:21:33.106029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR, now list_MFG_ACCELERATOR_ANALYTICS_analytics)
[0m14:21:33.124972 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:21:33.126646 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:21:33.269799 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m14:21:33.271762 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m14:21:33.430064 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.301 seconds
[0m14:21:33.436382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd5441e4-5b54-4613-a19e-38f49806c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d8479c5c0>]}
[0m14:21:33.443501 [debug] [Thread-1 (]: Began running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:21:33.444157 [debug] [Thread-2 (]: Began running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:21:33.445732 [info ] [Thread-1 (]: 1 of 2 START sql table model ANALYTICS_analytics.mfg_ml_features_orders ........ [RUN]
[0m14:21:33.447488 [info ] [Thread-2 (]: 2 of 2 START sql table model ANALYTICS_analytics.mfg_plant_daily_kpis .......... [RUN]
[0m14:21:33.449457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now model.mfg_accelerator.mfg_ml_features_orders)
[0m14:21:33.451565 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.mfg_accelerator.mfg_plant_daily_kpis'
[0m14:21:33.453141 [debug] [Thread-1 (]: Began compiling node model.mfg_accelerator.mfg_ml_features_orders
[0m14:21:33.454451 [debug] [Thread-2 (]: Began compiling node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:21:33.464927 [debug] [Thread-1 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:21:33.546139 [debug] [Thread-2 (]: Writing injected SQL for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:21:33.553888 [debug] [Thread-1 (]: Began executing node model.mfg_accelerator.mfg_ml_features_orders
[0m14:21:33.555394 [debug] [Thread-2 (]: Began executing node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:21:33.618403 [debug] [Thread-1 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:21:33.619421 [debug] [Thread-2 (]: Writing runtime sql for node "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:21:33.633605 [debug] [Thread-1 (]: Using snowflake connection "model.mfg_accelerator.mfg_ml_features_orders"
[0m14:21:33.638236 [debug] [Thread-2 (]: Using snowflake connection "model.mfg_accelerator.mfg_plant_daily_kpis"
[0m14:21:33.639627 [debug] [Thread-1 (]: On model.mfg_accelerator.mfg_ml_features_orders: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
    
    
    
    as (-- mfg_ml_features_orders.sql
-- Purpose:
--  - Provide ML-ready features at order grain
--  - Target use case: predict late orders or delay vs plan
-- Grain:
--  - One row per production order (order_id)

with orders as (

    select
        order_id,
        batch_id,
        material_id,

        manufacturing_site,
        line_id,

        order_type,
        order_status,

        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,

        planned_duration_days,
        actual_duration_days,
        delay_vs_plan_days,
        is_late,
        is_completed
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders

),

materials as (

    select
        material_id,
        material_type,
        unit_of_measure,
        is_active_material
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials

),

batches as (

    select
        batch_id,
        manufacture_date,
        expiry_date,
        quantity,
        batch_status,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches

),

joined as (

    select
        o.order_id,

        -- Keys and IDs
        o.batch_id,
        o.material_id,

        -- Plant / line / type
        o.manufacturing_site,
        o.line_id,
        o.order_type,
        o.order_status,

        -- Material features
        m.material_type,
        m.unit_of_measure,
        m.is_active_material,

        -- Batch features
        b.quantity,
        b.batch_status,
        b.shelf_life_days,
        b.batch_age_days,
        b.days_to_expiry,
        b.is_expired,

        -- Temporal features
        o.planned_start_date,
        o.planned_end_date,
        o.actual_start_date,
        o.actual_end_date,

        o.planned_duration_days,
        o.actual_duration_days,
        o.delay_vs_plan_days,

        -- Labels / targets
        o.is_late,
        o.is_completed
    from orders o
    left join materials m
        on o.material_id = m.material_id
    left join batches b
        on o.batch_id = b.batch_id

),

final as (

    select
        -- Primary key
        order_id,

        -- Categorical features
        manufacturing_site,
        line_id,
        order_type,
        order_status,
        material_type,
        unit_of_measure,
        batch_status,

        -- Material state
        is_active_material,

        -- Quantitative batch features
        quantity,
        shelf_life_days,
        batch_age_days,
        days_to_expiry,
        is_expired,

        -- Temporal planning features
        planned_start_date,
        planned_end_date,
        actual_start_date,
        actual_end_date,
        planned_duration_days,
        actual_duration_days,

        -- Label / target variables
        delay_vs_plan_days,
        is_late,
        is_completed
    from joined
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_ml_features_orders"} */;
[0m14:21:33.641434 [debug] [Thread-2 (]: On model.mfg_accelerator.mfg_plant_daily_kpis: create or replace transient table MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
    
    
    
    as (-- mfg_plant_daily_kpis.sql
-- Purpose:
--  - Provide daily plant-level KPIs for manufacturing performance monitoring
--  - Aggregates metrics from core_batches and fct_production_orders
-- Grain:
--  - One row per (manufacturing_site, calendar_date)

with calendar_days as (

    -- Build a simple date spine based on manufacture_date and planned/actual dates
    -- This ensures we have a consistent daily grain for metrics.

    select
        -- Use the earliest relevant date from batches and orders
        least(
            min(b.manufacture_date),
            min(o.planned_start_date)
        ) as min_date,
        greatest(
            max(b.manufacture_date),
            max(o.planned_end_date)
        ) as max_date
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    cross join MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o

),

date_spine as (

    -- Generate a list of dates between min_date and max_date
    -- Snowflake-specific generator using TABLE(GENERATOR)
    select
        dateadd(
            day,
            seq4(),
            min_date
        ) as calendar_date
    from calendar_days,
         table(generator(rowcount => datediff('day', min_date, max_date) + 1))

),

batches_by_day as (

    -- Aggregate batch metrics at (manufacturing_site, calendar_date)
    select
        b.manufacturing_site,
        b.manufacture_date as calendar_date,

        count(*) as total_batches,
        sum(b.quantity) as total_quantity,

        sum(case when b.is_expired = 1 then 1 else 0 end) as expired_batches
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
    group by
        b.manufacturing_site,
        b.manufacture_date

),

orders_by_day as (

    -- Aggregate order metrics at (manufacturing_site, calendar_date)
    -- We'll use planned_start_date as the main "date" for the order
    select
        b.manufacturing_site,
        o.planned_start_date as calendar_date,

        count(*) as total_orders,
        sum(case when o.is_completed = 1 then 1 else 0 end) as completed_orders,
        sum(case when o.is_late = 1 then 1 else 0 end) as late_orders,

        avg(o.delay_vs_plan_days) as avg_delay_vs_plan_days
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders o
    left join MFG_ACCELERATOR.ANALYTICS_analytics.core_batches b
        on o.batch_id = b.batch_id
    group by
        b.manufacturing_site,
        o.planned_start_date

),

combined as (

    -- Combine batch and order metrics on (site, date)
    select
        coalesce(b.manufacturing_site, o.manufacturing_site) as manufacturing_site,
        coalesce(b.calendar_date, o.calendar_date) as calendar_date,

        -- Batch metrics
        coalesce(b.total_batches, 0) as total_batches,
        coalesce(b.total_quantity, 0) as total_quantity,
        coalesce(b.expired_batches, 0) as expired_batches,

        -- Order metrics
        coalesce(o.total_orders, 0) as total_orders,
        coalesce(o.completed_orders, 0) as completed_orders,
        coalesce(o.late_orders, 0) as late_orders,
        o.avg_delay_vs_plan_days as avg_delay_vs_plan_days
    from batches_by_day b
    full outer join orders_by_day o
        on  b.manufacturing_site = o.manufacturing_site
        and b.calendar_date = o.calendar_date

),

final as (

    select
        manufacturing_site,
        calendar_date,

        total_batches,
        total_quantity,
        expired_batches,

        total_orders,
        completed_orders,
        late_orders,
        avg_delay_vs_plan_days,

        -- On-time rate: percentage of completed orders that were not late
        case
            when completed_orders > 0 then
                1.0 - (late_orders::float / completed_orders::float)
            else null
        end as on_time_rate
    from combined
    where manufacturing_site is not null
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "model.mfg_accelerator.mfg_plant_daily_kpis"} */;
[0m14:21:33.645531 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:21:33.710498 [info ] [MainThread]: 
[0m14:21:33.712367 [info ] [MainThread]: Finished running 5 table models, 3 view models in 0 hours 0 minutes and 10.95 seconds (10.95s).
[0m14:21:33.715809 [debug] [MainThread]: Command end result
[0m14:21:33.779138 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:21:33.786941 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:21:33.801758 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:21:33.803190 [info ] [MainThread]: 
[0m14:21:33.804588 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:33.805906 [info ] [MainThread]: 
[0m14:21:33.807277 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m14:21:33.809225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.750022, "process_in_blocks": "0", "process_kernel_time": 1.622766, "process_mem_max_rss": "220836", "process_out_blocks": "16", "process_user_time": 8.251421}
[0m14:21:33.810549 [debug] [MainThread]: Command `dbt run` succeeded at 14:21:33.810435 after 13.75 seconds
[0m14:21:33.811793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b346a52c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b346b5799d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b346b868ad0>]}
[0m14:21:33.812947 [debug] [MainThread]: Flushing usage events
[0m14:21:34.581777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:34.633651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.990 seconds
[0m14:21:34.670934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5441e4-5b54-4613-a19e-38f49806c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da2cf9be0>]}
[0m14:21:34.673659 [info ] [Thread-1 (]: 1 of 2 OK created sql table model ANALYTICS_analytics.mfg_ml_features_orders ... [[32mSUCCESS 1[0m in 1.22s]
[0m14:21:34.676219 [debug] [Thread-1 (]: Finished running node model.mfg_accelerator.mfg_ml_features_orders
[0m14:21:35.696513 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.051 seconds
[0m14:21:35.701507 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5441e4-5b54-4613-a19e-38f49806c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d847385c0>]}
[0m14:21:35.703472 [info ] [Thread-2 (]: 2 of 2 OK created sql table model ANALYTICS_analytics.mfg_plant_daily_kpis ..... [[32mSUCCESS 1[0m in 2.25s]
[0m14:21:35.705637 [debug] [Thread-2 (]: Finished running node model.mfg_accelerator.mfg_plant_daily_kpis
[0m14:21:35.709672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:35.711287 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_ml_features_orders' was left open.
[0m14:21:35.712951 [debug] [MainThread]: On model.mfg_accelerator.mfg_ml_features_orders: Close
[0m14:21:36.177070 [debug] [MainThread]: Connection 'model.mfg_accelerator.mfg_plant_daily_kpis' was left open.
[0m14:21:36.179251 [debug] [MainThread]: On model.mfg_accelerator.mfg_plant_daily_kpis: Close
[0m14:21:36.642816 [info ] [MainThread]: 
[0m14:21:36.644670 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m14:21:36.647168 [debug] [MainThread]: Command end result
[0m14:21:36.720470 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:21:36.729608 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:21:36.745337 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:21:36.746972 [info ] [MainThread]: 
[0m14:21:36.748549 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:36.750816 [info ] [MainThread]: 
[0m14:21:36.753327 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:21:36.757959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.447328, "process_in_blocks": "0", "process_kernel_time": 1.346913, "process_mem_max_rss": "217220", "process_out_blocks": "16", "process_user_time": 5.199806}
[0m14:21:36.760437 [debug] [MainThread]: Command `dbt run` succeeded at 14:21:36.760197 after 7.45 seconds
[0m14:21:36.762542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736da24571a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d84a9d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d843a64e0>]}
[0m14:21:36.764373 [debug] [MainThread]: Flushing usage events
[0m14:21:37.363852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:39.989190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb710e630b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb711896f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb711ad76b0>]}


============================== 14:21:39.999744 | 70fbb18a-cbef-4ad8-acd9-9fff2c31a30e ==============================
[0m14:21:39.999744 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:21:40.002140 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_profiles', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'printer_width': '80', 'empty': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None'}
[0m14:21:41.019633 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:21:41.021880 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:21:41.023878 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:21:41.341706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70fbb18a-cbef-4ad8-acd9-9fff2c31a30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6f4317c50>]}
[0m14:21:41.439277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70fbb18a-cbef-4ad8-acd9-9fff2c31a30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ef9da720>]}
[0m14:21:41.442171 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:21:41.646276 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:21:42.018170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:21:42.020203 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:21:42.104710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70fbb18a-cbef-4ad8-acd9-9fff2c31a30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ef818740>]}
[0m14:21:42.285374 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:21:42.298907 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:21:42.355240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70fbb18a-cbef-4ad8-acd9-9fff2c31a30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ef2630e0>]}
[0m14:21:42.357152 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:21:42.358886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70fbb18a-cbef-4ad8-acd9-9fff2c31a30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ef38fc80>]}
[0m14:21:42.364355 [info ] [MainThread]: 
[0m14:21:42.366243 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:21:42.368065 [info ] [MainThread]: 
[0m14:21:42.370186 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:21:42.378808 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m14:21:42.452545 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:21:42.455335 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:21:42.457213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:42.518663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b95ee9a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9608bf6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b960ada960>]}


============================== 14:21:42.529078 | 3b2c84a4-dad6-4a27-8391-f3b13ff3fcbb ==============================
[0m14:21:42.529078 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:21:42.531323 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'version_check': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'write_json': 'True', 'debug': 'False', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles', 'profiles_dir': '/opt/airflow/dbt_profiles', 'quiet': 'False', 'empty': 'None', 'no_print': 'None'}
[0m14:21:43.375543 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:21:43.377350 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:21:43.379049 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:21:43.654612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b2c84a4-dad6-4a27-8391-f3b13ff3fcbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9411fa450>]}
[0m14:21:43.745404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b2c84a4-dad6-4a27-8391-f3b13ff3fcbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b940a85550>]}
[0m14:21:43.747775 [info ] [MainThread]: Registered adapter: snowflake=1.10.4
[0m14:21:43.900086 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.443 seconds
[0m14:21:43.906723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70fbb18a-cbef-4ad8-acd9-9fff2c31a30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6f42ec200>]}
[0m14:21:43.914893 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:21:43.916279 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:21:43.917136 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:21:43.917882 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:21:43.918706 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:21:43.920049 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m14:21:43.921972 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m14:21:43.923945 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m14:21:43.925861 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m14:21:43.928248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m14:21:43.930361 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m14:21:43.932233 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m14:21:43.934249 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m14:21:43.935986 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:21:43.937663 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:21:43.939354 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:21:43.940965 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:21:43.973433 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:21:43.976401 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:21:43.983637 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:21:43.990486 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:21:44.001671 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:21:44.002402 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:21:44.004225 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:21:44.016461 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:21:44.051708 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:21:44.064367 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:21:44.065879 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:21:44.071364 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:21:44.083747 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:21:44.085179 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:21:44.086912 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m14:21:44.089071 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:21:44.090519 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:21:44.091832 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m14:21:44.096406 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m14:21:44.098220 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m14:21:44.099930 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:21:44.101740 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:21:44.103473 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:21:44.305863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:21:44.311027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:21:44.382211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b2c84a4-dad6-4a27-8391-f3b13ff3fcbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b940a74230>]}
[0m14:21:44.399326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.305 seconds
[0m14:21:44.413446 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.49s]
[0m14:21:44.415657 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:21:44.417385 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:21:44.419246 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m14:21:44.421093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m14:21:44.422789 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:21:44.429915 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:21:44.445890 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:21:44.451183 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:21:44.471810 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:21:44.474032 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m14:21:44.586181 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:21:44.595159 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:21:44.648809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b2c84a4-dad6-4a27-8391-f3b13ff3fcbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b940891b50>]}
[0m14:21:44.650476 [info ] [MainThread]: Found 8 models, 24 data tests, 3 sources, 504 macros
[0m14:21:44.652217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b2c84a4-dad6-4a27-8391-f3b13ff3fcbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b940984980>]}
[0m14:21:44.657782 [info ] [MainThread]: 
[0m14:21:44.659458 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:21:44.660976 [info ] [MainThread]: 
[0m14:21:44.662868 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:21:44.671324 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MFG_ACCELERATOR_ANALYTICS_analytics'
[0m14:21:44.736804 [debug] [ThreadPool]: Using snowflake connection "list_MFG_ACCELERATOR_ANALYTICS_analytics"
[0m14:21:44.738799 [debug] [ThreadPool]: On list_MFG_ACCELERATOR_ANALYTICS_analytics: show objects in MFG_ACCELERATOR.ANALYTICS_analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "connection_name": "list_MFG_ACCELERATOR_ANALYTICS_analytics"} */;
[0m14:21:44.740776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:44.871207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.395 seconds
[0m14:21:44.875474 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.45s]
[0m14:21:44.877634 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:21:44.879411 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:21:44.881274 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m14:21:44.883162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m14:21:44.884861 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:21:44.891721 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:21:44.905694 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:21:44.910343 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:21:44.925567 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:21:44.927353 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m14:21:45.294946 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.366 seconds
[0m14:21:45.302502 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.42s]
[0m14:21:45.304545 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:21:45.306098 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:21:45.307693 [info ] [Thread-1 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m14:21:45.309396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m14:21:45.310898 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:21:45.317888 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:21:45.338120 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:21:45.345233 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:21:45.360532 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:21:45.362130 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m14:21:45.571241 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.470 seconds
[0m14:21:45.574874 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.64s]
[0m14:21:45.576759 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:21:45.578240 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:21:45.579688 [info ] [Thread-4 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m14:21:45.581322 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m14:21:45.582868 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:21:45.589066 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:21:45.601999 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:21:45.606347 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:21:45.620469 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:21:45.622091 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m14:21:45.630407 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.530 seconds
[0m14:21:45.634822 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.70s]
[0m14:21:45.647662 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:21:45.654670 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:21:45.657394 [info ] [Thread-3 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m14:21:45.659317 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m14:21:45.661212 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:21:45.667714 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:21:45.675915 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.572 seconds
[0m14:21:45.679586 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.75s]
[0m14:21:45.681632 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:21:45.682324 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:21:45.683762 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:21:45.688536 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:21:45.690184 [info ] [Thread-2 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m14:21:45.693162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m14:21:45.694705 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:21:45.700824 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:21:45.709941 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:21:45.711646 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m14:21:45.715221 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:21:45.722119 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:21:45.724047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.360 seconds
[0m14:21:45.728983 [info ] [Thread-1 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 0.42s]
[0m14:21:45.731191 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:21:45.733187 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:21:45.735779 [info ] [Thread-1 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m14:21:45.737975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m14:21:45.740101 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:21:45.747774 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:21:45.746850 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:21:45.749687 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m14:21:45.767020 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:21:45.772947 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:21:45.788190 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:21:45.789594 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m14:21:45.896946 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.273 seconds
[0m14:21:45.902136 [info ] [Thread-4 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 0.32s]
[0m14:21:45.904809 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:21:45.906923 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:21:45.908891 [info ] [Thread-4 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m14:21:45.910660 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m14:21:45.912562 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:21:45.921561 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:21:45.936011 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:21:45.942775 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:21:45.957794 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:21:45.959278 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m14:21:46.049568 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.336 seconds
[0m14:21:46.053599 [info ] [Thread-3 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.39s]
[0m14:21:46.055486 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:21:46.057049 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:21:46.058544 [info ] [Thread-3 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m14:21:46.060221 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m14:21:46.061730 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:21:46.069280 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m14:21:46.070281 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:21:46.073760 [info ] [Thread-2 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.38s]
[0m14:21:46.076699 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:21:46.078291 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:21:46.079730 [info ] [Thread-2 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m14:21:46.081439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m14:21:46.082932 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:21:46.094956 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:21:46.097454 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:21:46.102233 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:21:46.110579 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:21:46.115612 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:21:46.118480 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.327 seconds
[0m14:21:46.121225 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:21:46.125343 [info ] [Thread-1 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.39s]
[0m14:21:46.127220 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m14:21:46.129167 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:21:46.134366 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:21:46.135599 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:21:46.137591 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m14:21:46.139188 [info ] [Thread-1 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m14:21:46.143143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m14:21:46.144717 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:21:46.153338 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:21:46.166799 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:21:46.171688 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:21:46.184545 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:21:46.185908 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m14:21:46.287963 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.327 seconds
[0m14:21:46.290986 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.550 seconds
[0m14:21:46.292356 [info ] [Thread-4 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.38s]
[0m14:21:46.294521 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:21:46.296330 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:21:46.297911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b2c84a4-dad6-4a27-8391-f3b13ff3fcbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b940633e00>]}
[0m14:21:46.298029 [info ] [Thread-4 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m14:21:46.300049 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m14:21:46.301877 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:21:46.306400 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:21:46.310195 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:21:46.307221 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:21:46.307956 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:21:46.308870 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:21:46.310239 [info ] [Thread-1 (]: 1 of 24 START test not_null_core_batches_batch_id .............................. [RUN]
[0m14:21:46.312095 [info ] [Thread-2 (]: 2 of 24 START test not_null_core_batches_material_id ........................... [RUN]
[0m14:21:46.314285 [info ] [Thread-3 (]: 3 of 24 START test not_null_core_materials_material_id ......................... [RUN]
[0m14:21:46.316289 [info ] [Thread-4 (]: 4 of 24 START test not_null_fct_production_orders_batch_id ..................... [RUN]
[0m14:21:46.318396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_MFG_ACCELERATOR_ANALYTICS_analytics, now test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c)
[0m14:21:46.320178 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e'
[0m14:21:46.321764 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8'
[0m14:21:46.329009 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:21:46.323464 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1'
[0m14:21:46.326797 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:21:46.335528 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:21:46.328625 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:21:46.351924 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:21:46.353829 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m14:21:46.330156 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:21:46.331888 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:21:46.365071 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:21:46.367847 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:21:46.374143 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:21:46.381088 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:21:46.390999 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:21:46.392089 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:21:46.429336 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.299 seconds
[0m14:21:46.393008 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:21:46.433293 [info ] [Thread-3 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.37s]
[0m14:21:46.399517 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:21:46.437612 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:21:46.439365 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:21:46.429004 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:21:46.441324 [info ] [Thread-3 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m14:21:46.431057 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:21:46.443198 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m14:21:46.435996 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:21:46.441201 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:21:46.444940 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:21:46.452547 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"
[0m14:21:46.454748 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:21:46.454315 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"
[0m14:21:46.456283 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e"} */
[0m14:21:46.458219 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"
[0m14:21:46.464253 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.323 seconds
[0m14:21:46.459915 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"
[0m14:21:46.461134 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8"} */
[0m14:21:46.462883 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:21:46.469770 [info ] [Thread-2 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.39s]
[0m14:21:46.472136 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:21:46.473157 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:21:46.464746 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c"} */
[0m14:21:46.474772 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:21:46.479546 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:21:46.481336 [info ] [Thread-2 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m14:21:46.484142 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m14:21:46.486369 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:21:46.466420 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1"} */
[0m14:21:46.468150 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:21:46.498632 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:21:46.504865 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:21:46.506776 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m14:21:46.515331 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:21:46.496135 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:21:46.520835 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:21:46.534139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.347 seconds
[0m14:21:46.539839 [info ] [Thread-1 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.40s]
[0m14:21:46.542738 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:21:46.545591 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:21:46.546941 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:21:46.549108 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m14:21:46.551137 [info ] [Thread-1 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m14:21:46.556169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m14:21:46.558899 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:21:46.569090 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:21:46.592147 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:21:46.600225 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:21:46.616101 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:21:46.617620 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m14:21:46.785190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.305 seconds
[0m14:21:46.793250 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m14:21:46.799399 [info ] [Thread-4 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.50s]
[0m14:21:46.802484 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:21:46.804741 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:21:46.806638 [info ] [Thread-4 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m14:21:46.806988 [info ] [Thread-1 (]: 1 of 24 PASS not_null_core_batches_batch_id .................................... [[32mPASS[0m in 0.49s]
[0m14:21:46.809965 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m14:21:46.816442 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:21:46.816823 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c
[0m14:21:46.819522 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:21:46.821887 [info ] [Thread-1 (]: 5 of 24 START test not_null_fct_production_orders_order_id ..................... [RUN]
[0m14:21:46.824384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_batch_id.780d5b7f3c, now test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f)
[0m14:21:46.826560 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:21:46.826529 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:21:46.839234 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:21:46.840942 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:21:46.851457 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:21:46.853818 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:21:46.863631 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:21:46.867904 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:21:46.871169 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m14:21:46.879315 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"
[0m14:21:46.873035 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m14:21:46.881514 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f"} */
[0m14:21:46.880315 [info ] [Thread-2 (]: 18 of 24 PASS unique_core_batches_batch_id ..................................... [[32mPASS[0m in 0.40s]
[0m14:21:46.886760 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:21:46.888967 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:21:46.890575 [info ] [Thread-2 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m14:21:46.892531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m14:21:46.893812 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:21:46.900800 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:21:46.911923 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:21:46.919294 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:21:46.923126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.304 seconds
[0m14:21:46.924575 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.416 seconds
[0m14:21:46.929305 [info ] [Thread-1 (]: 19 of 24 PASS unique_core_materials_material_id ................................ [[32mPASS[0m in 0.37s]
[0m14:21:46.933960 [info ] [Thread-3 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.49s]
[0m14:21:46.936250 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:21:46.937848 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:21:46.939395 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:21:46.940873 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:21:46.942323 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m14:21:46.943843 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:21:46.945257 [info ] [Thread-1 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m14:21:46.948541 [info ] [Thread-3 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m14:21:46.950988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m14:21:46.952883 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m14:21:46.954851 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:21:46.956412 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:21:46.963763 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:21:46.970837 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:21:46.979761 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:21:46.985471 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:21:46.986246 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:21:46.992022 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:21:46.999999 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:21:47.002070 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:21:47.003254 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m14:21:47.004916 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m14:21:47.180407 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m14:21:47.180583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.297 seconds
[0m14:21:47.184401 [info ] [Thread-4 (]: 20 of 24 PASS unique_fct_production_orders_order_id ............................ [[32mPASS[0m in 0.37s]
[0m14:21:47.186448 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:21:47.188181 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:21:47.188397 [info ] [Thread-1 (]: 5 of 24 PASS not_null_fct_production_orders_order_id ........................... [[32mPASS[0m in 0.36s]
[0m14:21:47.189891 [info ] [Thread-4 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m14:21:47.190737 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f
[0m14:21:47.191784 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m14:21:47.192502 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:21:47.193447 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:21:47.194178 [info ] [Thread-1 (]: 6 of 24 START test not_null_mfg_ml_features_orders_order_id .................... [RUN]
[0m14:21:47.195911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_order_id.0c04f5f69f, now test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213)
[0m14:21:47.197541 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:21:47.201055 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:21:47.204585 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:21:47.211917 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:21:47.214384 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:21:47.218549 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:21:47.219526 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:21:47.228966 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:21:47.230535 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m14:21:47.231334 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"
[0m14:21:47.232955 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213"} */
[0m14:21:47.325430 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.379 seconds
[0m14:21:47.326527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m14:21:47.328060 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.322 seconds
[0m14:21:47.331448 [info ] [Thread-2 (]: 21 of 24 PASS unique_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 0.44s]
[0m14:21:47.335332 [info ] [Thread-1 (]: 22 of 24 PASS unique_stg_batches_batch_id ...................................... [[32mPASS[0m in 0.38s]
[0m14:21:47.338996 [info ] [Thread-3 (]: 23 of 24 PASS unique_stg_materials_material_id ................................. [[32mPASS[0m in 0.39s]
[0m14:21:47.341178 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:21:47.343315 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:21:47.345255 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:21:47.514436 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.280 seconds
[0m14:21:47.517895 [info ] [Thread-1 (]: 6 of 24 PASS not_null_mfg_ml_features_orders_order_id .......................... [[32mPASS[0m in 0.32s]
[0m14:21:47.519500 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213
[0m14:21:47.520943 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:21:47.522386 [info ] [Thread-1 (]: 7 of 24 START test not_null_mfg_plant_daily_kpis_calendar_date ................. [RUN]
[0m14:21:47.524084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_ml_features_orders_order_id.ddd26f3213, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8)
[0m14:21:47.525654 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:21:47.531413 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:21:47.543470 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.311 seconds
[0m14:21:47.546242 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:21:47.547943 [info ] [Thread-4 (]: 24 of 24 PASS unique_stg_production_orders_order_id ............................ [[32mPASS[0m in 0.36s]
[0m14:21:47.549634 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:21:47.554267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:47.554379 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:21:47.556182 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m14:21:47.557709 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m14:21:47.569585 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"
[0m14:21:47.571140 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select calendar_date
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where calendar_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8"} */
[0m14:21:47.702121 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.239 seconds
[0m14:21:47.706012 [info ] [Thread-2 (]: 2 of 24 PASS not_null_core_batches_material_id ................................. [[32mPASS[0m in 1.39s]
[0m14:21:47.708036 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e
[0m14:21:47.709670 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:21:47.711186 [info ] [Thread-2 (]: 8 of 24 START test not_null_mfg_plant_daily_kpis_manufacturing_site ............ [RUN]
[0m14:21:47.712597 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_batches_material_id.a67f04973e, now test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68)
[0m14:21:47.713897 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:21:47.719455 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:21:47.731991 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:21:47.735859 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:21:47.751261 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"
[0m14:21:47.752965 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manufacturing_site
from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_plant_daily_kpis
where manufacturing_site is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68"} */
[0m14:21:47.767101 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.299 seconds
[0m14:21:47.770560 [info ] [Thread-3 (]: 3 of 24 PASS not_null_core_materials_material_id ............................... [[32mPASS[0m in 1.45s]
[0m14:21:47.772547 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8
[0m14:21:47.774100 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:21:47.775592 [info ] [Thread-3 (]: 9 of 24 START test not_null_stg_batches_batch_id ............................... [RUN]
[0m14:21:47.777261 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_core_materials_material_id.9d0bd279c8, now test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0)
[0m14:21:47.778822 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:21:47.785715 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:21:47.787714 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.292 seconds
[0m14:21:47.791692 [info ] [Thread-4 (]: 4 of 24 PASS not_null_fct_production_orders_batch_id ........................... [[32mPASS[0m in 1.47s]
[0m14:21:47.793254 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1
[0m14:21:47.794891 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:21:47.796454 [info ] [Thread-4 (]: 10 of 24 START test not_null_stg_batches_material_id ........................... [RUN]
[0m14:21:47.798313 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_fct_production_orders_batch_id.951826d5b1, now test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c)
[0m14:21:47.799807 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:21:47.805519 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:21:47.807298 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:21:47.811782 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:21:47.820104 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:21:47.824699 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:21:47.827167 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"
[0m14:21:47.828899 [debug] [Thread-3 (]: On test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0"} */
[0m14:21:47.831114 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"
[0m14:21:47.833799 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c"} */
[0m14:21:47.876057 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m14:21:47.883352 [info ] [Thread-1 (]: 7 of 24 PASS not_null_mfg_plant_daily_kpis_calendar_date ....................... [[32mPASS[0m in 0.36s]
[0m14:21:47.887803 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8
[0m14:21:47.891124 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:21:47.893525 [info ] [Thread-1 (]: 11 of 24 START test not_null_stg_materials_material_id ......................... [RUN]
[0m14:21:47.895722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_calendar_date.f3e5277ac8, now test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89)
[0m14:21:47.897743 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:21:47.908423 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:21:47.927013 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:21:47.934321 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:21:47.950181 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"
[0m14:21:47.952166 [debug] [Thread-1 (]: On test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select material_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89"} */
[0m14:21:48.004799 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.250 seconds
[0m14:21:48.005426 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m14:21:48.007394 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m14:21:48.009995 [info ] [Thread-2 (]: 8 of 24 PASS not_null_mfg_plant_daily_kpis_manufacturing_site .................. [[32mPASS[0m in 0.30s]
[0m14:21:48.012833 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68
[0m14:21:48.015568 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:21:48.017474 [info ] [Thread-2 (]: 12 of 24 START test not_null_stg_production_orders_batch_id .................... [RUN]
[0m14:21:48.019655 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_mfg_plant_daily_kpis_manufacturing_site.1379b5ac68, now test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5)
[0m14:21:48.021599 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:21:48.027528 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:21:48.045349 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:21:48.056056 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:21:48.077768 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"
[0m14:21:48.080347 [debug] [Thread-2 (]: On test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select batch_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where batch_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5"} */
[0m14:21:48.118981 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.284 seconds
[0m14:21:48.126441 [info ] [Thread-4 (]: 10 of 24 PASS not_null_stg_batches_material_id ................................. [[32mPASS[0m in 0.33s]
[0m14:21:48.129250 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.297 seconds
[0m14:21:48.131017 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c
[0m14:21:48.134818 [info ] [Thread-3 (]: 9 of 24 PASS not_null_stg_batches_batch_id ..................................... [[32mPASS[0m in 0.36s]
[0m14:21:48.136350 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:21:48.138147 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0
[0m14:21:48.139342 [info ] [Thread-4 (]: 13 of 24 START test not_null_stg_production_orders_order_id .................... [RUN]
[0m14:21:48.141046 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:21:48.143000 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_material_id.c4312b2a1c, now test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284)
[0m14:21:48.145007 [info ] [Thread-3 (]: 14 of 24 START test relationships_core_batches_material_id__material_id__ref_core_materials_  [RUN]
[0m14:21:48.146826 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:21:48.148439 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_batches_batch_id.e034d4a1a0, now test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6)
[0m14:21:48.154689 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:21:48.155869 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:21:48.170007 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:21:48.172703 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:21:48.177603 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:21:48.185754 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:21:48.190494 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:21:48.192852 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"
[0m14:21:48.194306 [debug] [Thread-4 (]: On test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284"} */
[0m14:21:48.203489 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"
[0m14:21:48.204887 [debug] [Thread-3 (]: On test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6"} */
[0m14:21:48.220340 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.266 seconds
[0m14:21:48.223954 [info ] [Thread-1 (]: 11 of 24 PASS not_null_stg_materials_material_id ............................... [[32mPASS[0m in 0.33s]
[0m14:21:48.225713 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89
[0m14:21:48.227489 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:21:48.229283 [info ] [Thread-1 (]: 15 of 24 START test relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [RUN]
[0m14:21:48.231392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_materials_material_id.1f6535eb89, now test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d)
[0m14:21:48.233619 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:21:48.242288 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:21:48.258661 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:21:48.263365 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:21:48.277470 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"
[0m14:21:48.279073 [debug] [Thread-1 (]: On test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d"} */
[0m14:21:48.365604 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.283 seconds
[0m14:21:48.369598 [info ] [Thread-2 (]: 12 of 24 PASS not_null_stg_production_orders_batch_id .......................... [[32mPASS[0m in 0.35s]
[0m14:21:48.371324 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5
[0m14:21:48.372892 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:21:48.374445 [info ] [Thread-2 (]: 16 of 24 START test relationships_stg_batches_material_id__material_id__ref_stg_materials_  [RUN]
[0m14:21:48.375965 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_batch_id.4247a065e5, now test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2)
[0m14:21:48.377351 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:21:48.384546 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:21:48.397984 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:21:48.402337 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:21:48.414298 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"
[0m14:21:48.415539 [debug] [Thread-2 (]: On test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select material_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
    where material_id is not null
),

parent as (
    select material_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2"} */
[0m14:21:48.471226 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.275 seconds
[0m14:21:48.474773 [info ] [Thread-4 (]: 13 of 24 PASS not_null_stg_production_orders_order_id .......................... [[32mPASS[0m in 0.33s]
[0m14:21:48.476712 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284
[0m14:21:48.478238 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:21:48.479706 [info ] [Thread-4 (]: 17 of 24 START test relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [RUN]
[0m14:21:48.481626 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.not_null_stg_production_orders_order_id.6659b23284, now test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519)
[0m14:21:48.483236 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:21:48.486316 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m14:21:48.488044 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m14:21:48.493134 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:21:48.498119 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.292 seconds
[0m14:21:48.502164 [info ] [Thread-3 (]: 14 of 24 PASS relationships_core_batches_material_id__material_id__ref_core_materials_  [[32mPASS[0m in 0.35s]
[0m14:21:48.503956 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6
[0m14:21:48.505820 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:21:48.507313 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:21:48.507934 [info ] [Thread-3 (]: 18 of 24 START test unique_core_batches_batch_id ............................... [RUN]
[0m14:21:48.512068 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:21:48.513680 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_core_batches_material_id__material_id__ref_core_materials_.47661562c6, now test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf)
[0m14:21:48.516160 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:21:48.524277 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:21:48.534581 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"
[0m14:21:48.536172 [debug] [Thread-4 (]: On test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select batch_id as from_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
    where batch_id is not null
),

parent as (
    select batch_id as to_field
    from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519"} */
[0m14:21:48.538223 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:21:48.543682 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:21:48.545463 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.265 seconds
[0m14:21:48.550254 [info ] [Thread-1 (]: 15 of 24 PASS relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_  [[32mPASS[0m in 0.32s]
[0m14:21:48.552247 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d
[0m14:21:48.553881 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:21:48.555352 [info ] [Thread-1 (]: 19 of 24 START test unique_core_materials_material_id .......................... [RUN]
[0m14:21:48.556945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_fct_production_orders_batch_id__batch_id__ref_core_batches_.586aef675d, now test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2)
[0m14:21:48.558710 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:21:48.565692 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"
[0m14:21:48.566139 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:21:48.567408 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf"} */
[0m14:21:48.579285 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:21:48.583576 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:21:48.597111 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"
[0m14:21:48.598327 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.core_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2"} */
[0m14:21:48.703540 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m14:21:48.708816 [info ] [Thread-2 (]: 16 of 24 PASS relationships_stg_batches_material_id__material_id__ref_stg_materials_  [[32mPASS[0m in 0.33s]
[0m14:21:48.711155 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2
[0m14:21:48.712931 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:21:48.714601 [info ] [Thread-2 (]: 20 of 24 START test unique_fct_production_orders_order_id ...................... [RUN]
[0m14:21:48.716432 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_batches_material_id__material_id__ref_stg_materials_.6a83bb75b2, now test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442)
[0m14:21:48.718093 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:21:48.724701 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:21:48.740013 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:21:48.744630 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:21:48.758339 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"
[0m14:21:48.759708 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.fct_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442"} */
[0m14:21:48.826170 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.289 seconds
[0m14:21:48.829663 [info ] [Thread-4 (]: 17 of 24 PASS relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_  [[32mPASS[0m in 0.35s]
[0m14:21:48.831517 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519
[0m14:21:48.833051 [debug] [Thread-4 (]: Began running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:21:48.834468 [info ] [Thread-4 (]: 21 of 24 START test unique_mfg_ml_features_orders_order_id ..................... [RUN]
[0m14:21:48.836179 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.relationships_stg_production_orders_batch_id__batch_id__ref_stg_batches_.74e2b7f519, now test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd)
[0m14:21:48.837555 [debug] [Thread-4 (]: Began compiling node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:21:48.842767 [debug] [Thread-4 (]: Writing injected SQL for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:21:48.853619 [debug] [Thread-4 (]: Began executing node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:21:48.859118 [debug] [Thread-4 (]: Writing runtime sql for node "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:21:48.861999 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.292 seconds
[0m14:21:48.866321 [info ] [Thread-3 (]: 18 of 24 PASS unique_core_batches_batch_id ..................................... [[32mPASS[0m in 0.35s]
[0m14:21:48.868340 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf
[0m14:21:48.869865 [debug] [Thread-3 (]: Began running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:21:48.871577 [info ] [Thread-3 (]: 22 of 24 START test unique_stg_batches_batch_id ................................ [RUN]
[0m14:21:48.874420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.275 seconds
[0m14:21:48.875763 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_batches_batch_id.2512f981bf, now test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4)
[0m14:21:48.877569 [debug] [Thread-4 (]: Using snowflake connection "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"
[0m14:21:48.880354 [info ] [Thread-1 (]: 19 of 24 PASS unique_core_materials_material_id ................................ [[32mPASS[0m in 0.32s]
[0m14:21:48.882062 [debug] [Thread-3 (]: Began compiling node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:21:48.883598 [debug] [Thread-4 (]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.mfg_ml_features_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd"} */
[0m14:21:48.885427 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2
[0m14:21:48.891696 [debug] [Thread-3 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:21:48.895783 [debug] [Thread-1 (]: Began running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:21:48.898778 [info ] [Thread-1 (]: 23 of 24 START test unique_stg_materials_material_id ........................... [RUN]
[0m14:21:48.900676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_core_materials_material_id.8fd4d65cb2, now test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21)
[0m14:21:48.902405 [debug] [Thread-1 (]: Began compiling node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:21:48.909639 [debug] [Thread-1 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:21:48.911763 [debug] [Thread-3 (]: Began executing node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:21:48.916289 [debug] [Thread-3 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:21:48.919928 [debug] [Thread-1 (]: Began executing node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:21:48.924365 [debug] [Thread-1 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:21:48.931897 [debug] [Thread-3 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"
[0m14:21:48.933931 [debug] [Thread-1 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"
[0m14:21:48.934575 [debug] [Thread-3 (]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    batch_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_batches
where batch_id is not null
group by batch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4"} */
[0m14:21:48.935995 [debug] [Thread-1 (]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    material_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_materials
where material_id is not null
group by material_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21"} */
[0m14:21:48.954437 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m14:21:48.955937 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m14:21:49.030539 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.269 seconds
[0m14:21:49.039021 [info ] [Thread-2 (]: 20 of 24 PASS unique_fct_production_orders_order_id ............................ [[32mPASS[0m in 0.32s]
[0m14:21:49.041795 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442
[0m14:21:49.044305 [debug] [Thread-2 (]: Began running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:21:49.046673 [info ] [Thread-2 (]: 24 of 24 START test unique_stg_production_orders_order_id ...................... [RUN]
[0m14:21:49.049078 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mfg_accelerator.unique_fct_production_orders_order_id.60daa8b442, now test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3)
[0m14:21:49.051563 [debug] [Thread-2 (]: Began compiling node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:21:49.064695 [debug] [Thread-2 (]: Writing injected SQL for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:21:49.083489 [debug] [Thread-2 (]: Began executing node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:21:49.090956 [debug] [Thread-2 (]: Writing runtime sql for node "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:21:49.109567 [debug] [Thread-2 (]: Using snowflake connection "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"
[0m14:21:49.111714 [debug] [Thread-2 (]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from MFG_ACCELERATOR.ANALYTICS_analytics.stg_production_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "mfg_accelerator", "target_name": "dev", "node_id": "test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3"} */
[0m14:21:49.155882 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.262 seconds
[0m14:21:49.160868 [info ] [Thread-4 (]: 21 of 24 PASS unique_mfg_ml_features_orders_order_id ........................... [[32mPASS[0m in 0.32s]
[0m14:21:49.163030 [debug] [Thread-4 (]: Finished running node test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd
[0m14:21:49.196123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m14:21:49.200043 [info ] [Thread-1 (]: 23 of 24 PASS unique_stg_materials_material_id ................................. [[32mPASS[0m in 0.30s]
[0m14:21:49.202190 [debug] [Thread-1 (]: Finished running node test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21
[0m14:21:49.203798 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.266 seconds
[0m14:21:49.207829 [info ] [Thread-3 (]: 22 of 24 PASS unique_stg_batches_batch_id ...................................... [[32mPASS[0m in 0.33s]
[0m14:21:49.209615 [debug] [Thread-3 (]: Finished running node test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4
[0m14:21:49.406855 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.293 seconds
[0m14:21:49.414123 [info ] [Thread-2 (]: 24 of 24 PASS unique_stg_production_orders_order_id ............................ [[32mPASS[0m in 0.36s]
[0m14:21:49.417529 [debug] [Thread-2 (]: Finished running node test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3
[0m14:21:49.424162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:49.426880 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21' was left open.
[0m14:21:49.429007 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_materials_material_id.7435d32e21: Close
[0m14:21:49.439935 [info ] [MainThread]: 
[0m14:21:49.442314 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 7.07 seconds (7.07s).
[0m14:21:49.453163 [debug] [MainThread]: Command end result
[0m14:21:49.541837 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:21:49.548648 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:21:49.564104 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:21:49.565462 [info ] [MainThread]: 
[0m14:21:49.566733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:49.568089 [info ] [MainThread]: 
[0m14:21:49.569513 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m14:21:49.571781 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.715137, "process_in_blocks": "0", "process_kernel_time": 1.447706, "process_mem_max_rss": "223700", "process_out_blocks": "16", "process_user_time": 6.67221}
[0m14:21:49.573157 [debug] [MainThread]: Command `dbt test` succeeded at 14:21:49.573007 after 9.72 seconds
[0m14:21:49.574295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7116388c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb71163be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ef2560c0>]}
[0m14:21:49.575556 [debug] [MainThread]: Flushing usage events
[0m14:21:49.936509 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3' was left open.
[0m14:21:49.938284 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_production_orders_order_id.2e848f51e3: Close
[0m14:21:50.204080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:50.417421 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4' was left open.
[0m14:21:50.419575 [debug] [MainThread]: On test.mfg_accelerator.unique_stg_batches_batch_id.783b2a0ca4: Close
[0m14:21:50.884624 [debug] [MainThread]: Connection 'test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd' was left open.
[0m14:21:50.886390 [debug] [MainThread]: On test.mfg_accelerator.unique_mfg_ml_features_orders_order_id.9b92cd75bd: Close
[0m14:21:51.341436 [info ] [MainThread]: 
[0m14:21:51.343214 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 6.68 seconds (6.68s).
[0m14:21:51.349043 [debug] [MainThread]: Command end result
[0m14:21:51.410863 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:21:51.417336 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:21:51.433966 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:21:51.435440 [info ] [MainThread]: 
[0m14:21:51.437121 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:51.438559 [info ] [MainThread]: 
[0m14:21:51.439926 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m14:21:51.441985 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.04401, "process_in_blocks": "0", "process_kernel_time": 1.469879, "process_mem_max_rss": "223984", "process_out_blocks": "16", "process_user_time": 6.568649}
[0m14:21:51.443504 [debug] [MainThread]: Command `dbt test` succeeded at 14:21:51.443382 after 9.05 seconds
[0m14:21:51.444800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b95eb4e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9404ff230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b95ee9a6f0>]}
[0m14:21:51.445962 [debug] [MainThread]: Flushing usage events
[0m14:21:52.049530 [debug] [MainThread]: An error was encountered while trying to flush usage events
